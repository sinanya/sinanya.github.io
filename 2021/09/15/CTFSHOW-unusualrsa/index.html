<!DOCTYPE html>
<html>
  <!-- meta/link... -->
  



<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <!-- Global site tag (gtag.js) - Google Analytics -->


  <title>CTFSHOW-unusualrsa | 司南的博客</title>

  
    
<link rel="stylesheet" href="/js/aos/aos.css">

  

  <link rel="icon" type="image/x-icon, image/vnd.microsoft.icon" href="/cat.ico">
  <link rel="stylesheet" href="https://at.alicdn.com/t/font_1911880_c1nvbyezg17.css">
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">

  
  
<link rel="stylesheet" href="/css/animate.min.css">

  
<link rel="stylesheet" href="/css/style.css">

  
  
    
<link rel="stylesheet" href="/js/fancybox/jquery.fancybox.min.css">

  
  
    
<link rel="stylesheet" href="/js/shareJs/share.min.css">

  
  <style>
        @media (max-width: 992px) {
            #waifu {
                display: none;
            }
        }
    </style>
    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">

    
        <script src="/js/valine/av-min@3.0.4.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/HCLonely/Valine@latest/dist/Valine.min.js"></script>
    
<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="司南的博客" type="application/atom+xml">
</head>

  
  <!-- 依赖于jquery和vue -->
  <script src="/js/jquery3.5.1.js"></script>
  <script src="/js/vue2.6.11.js"></script>
  
  <body>
    <!-- 预加载动画 -->
    <!-- 页面预加载动画 -->

<div id='loader'>
  <link rel="stylesheet" href="/js/loaded/index.css" >
  <div class="loading-left-bg"></div>
  <div class="loading-right-bg"></div>
  <div class="spinner-box">
    <div class="configure-border-1">
      <div class="configure-core"></div>
    </div>
    <div class="configure-border-2">
      <div class="configure-core"></div>
    </div>
    <div class="loading-word">loading...</div>
  </div>
</div>

<script>
  var endLoading = function () {
    document.body.style.overflow = 'auto';
    document.getElementById('loader').classList.add("loading");
  }
  window.addEventListener('DOMContentLoaded',endLoading);
  
</script>

    
    <!-- 判断是否为暗黑风格 -->
    <!-- 判断是否为黑夜模式 -->
<script>
  let isDark = JSON.parse(localStorage.getItem('dark')) || JSON.parse('false');

  if (isDark) {
    $(document.body).addClass('darkModel');
  }
</script>

    <!-- 头部导航等 -->
    
<header class="header " id="navHeader"
  style="position: fixed;
  left: 0; top: 0; z-index: 10;width: 100%;"
>
  <div class="header-content">
    <div class="bars">
      <div id="appDrawer" class="sidebar-image">
  <div class="drawer-box-icon">
    <i class="fa fa-bars" aria-hidden="true" @click="showDialogDrawer"></i>
  </div>
  
  <transition name="fade">
    <div class="drawer-box_mask" v-cloak style="display: none;" v-show="visible" @click.self="cancelDialogDrawer">
    </div>
  </transition>
  <div class="drawer-box" :class="{'active': visible}">
    <div class="drawer-box-head bg-color">
      <img class="drawer-box-head_logo" src="/medias/logo.png" alt="logo">
      <h3 class="drawer-box-head_title">司南的博客</h3>
      <h5 class="drawer-box-head_desc"></h5>
    </div>
    
    <div class="drawer-box-content">
      <ul class="drawer-box-content_menu">
        
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/" class="drawer-menu-item-link">
                  
                    <i class="fa fa-home" aria-hidden="true"></i>
                  
                  <span class="name">Home</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/tags" class="drawer-menu-item-link">
                  
                    <i class="fa fa-tags" aria-hidden="true"></i>
                  
                  <span class="name">Tags</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/categories" class="drawer-menu-item-link">
                  
                    <i class="fa fa-bookmark" aria-hidden="true"></i>
                  
                  <span class="name">Categories</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/about" class="drawer-menu-item-link">
                  
                    <i class="fa fa-user" aria-hidden="true"></i>
                  
                  <span class="name">About</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/friends" class="drawer-menu-item-link">
                  
                  <span class="name">Friends</span>
                </a>
              
            </li>
          
        
        
          <li class="drawer-box-content_item">
            <a target="_blank" rel="noopener" href="https://github.com/yuang01/hexo-theme-bamboo">
              <i class="fa fa-github" aria-hidden="true"></i>
              <span>Github</span>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>

<script>
  var body = document.body || document.documentElement || window;
  var vm = new Vue({
    el: '#appDrawer',
    data: {
      visible: false,
      top: 0,
      openArr: [],
    },
    computed: {
    },
    mounted() {
    },
    methods: {
      isOpen(index) {
        if (this.openArr.includes(index)) {
          return true;
        } else {
          return false;
        }
      },
      openOrCloseMenu(curIndex) {
        const index = this.openArr.indexOf(curIndex);
        if (index !== -1) {
          this.openArr.splice(index, 1);
        } else {
          this.openArr.push(curIndex);
        }
      },
      showDialogDrawer() {
        this.visible = true;
        // 防止页面滚动，只能让弹框滚动
        this.top = $(document).scrollTop()
        body.style.cssText = 'width: 100%; height: 100%;overflow: hidden;';
      },
      cancelDialogDrawer() {
        this.visible = false;
        body.removeAttribute('style');
        $(document).scrollTop(this.top)
      }
    },
    created() {}
  })
</script>

    </div>
    <div class="blog-title" id="author-avatar">
      
        <div class="avatar">
          <img src="/medias/logo.png" alt="logo">
        </div>
      
      <a href="/" class="logo">司南的博客</a>
    </div>
    <nav class="navbar">
      <ul class="menu">
        
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/" class="menu-item-link" title="Home">
                  
                    <i class="fa fa-home" aria-hidden="true"></i>
                  
                  <span class="name">Home</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/tags" class="menu-item-link" title="Tags">
                  
                    <i class="fa fa-tags" aria-hidden="true"></i>
                  
                  <span class="name">Tags</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/categories" class="menu-item-link" title="Categories">
                  
                    <i class="fa fa-bookmark" aria-hidden="true"></i>
                  
                  <span class="name">Categories</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/about" class="menu-item-link" title="About">
                  
                    <i class="fa fa-user" aria-hidden="true"></i>
                  
                  <span class="name">About</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/friends" class="menu-item-link" title="Friends">
                  
                  <span class="name">Friends</span>
                </a>
              
            </li>
          
        
      </ul>
      
      
        <div id="appSearch">
  <div class="search"  @click="showDialog()"><i class="fa fa-search" aria-hidden="true"></i></div>
  <transition name="fade">
    <div class="message-box_wrapper" style="display: none;" v-cloak v-show="dialogVisible" @click.self="cancelDialogVisible()">
      <div class="message-box animated bounceInDown">
        <!-- <div class="close" style="overflow: hidden;">
          <i class="fa fa-close" aria-hidden="true" style="float:right;" @click.self="cancelDialogVisible()"></i>
        </div> -->
        <h2>
          <span>
            <i class="fa fa-search" aria-hidden="true"></i>
            <span class="title">Search</span>
          </span>
          <i class="fa fa-close close" pointer style="float:right;" aria-hidden="true" @click.self="cancelDialogVisible()"></i>
        </h2>
        <form class="site-search-form">
          <input type="text"
            placeholder="Please enter keywords"
            id="local-search-input" 
            @click="getSearchFile()"
            class="st-search-input"
            v-model="searchInput"
          />
        </form>
        <div class="result-wrapper">
          <div id="local-search-result" class="local-search-result-cls"></div>
        </div>
      </div>
    </div>
  </transition>
</div>
<script src="/js/local_search.js"></script>
<script>
  var body = document.body || document.documentElement || window;
  var vm = new Vue({
    el: '#appSearch',
    data: {
      dialogVisible: false,
      searchInput: '',
      top: 0,
    },
    computed: {
    },
    mounted() {
    },
    methods: {
      showDialog() {
        this.dialogVisible = true;
        // 防止页面滚动，只能让弹框滚动
        this.top = $(document).scrollTop()
        body.style.cssText = 'overflow: hidden;';
      },
      getSearchFile() {
        if (!this.searchInput) {
          getSearchFile("/search.xml");
        }
      },
      cancelDialogVisible() {
        this.dialogVisible = false;
        body.removeAttribute('style');
        $(document).scrollTop(this.top)
      },
    },
    created() {}
  })
</script>
<!-- 解决刷新页面闪烁问题，可以在元素上添加display: none, 或者用vue.extend方法，详情：https://blog.csdn.net/qq_31393401/article/details/81017912 -->
<!-- 下面是搜索基本写法 -->
<!-- <script type="text/javascript" id="local.search.active">
  var inputArea = document.querySelector("#local-search-input");
  inputArea.onclick   = function(){ getSearchFile(); this.onclick = null }
  inputArea.onkeydown = function(){ if(event.keyCode == 13) return false }
</script> -->

      

    </nav>
  </div>
  
    <a target="_blank" rel="noopener" href="https://github.com/yuang01/hexo-theme-bamboo" class="github-corner color-primary" aria-label="View source on GitHub"><svg width="60" height="60" viewBox="0 0 250 250" style="fill:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
  
  

    <!-- 当头部导航设置为背景透明的时候  -->
    
      <script src="/js/header/index.js" data-pjax></script>
    
</header>

    <!-- 需要在上面加载的js -->
    <script>
    function loadScript(src, cb) {
        setTimeout(function () {
            var HEAD = document.getElementsByTagName('head')[0] || document.documentElement;
            var script = document.createElement('script');
            script.setAttribute('type', 'text/javascript');
            if (cb) script.onload = cb;
            script.setAttribute('src', src);
            HEAD.appendChild(script);
        });
    }

    //https://github.com/filamentgroup/loadCSS
    var loadCSS = function (href, before, media, attributes) {
        var doc = window.document;
        var ss = doc.createElement("link");
        var ref;
        if (before) {
            ref = before;
        }
        else {
            var refs = (doc.body || doc.getElementsByTagName("head")[0]).childNodes;
            ref = refs[refs.length - 1];
        }
        var sheets = doc.styleSheets;
        if (attributes) {
            for (var attributeName in attributes) {
                if (attributes.hasOwnProperty(attributeName)) {
                    ss.setAttribute(attributeName, attributes[attributeName]);
                }
            }
        }
        ss.rel = "stylesheet";
        ss.href = href;
        ss.media = "only x";
        function ready(cb) {
            if (doc.body) {
                return cb();
            }
            setTimeout(function () {
                ready(cb);
            });
        }
        ready(function () {
            ref.parentNode.insertBefore(ss, (before ? ref : ref.nextSibling));
        });
        var onloadcssdefined = function (cb) {
            var resolvedHref = ss.href;
            var i = sheets.length;
            while (i--) {
                if (sheets[i].href === resolvedHref) {
                    return cb();
                }
            }
            setTimeout(function () {
                onloadcssdefined(cb);
            });
        };
        function loadCB() {
            if (ss.addEventListener) {
                ss.removeEventListener("load", loadCB);
            }
            ss.media = media || "all";
        }
        if (ss.addEventListener) {
            ss.addEventListener("load", loadCB);
        }
        ss.onloadcssdefined = onloadcssdefined;
        onloadcssdefined(loadCB);
        return ss;
    };
    
</script>
 

<!-- 轮播图所需要的js -->
<script src="/js/swiper/swiper.min.js"></script>
<script src="/js/swiper/vue-awesome-swiper.js"></script>
<script src="/js/swiper/swiper.animate1.0.3.min.js"></script>


  <script src="/js/vue-typed-js/index.js"></script>


<!-- 首页的公告滚动插件的js需要重新加载 -->
<script src="/js/vue-seamless-scroll/index.js"></script>

<!-- 打字机效果js -->
<script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11"></script>


    <!-- 内容区域 -->
    <main class="main" id="pjax-container" style="margin-top: 0;">
      
 <!-- prismjs 代码高亮 -->
 
    
    <link href="/js/prism/prism-line-numbers.css" rel="stylesheet">
    
        <link href="/js/prism/prism-okaidia.min.css" rel="stylesheet">
    

    <style>
        pre[class*="language-"] {
            overflow-y: hidden;
        }
        .line-numbers .line-numbers-rows {
            border: none;
        }
    </style>
  


<div class="bg-dark-floor" style="position: fixed;left: 0;top: 0;width: 100%;height: 100%;z-index: -1;"></div>

<!-- 文章详情页顶部图片和标题 -->




<div class="post-detail-header lazyload" id="thumbnail_canvas" data-original="/medias/1.jpg" style="background-repeat: no-repeat; background-size: cover; 
  background-position: center center;position: relative;">
  <div class="post-detail-header-mask"></div>
  <canvas id="header_canvas"style="position:absolute;bottom:0;pointer-events:none;"></canvas>
  
  <div class="post-detail-header_info-box">
    <div class="title-box">
      <span class="title">
        CTFSHOW-unusualrsa
      </span>
    </div>
    
    
      
        <span class="post-detail-header_date">
          <i class="fa fa-calendar"></i> Published in：2021-09-15 |
        </span>
      

      
        <span class="post-detail-header_categories">
          <i class="iconfont iconbookmark1"></i> category：
          
            <a href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/" class="post-detail-header_category">
              密码学
            </a>
          
            <a href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/CTFSHOW/" class="post-detail-header_category">
              CTFSHOW
            </a>
          
        </span>
      

      
    
  </div>
  
  
    <script src="/js/bubble/bubble.js"></script>
  
</div>



<div class="row justify-position">
  <div class="main-content">
    <article class="post post-detail">
      
      <div class="post-content">
        <h2 id="unusualrsa1"><a href="#unusualrsa1" class="headerlink" title="unusualrsa1"></a>unusualrsa1</h2><p>题目如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># ********************</span>
<span class="token comment"># @Author: Lazzaro</span>
<span class="token comment"># ********************</span>

<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime<span class="token punctuation">,</span>bytes_to_long<span class="token punctuation">,</span>long_to_bytes
<span class="token keyword">from</span> random <span class="token keyword">import</span> randint
<span class="token keyword">from</span> secret <span class="token keyword">import</span> flag

p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
n <span class="token operator">=</span> p<span class="token operator">*</span>q
<span class="token keyword">print</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>

m <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">208</span><span class="token operator">+</span>flag<span class="token punctuation">)</span>
<span class="token keyword">assert</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">2044</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">(</span>m<span class="token operator">>></span><span class="token number">315</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">315</span><span class="token punctuation">)</span>
c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>

<span class="token comment">#14113948189208713011909396304970377626324044633561155020366406284451614054260708934598840781397326960921718892801653205159753091559901114082556464576477585198060530094478860626532455065960136263963965819002575418616768412539016154873800614138683106056209070597212668250136909436974469812231498651367459717175769611385545792201291192023843434476550550829737236225181770896867698281325858412643953550465132756142888893550007041167700300621499970661661288422834479368072744930285128061160879720771910458653611076539210357701565156322144818787619821653007453741709031635862923191561438148729294430924288173571196757351837</span>
<span class="token comment">#1520800285708753284739523608878585974609134243280728660335545667177630830064371336150456537012842986526527904043383436211487979254140749228004148347597566264500276581990635110200009305900689510908049771218073767918907869112593870878204145615928290375086195098919355531430003571366638390993296583488184959318678321571278510231561645872308920917404996519309473979203661442792048291421574603018835698487725981963573816645574675640357569465990665689618997534740389987351864738104038598104713275375385003471306823348792559733332094774873827383320058176803218213042061965933143968710199376164960850951030741280074168795136</span>
<span class="token comment">#6635663565033382363211849843446648120305449056573116171933923595209656581213410699649926913276685818674688954045817246263487415328838542489103709103428412175252447323358040041217431171817865818374522191881448865227314554997131690963910348820833080760482835650538394814181656599175839964284713498394589419605748581347163389157651739759144560719049281761889094518791244702056048080280278984031050608249265997808217512349309696532160108250480622956599732443714546043439089844571655280770141647694859907985919056009576606333143546094941635324929407538860140272562570973340199814409134962729885962133342668270226853146819</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>经典的CopperSmith攻击，明文是一个随机数*208 + flag后转为长整数，然后泄露了高位，直接使用sage恢复。脚本如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">m <span class="token operator">=</span> <span class="token number">1520800285708753284739523608878585974609134243280728660335545667177630830064371336150456537012842986526527904043383436211487979254140749228004148347597566264500276581990635110200009305900689510908049771218073767918907869112593870878204145615928290375086195098919355531430003571366638390993296583488184959318678321571278510231561645872308920917404996519309473979203661442792048291421574603018835698487725981963573816645574675640357569465990665689618997534740389987351864738104038598104713275375385003471306823348792559733332094774873827383320058176803218213042061965933143968710199376164960850951030741280074168795136</span>
n <span class="token operator">=</span> <span class="token number">14113948189208713011909396304970377626324044633561155020366406284451614054260708934598840781397326960921718892801653205159753091559901114082556464576477585198060530094478860626532455065960136263963965819002575418616768412539016154873800614138683106056209070597212668250136909436974469812231498651367459717175769611385545792201291192023843434476550550829737236225181770896867698281325858412643953550465132756142888893550007041167700300621499970661661288422834479368072744930285128061160879720771910458653611076539210357701565156322144818787619821653007453741709031635862923191561438148729294430924288173571196757351837</span>
c <span class="token operator">=</span> <span class="token number">6635663565033382363211849843446648120305449056573116171933923595209656581213410699649926913276685818674688954045817246263487415328838542489103709103428412175252447323358040041217431171817865818374522191881448865227314554997131690963910348820833080760482835650538394814181656599175839964284713498394589419605748581347163389157651739759144560719049281761889094518791244702056048080280278984031050608249265997808217512349309696532160108250480622956599732443714546043439089844571655280770141647694859907985919056009576606333143546094941635324929407538860140272562570973340199814409134962729885962133342668270226853146819</span>
kbits <span class="token operator">=</span> <span class="token number">315</span>
PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
f <span class="token operator">=</span> <span class="token punctuation">(</span>m <span class="token operator">+</span> x<span class="token punctuation">)</span><span class="token operator">^</span> <span class="token number">3</span> <span class="token operator">-</span> c
x0 <span class="token operator">=</span> f<span class="token punctuation">.</span>small_roots<span class="token punctuation">(</span>X <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">^</span> kbits<span class="token punctuation">,</span> beta <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token operator">+</span><span class="token builtin">int</span><span class="token punctuation">(</span>x0<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>长整数转字符串，flag在字符串的最后面。</p>
<hr>
<h2 id="unusualrsa2"><a href="#unusualrsa2" class="headerlink" title="unusualrsa2"></a>unusualrsa2</h2><p>题目如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># ********************</span>
<span class="token comment"># @Author: Lazzaro</span>
<span class="token comment"># ********************</span>

<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime<span class="token punctuation">,</span>bytes_to_long<span class="token punctuation">,</span>long_to_bytes
<span class="token keyword">from</span> functools <span class="token keyword">import</span> <span class="token builtin">reduce</span>
<span class="token keyword">from</span> secret <span class="token keyword">import</span> flag<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y

m <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
n <span class="token operator">=</span> p<span class="token operator">*</span>q
<span class="token keyword">print</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>

<span class="token keyword">assert</span><span class="token punctuation">(</span><span class="token builtin">reduce</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">,</span>y<span class="token punctuation">:</span>x<span class="token operator">&amp;</span>y<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">*</span>i<span class="token operator">+</span><span class="token number">6</span><span class="token operator">==</span><span class="token number">0</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span><span class="token punctuation">(</span><span class="token builtin">reduce</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">,</span>y<span class="token punctuation">:</span>x<span class="token operator">&amp;</span>y<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">-</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token operator">*</span>j<span class="token operator">+</span><span class="token number">44</span><span class="token operator">==</span><span class="token number">0</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> y<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token builtin">reduce</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">,</span>y<span class="token punctuation">:</span>x<span class="token operator">*</span>m<span class="token operator">+</span>y<span class="token punctuation">,</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token builtin">reduce</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">,</span>y<span class="token punctuation">:</span>x<span class="token operator">*</span>m<span class="token operator">+</span>y<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">#23772599983135215481563178266884362291876571759991288577057472733374903836591330410574958472090396886895304944176208711481780781286891334062794555288959410390926474473859289842654809538435377431088422352076225067494924657598298955407771484146155998883073439266427190212827600119365643065276814044272790573450938596830336430371987561905132579730619341196199420897034988685012777895002554746080384319298123154671447844799088258541911028041717897434816921424155687677867019535399434825468160227242441375503664915265223696139025407768146464383537556265875013085702422829200814612395116961538432886116917063119749068212699</span>
<span class="token comment">#10900151504654409767059699202929100225155892269473271859207513720755903691031362539478242920144073599515746938827937863835169270383721094542639011665235593065932998091574636525973099426040452626893461449084383663453549354608769727777329036059746386523843912382289597182615339786437186169811342356085836838520978047561127661777189045888648773949147220411427306098338616422692914110656004863767719312410906124366000507952960331116878197129010412361636679449281808407214524741732730279777729251515759320442591663641984363061618865267606007355576230009922421807527598213455112981354590909603317525854070358390622096569841</span>
<span class="token comment">#17298679220717326374674940612143058330715465693318467692839033642321129433471254547497087746971317567301086124779289015934582615377165560688447452762043163082394944604062014490446763247008217251611443338103074143809936437694543761369945095202092750900940979469994907399829695696313513303922266742415376818434932335640062684245008822643258497589196668426788916969378417960200705779461808292296450298558001909603602502604228973101048082095642290047196235959438278631661658312398313171590515776453711432353011579809351076532129444735206408591345372296372378396539831385036814349328459266432393612919118094115543053115450</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token builtin">reduce</span>函数：
<span class="token builtin">reduce</span><span class="token punctuation">(</span>function<span class="token punctuation">,</span> iterable<span class="token punctuation">[</span><span class="token punctuation">,</span> initializer<span class="token punctuation">]</span><span class="token punctuation">)</span>

function <span class="token operator">-</span><span class="token operator">-</span> 函数，有两个参数
iterable <span class="token operator">-</span><span class="token operator">-</span> 可迭代对象
initializer <span class="token operator">-</span><span class="token operator">-</span> 可选，初始参数<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>例子 ：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> functools <span class="token keyword">import</span> <span class="token builtin">reduce</span>

 <span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token punctuation">:</span>       <span class="token comment"># 两数相加</span>
   <span class="token keyword">return</span> x <span class="token operator">+</span> y
 sum1 <span class="token operator">=</span> <span class="token builtin">reduce</span><span class="token punctuation">(</span>add<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 计算列表和：1+2+3+4+5</span>
 sum2 <span class="token operator">=</span> <span class="token builtin">reduce</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">,</span> y<span class="token punctuation">:</span> x<span class="token operator">+</span>y<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 使用 lambda 匿名函数</span>
 <span class="token keyword">print</span><span class="token punctuation">(</span>sum1<span class="token punctuation">)</span>
 <span class="token keyword">print</span><span class="token punctuation">(</span>sum2<span class="token punctuation">)</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
结果：
<span class="token number">15</span>
<span class="token number">15</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>注意：<strong>reduce返回的数值类型与第二个函数的运算和列表中数值的类型。</strong></p>
<p>返回到题目，题中的reduce函数的列表中的数值类型为bool类型，这样x,y都是bool类型的值（注意这里的x和y只是reduce函数的表述参数（形参），与后面循环中的x和y无关，for循环中的x和y才是真正的参数）。为了满足assert函数值为True，x和y中的元素都得满足前面的等式。</p>
<p>题目属于Coppersmith’s Short-pad Attack &amp; Related Message Attack（Franklin-Reiter攻击）</p>
<p>算出x = [2, 3]; y = [4, 11]。</p>
<p>把相关参数代入下面的脚本就可以得到flag。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#脚本1</span>
<span class="token comment">#Sage</span>
<span class="token keyword">import</span> binascii
<span class="token keyword">def</span> <span class="token function">attack</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> n<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">:</span>
    PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">>=</span>PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># replace a,b,c,d</span>
    g1 <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token operator">*</span>x<span class="token operator">+</span>b<span class="token punctuation">)</span><span class="token operator">^</span>e <span class="token operator">-</span> c1
    g2 <span class="token operator">=</span> <span class="token punctuation">(</span>c<span class="token operator">*</span>x<span class="token operator">+</span>d<span class="token punctuation">)</span><span class="token operator">^</span>e <span class="token operator">-</span> c2

    <span class="token keyword">def</span> <span class="token function">gcd</span><span class="token punctuation">(</span>g1<span class="token punctuation">,</span> g2<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">while</span> g2<span class="token punctuation">:</span>
            g1<span class="token punctuation">,</span> g2 <span class="token operator">=</span> g2<span class="token punctuation">,</span> g1 <span class="token operator">%</span> g2
        <span class="token keyword">return</span> g1<span class="token punctuation">.</span>monic<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token operator">-</span>gcd<span class="token punctuation">(</span>g1<span class="token punctuation">,</span> g2<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
c1 <span class="token operator">=</span> 
c2 <span class="token operator">=</span> 
n <span class="token operator">=</span> 
e <span class="token operator">=</span> 
m1 <span class="token operator">=</span> attack<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> n<span class="token punctuation">,</span> e<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>binascii<span class="token punctuation">.</span>unhexlify<span class="token punctuation">(</span><span class="token string">"%x"</span> <span class="token operator">%</span> <span class="token builtin">int</span><span class="token punctuation">(</span>m1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
<span class="token comment">#脚本2</span>
<span class="token comment">#Sage</span>
<span class="token keyword">def</span> <span class="token function">short_pad_attack</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    PRxy<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token punctuation">,</span>y<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
    PRx<span class="token punctuation">.</span><span class="token operator">&lt;</span>xn<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
    PRZZ<span class="token punctuation">.</span><span class="token operator">&lt;</span>xz<span class="token punctuation">,</span>yz<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
    g1 <span class="token operator">=</span> x<span class="token operator">^</span>e <span class="token operator">-</span> c1
    g2 <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token operator">+</span>y<span class="token punctuation">)</span><span class="token operator">^</span>e <span class="token operator">-</span> c2
    q1 <span class="token operator">=</span> g1<span class="token punctuation">.</span>change_ring<span class="token punctuation">(</span>PRZZ<span class="token punctuation">)</span>
    q2 <span class="token operator">=</span> g2<span class="token punctuation">.</span>change_ring<span class="token punctuation">(</span>PRZZ<span class="token punctuation">)</span>
    h <span class="token operator">=</span> q2<span class="token punctuation">.</span>resultant<span class="token punctuation">(</span>q1<span class="token punctuation">)</span>
    h <span class="token operator">=</span> h<span class="token punctuation">.</span>univariate_polynomial<span class="token punctuation">(</span><span class="token punctuation">)</span>
    h <span class="token operator">=</span> h<span class="token punctuation">.</span>change_ring<span class="token punctuation">(</span>PRx<span class="token punctuation">)</span><span class="token punctuation">.</span>subs<span class="token punctuation">(</span>y<span class="token operator">=</span>xn<span class="token punctuation">)</span>
    h <span class="token operator">=</span> h<span class="token punctuation">.</span>monic<span class="token punctuation">(</span><span class="token punctuation">)</span>
    kbits <span class="token operator">=</span> n<span class="token punctuation">.</span>nbits<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">//</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>e<span class="token operator">*</span>e<span class="token punctuation">)</span>
    diff <span class="token operator">=</span> h<span class="token punctuation">.</span>small_roots<span class="token punctuation">(</span>X<span class="token operator">=</span><span class="token number">2</span><span class="token operator">^</span>kbits<span class="token punctuation">,</span> beta<span class="token operator">=</span><span class="token number">0.4</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># find root &lt; 2^kbits with factor >= n^0.4</span>
    <span class="token keyword">return</span> diff
<span class="token keyword">def</span> <span class="token function">related_message_attack</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> diff<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    PRx<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
    g1 <span class="token operator">=</span> x<span class="token operator">^</span>e <span class="token operator">-</span> c1
    g2 <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token operator">+</span>diff<span class="token punctuation">)</span><span class="token operator">^</span>e <span class="token operator">-</span> c2
    <span class="token keyword">def</span> <span class="token function">gcd</span><span class="token punctuation">(</span>g1<span class="token punctuation">,</span> g2<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">while</span> g2<span class="token punctuation">:</span>
            g1<span class="token punctuation">,</span> g2 <span class="token operator">=</span> g2<span class="token punctuation">,</span> g1 <span class="token operator">%</span> g2
        <span class="token keyword">return</span> g1<span class="token punctuation">.</span>monic<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token operator">-</span>gcd<span class="token punctuation">(</span>g1<span class="token punctuation">,</span> g2<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    n <span class="token operator">=</span>
    e <span class="token operator">=</span>
    c1 <span class="token operator">=</span>
    c2 <span class="token operator">=</span>
    diff <span class="token operator">=</span> short_pad_attack<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"difference of two messages is %d"</span> <span class="token operator">%</span> diff<span class="token punctuation">)</span>
    m1 <span class="token operator">=</span> related_message_attack<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> diff<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"m1:"</span><span class="token punctuation">,</span> m1<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"m2:"</span><span class="token punctuation">,</span> m1 <span class="token operator">+</span> diff<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h2 id="unusualrsa3"><a href="#unusualrsa3" class="headerlink" title="unusualrsa3"></a>unusualrsa3</h2><p>题目如下：</p>
<pre class="line-numbers language-none"><code class="language-none"># ********************
# @Author: Lazzaro
# ********************

p: 
2470567871

N: 
1932231392*x^255 + 1432733708*x^254 + 1270867914*x^253 + 1573324635*x^252 + 2378103997*x^251 + 820889786*x^250 + 762279735*x^249 + 1378353578*x^248 + 1226179520*x^247 + 657116276*x^246 + 1264717357*x^245 + 1015587392*x^244 + 849699356*x^243 + 1509168990*x^242 + 2407367106*x^241 + 873379233*x^240 + 2391647981*x^239 + 517715639*x^238 + 828941376*x^237 + 843708018*x^236 + 1526075137*x^235 + 1499291590*x^234 + 235611028*x^233 + 19615265*x^232 + 53338886*x^231 + 434434839*x^230 + 902171938*x^229 + 516444143*x^228 + 1984443642*x^227 + 966493372*x^226 + 1166227650*x^225 + 1824442929*x^224 + 930231465*x^223 + 1664522302*x^222 + 1067203343*x^221 + 28569139*x^220 + 2327926559*x^219 + 899788156*x^218 + 296985783*x^217 + 1144578716*x^216 + 340677494*x^215 + 254306901*x^214 + 766641243*x^213 + 1882320336*x^212 + 2139903463*x^211 + 1904225023*x^210 + 475412928*x^209 + 127723603*x^208 + 2015416361*x^207 + 1500078813*x^206 + 1845826007*x^205 + 797486240*x^204 + 85924125*x^203 + 1921772796*x^202 + 1322682658*x^201 + 2372929383*x^200 + 1323964787*x^199 + 1302258424*x^198 + 271875267*x^197 + 1297768962*x^196 + 2147341770*x^195 + 1665066191*x^194 + 2342921569*x^193 + 1450622685*x^192 + 1453466049*x^191 + 1105227173*x^190 + 2357717379*x^189 + 1044263540*x^188 + 697816284*x^187 + 647124526*x^186 + 1414769298*x^185 + 657373752*x^184 + 91863906*x^183 + 1095083181*x^182 + 658171402*x^181 + 75339882*x^180 + 2216678027*x^179 + 2208320155*x^178 + 1351845267*x^177 + 1740451894*x^176 + 1302531891*x^175 + 320751753*x^174 + 1303477598*x^173 + 783321123*x^172 + 1400145206*x^171 + 1379768234*x^170 + 1191445903*x^169 + 946530449*x^168 + 2008674144*x^167 + 2247371104*x^166 + 1267042416*x^165 + 1795774455*x^164 + 1976911493*x^163 + 167037165*x^162 + 1848717750*x^161 + 573072954*x^160 + 1126046031*x^159 + 376257986*x^158 + 1001726783*x^157 + 2250967824*x^156 + 2339380314*x^155 + 571922874*x^154 + 961000788*x^153 + 306686020*x^152 + 80717392*x^151 + 2454799241*x^150 + 1005427673*x^149 + 1032257735*x^148 + 593980163*x^147 + 1656568780*x^146 + 1865541316*x^145 + 2003844061*x^144 + 1265566902*x^143 + 573548790*x^142 + 494063408*x^141 + 1722266624*x^140 + 938551278*x^139 + 2284832499*x^138 + 597191613*x^137 + 476121126*x^136 + 1237943942*x^135 + 275861976*x^134 + 1603993606*x^133 + 1895285286*x^132 + 589034062*x^131 + 713986937*x^130 + 1206118526*x^129 + 311679750*x^128 + 1989860861*x^127 + 1551409650*x^126 + 2188452501*x^125 + 1175930901*x^124 + 1991529213*x^123 + 2019090583*x^122 + 215965300*x^121 + 532432639*x^120 + 1148806816*x^119 + 493362403*x^118 + 2166920790*x^117 + 185609624*x^116 + 184370704*x^115 + 2141702861*x^114 + 223551915*x^113 + 298497455*x^112 + 722376028*x^111 + 678813029*x^110 + 915121681*x^109 + 1107871854*x^108 + 1369194845*x^107 + 328165402*x^106 + 1792110161*x^105 + 798151427*x^104 + 954952187*x^103 + 471555401*x^102 + 68969853*x^101 + 453598910*x^100 + 2458706380*x^99 + 889221741*x^98 + 320515821*x^97 + 1549538476*x^96 + 909607400*x^95 + 499973742*x^94 + 552728308*x^93 + 1538610725*x^92 + 186272117*x^91 + 862153635*x^90 + 981463824*x^89 + 2400233482*x^88 + 1742475067*x^87 + 437801940*x^86 + 1504315277*x^85 + 1756497351*x^84 + 197089583*x^83 + 2082285292*x^82 + 109369793*x^81 + 2197572728*x^80 + 107235697*x^79 + 567322310*x^78 + 1755205142*x^77 + 1089091449*x^76 + 1993836978*x^75 + 2393709429*x^74 + 170647828*x^73 + 1205814501*x^72 + 2444570340*x^71 + 328372190*x^70 + 1929704306*x^69 + 717796715*x^68 + 1057597610*x^67 + 482243092*x^66 + 277530014*x^65 + 2393168828*x^64 + 12380707*x^63 + 1108646500*x^62 + 637721571*x^61 + 604983755*x^60 + 1142068056*x^59 + 1911643955*x^58 + 1713852330*x^57 + 1757273231*x^56 + 1778819295*x^55 + 957146826*x^54 + 900005615*x^53 + 521467961*x^52 + 1255707235*x^51 + 861871574*x^50 + 397953653*x^49 + 1259753202*x^48 + 471431762*x^47 + 1245956917*x^46 + 1688297180*x^45 + 1536178591*x^44 + 1833258462*x^43 + 1369087493*x^42 + 459426544*x^41 + 418389643*x^40 + 1800239647*x^39 + 2467433889*x^38 + 477713059*x^37 + 1898813986*x^36 + 2202042708*x^35 + 894088738*x^34 + 1204601190*x^33 + 1592921228*x^32 + 2234027582*x^31 + 1308900201*x^30 + 461430959*x^29 + 718926726*x^28 + 2081988029*x^27 + 1337342428*x^26 + 2039153142*x^25 + 1364177470*x^24 + 613659517*x^23 + 853968854*x^22 + 1013582418*x^21 + 1167857934*x^20 + 2014147362*x^19 + 1083466865*x^18 + 1091690302*x^17 + 302196939*x^16 + 1946675573*x^15 + 2450124113*x^14 + 1199066291*x^13 + 401889502*x^12 + 712045611*x^11 + 1850096904*x^10 + 1808400208*x^9 + 1567687877*x^8 + 2013445952*x^7 + 2435360770*x^6 + 2414019676*x^5 + 2277377050*x^4 + 2148341337*x^3 + 1073721716*x^2 + 1045363399*x + 1809685811

m^0x10001%N:  
922927962*x^254 + 1141958714*x^253 + 295409606*x^252 + 1197491798*x^251 + 2463440866*x^250 + 1671460946*x^249 + 967543123*x^248 + 119796323*x^247 + 1172760592*x^246 + 770640267*x^245 + 1093816376*x^244 + 196379610*x^243 + 2205270506*x^242 + 459693142*x^241 + 829093322*x^240 + 816440689*x^239 + 648546871*x^238 + 1533372161*x^237 + 1349964227*x^236 + 2132166634*x^235 + 403690250*x^234 + 835793319*x^233 + 2056945807*x^232 + 480459588*x^231 + 1401028924*x^230 + 2231055325*x^229 + 1716893325*x^228 + 16299164*x^227 + 1125072063*x^226 + 1903340994*x^225 + 1372971897*x^224 + 242927971*x^223 + 711296789*x^222 + 535407256*x^221 + 976773179*x^220 + 533569974*x^219 + 501041034*x^218 + 326232105*x^217 + 2248775507*x^216 + 1010397596*x^215 + 1641864795*x^214 + 1365178317*x^213 + 1038477612*x^212 + 2201213637*x^211 + 760847531*x^210 + 2072085932*x^209 + 168159257*x^208 + 70202009*x^207 + 1193933930*x^206 + 1559162272*x^205 + 1380642174*x^204 + 1296625644*x^203 + 1338288152*x^202 + 843839510*x^201 + 460174838*x^200 + 660412151*x^199 + 716865491*x^198 + 772161222*x^197 + 924177515*x^196 + 1372790342*x^195 + 320044037*x^194 + 117027412*x^193 + 814803809*x^192 + 1175035545*x^191 + 244769161*x^190 + 2116927976*x^189 + 617780431*x^188 + 342577832*x^187 + 356586691*x^186 + 695795444*x^185 + 281750528*x^184 + 133432552*x^183 + 741747447*x^182 + 2138036298*x^181 + 524386605*x^180 + 1231287380*x^179 + 1246706891*x^178 + 69277523*x^177 + 2124927225*x^176 + 2334697345*x^175 + 1769733543*x^174 + 2248037872*x^173 + 1899902290*x^172 + 409421149*x^171 + 1223261878*x^170 + 666594221*x^169 + 1795456341*x^168 + 406003299*x^167 + 992699270*x^166 + 2201384104*x^165 + 907692883*x^164 + 1667882231*x^163 + 1414341647*x^162 + 1592159752*x^161 + 28054099*x^160 + 2184618098*x^159 + 2047102725*x^158 + 103202495*x^157 + 1803852525*x^156 + 446464179*x^155 + 909116906*x^154 + 1541693644*x^153 + 166545130*x^152 + 2283548843*x^151 + 2348768005*x^150 + 71682607*x^149 + 484339546*x^148 + 669511666*x^147 + 2110974006*x^146 + 1634563992*x^145 + 1810433926*x^144 + 2388805064*x^143 + 1200258695*x^142 + 1555191384*x^141 + 363842947*x^140 + 1105757887*x^139 + 402111289*x^138 + 361094351*x^137 + 1788238752*x^136 + 2017677334*x^135 + 1506224550*x^134 + 648916609*x^133 + 2008973424*x^132 + 2452922307*x^131 + 1446527028*x^130 + 29659632*x^129 + 627390142*x^128 + 1695661760*x^127 + 734686497*x^126 + 227059690*x^125 + 1219692361*x^124 + 635166359*x^123 + 428703291*x^122 + 2334823064*x^121 + 204888978*x^120 + 1694957361*x^119 + 94211180*x^118 + 2207723563*x^117 + 872340606*x^116 + 46197669*x^115 + 710312088*x^114 + 305132032*x^113 + 1621042631*x^112 + 2023404084*x^111 + 2169254305*x^110 + 463525650*x^109 + 2349964255*x^108 + 626689949*x^107 + 2072533779*x^106 + 177264308*x^105 + 153948342*x^104 + 1992646054*x^103 + 2379817214*x^102 + 1396334187*x^101 + 2254165812*x^100 + 1300455472*x^99 + 2396842759*x^98 + 2398953180*x^97 + 88249450*x^96 + 1726340322*x^95 + 2004986735*x^94 + 2446249940*x^93 + 520126803*x^92 + 821544954*x^91 + 1177737015*x^90 + 676286546*x^89 + 1519043368*x^88 + 224894464*x^87 + 1742023262*x^86 + 142627164*x^85 + 1427710141*x^84 + 1504189919*x^83 + 688315682*x^82 + 1397842239*x^81 + 435187331*x^80 + 433176780*x^79 + 454834357*x^78 + 1046713282*x^77 + 1208458516*x^76 + 811240741*x^75 + 151611952*x^74 + 164192249*x^73 + 353336244*x^72 + 1779538914*x^71 + 1489144873*x^70 + 213140082*x^69 + 1874778522*x^68 + 908618863*x^67 + 1058334731*x^66 + 1706255211*x^65 + 708134837*x^64 + 1382118347*x^63 + 2111915733*x^62 + 1273497300*x^61 + 368639880*x^60 + 1652005004*x^59 + 1977610754*x^58 + 1412680185*x^57 + 2312775720*x^56 + 59793381*x^55 + 1345145822*x^54 + 627534850*x^53 + 2159477761*x^52 + 10450988*x^51 + 1479007796*x^50 + 2082579205*x^49 + 1158447154*x^48 + 126359830*x^47 + 393411272*x^46 + 2343384236*x^45 + 2191577465*x^44 + 1281188680*x^43 + 230049708*x^42 + 539600199*x^41 + 1711135601*x^40 + 1659775448*x^39 + 1716176055*x^38 + 904363231*x^37 + 2385749710*x^36 + 567278351*x^35 + 404199078*x^34 + 372670353*x^33 + 1286079784*x^32 + 1744355671*x^31 + 2316856064*x^30 + 2106475476*x^29 + 614988454*x^28 + 2149964943*x^27 + 1065233185*x^26 + 188130174*x^25 + 540415659*x^24 + 1031409799*x^23 + 1067085678*x^22 + 1005161755*x^21 + 249654085*x^20 + 1816791634*x^19 + 1437500292*x^18 + 448596413*x^17 + 2397497659*x^16 + 2353732701*x^15 + 2068949189*x^14 + 1826419168*x^13 + 1265366199*x^12 + 547031306*x^11 + 1016962374*x^10 + 160089486*x^9 + 2264803979*x^8 + 1081806194*x^7 + 824215340*x^6 + 497731793*x^5 + 45017166*x^4 + 317548920*x^3 + 1391127733*x^2 + 1752881284*x + 1290424106<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>起初的想法是x = 2，但是经过验证不是这样的，不然怎么会叫作不同寻常的RSA呢。看了下别人的博客，里面说是基于多项式的RSA。推导如下：</p>
<p><img "" class="lazyload placeholder" data-original="/Post15_image1.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt></p>
<p>考虑g(m)与g(n)互素，这样就会有：</p>
<p><img "" class="lazyload placeholder" data-original="/2021/09/15/CTFSHOW-unusualrsa/Post15_image3.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt></p>
<p><img "" class="lazyload placeholder" data-original="/2021/09/15/CTFSHOW-unusualrsa/Post15_image2.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt></p>
<p>参考：<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/4545">https://xz.aliyun.com/t/4545</a></p>
<p>在求解的过程中，注意φ(n)的计算，并不是通常的φ(n)的计算公式。多项式中每一项都与n互素，而欧拉函数是小于n的与n互素的正整数的个数，所以φ(n) = p ^ 最高次 - 1。sage脚本如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">p<span class="token operator">=</span> <span class="token number">2470567871</span>
P <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">,</span> name <span class="token operator">=</span> <span class="token string">'x'</span><span class="token punctuation">)</span>
x <span class="token operator">=</span> P<span class="token punctuation">.</span>gen<span class="token punctuation">(</span><span class="token punctuation">)</span>
e <span class="token operator">=</span> <span class="token number">65537</span>
n <span class="token operator">=</span> <span class="token number">1932231392</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">255</span> <span class="token operator">+</span> <span class="token number">1432733708</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">254</span> <span class="token operator">+</span> <span class="token number">1270867914</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">253</span> <span class="token operator">+</span> <span class="token number">1573324635</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">252</span> <span class="token operator">+</span> <span class="token number">2378103997</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">251</span> <span class="token operator">+</span> <span class="token number">820889786</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">250</span> <span class="token operator">+</span> <span class="token number">762279735</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">249</span> <span class="token operator">+</span> <span class="token number">1378353578</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">248</span> <span class="token operator">+</span> <span class="token number">1226179520</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">247</span> <span class="token operator">+</span> <span class="token number">657116276</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">246</span> <span class="token operator">+</span> <span class="token number">1264717357</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">245</span> <span class="token operator">+</span> <span class="token number">1015587392</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">244</span> <span class="token operator">+</span> <span class="token number">849699356</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">243</span> <span class="token operator">+</span> <span class="token number">1509168990</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">242</span> <span class="token operator">+</span> <span class="token number">2407367106</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">241</span> <span class="token operator">+</span> <span class="token number">873379233</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">240</span> <span class="token operator">+</span> <span class="token number">2391647981</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">239</span> <span class="token operator">+</span> <span class="token number">517715639</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">238</span> <span class="token operator">+</span> <span class="token number">828941376</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">237</span> <span class="token operator">+</span> <span class="token number">843708018</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">236</span> <span class="token operator">+</span> <span class="token number">1526075137</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">235</span> <span class="token operator">+</span> <span class="token number">1499291590</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">234</span> <span class="token operator">+</span> <span class="token number">235611028</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">233</span> <span class="token operator">+</span> <span class="token number">19615265</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">232</span> <span class="token operator">+</span> <span class="token number">53338886</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">231</span> <span class="token operator">+</span> <span class="token number">434434839</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">230</span> <span class="token operator">+</span> <span class="token number">902171938</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">229</span> <span class="token operator">+</span> <span class="token number">516444143</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">228</span> <span class="token operator">+</span> <span class="token number">1984443642</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">227</span> <span class="token operator">+</span> <span class="token number">966493372</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">226</span> <span class="token operator">+</span> <span class="token number">1166227650</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">225</span> <span class="token operator">+</span> <span class="token number">1824442929</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">224</span> <span class="token operator">+</span> <span class="token number">930231465</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">223</span> <span class="token operator">+</span> <span class="token number">1664522302</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">222</span> <span class="token operator">+</span> <span class="token number">1067203343</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">221</span> <span class="token operator">+</span> <span class="token number">28569139</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">220</span> <span class="token operator">+</span> <span class="token number">2327926559</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">219</span> <span class="token operator">+</span> <span class="token number">899788156</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">218</span> <span class="token operator">+</span> <span class="token number">296985783</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">217</span> <span class="token operator">+</span> <span class="token number">1144578716</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">216</span> <span class="token operator">+</span> <span class="token number">340677494</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">215</span> <span class="token operator">+</span> <span class="token number">254306901</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">214</span> <span class="token operator">+</span> <span class="token number">766641243</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">213</span> <span class="token operator">+</span> <span class="token number">1882320336</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">212</span> <span class="token operator">+</span> <span class="token number">2139903463</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">211</span> <span class="token operator">+</span> <span class="token number">1904225023</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">210</span> <span class="token operator">+</span> <span class="token number">475412928</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">209</span> <span class="token operator">+</span> <span class="token number">127723603</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">208</span> <span class="token operator">+</span> <span class="token number">2015416361</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">207</span> <span class="token operator">+</span> <span class="token number">1500078813</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">206</span> <span class="token operator">+</span> <span class="token number">1845826007</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">205</span> <span class="token operator">+</span> <span class="token number">797486240</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">204</span> <span class="token operator">+</span> <span class="token number">85924125</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">203</span> <span class="token operator">+</span> <span class="token number">1921772796</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">202</span> <span class="token operator">+</span> <span class="token number">1322682658</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">201</span> <span class="token operator">+</span> <span class="token number">2372929383</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">200</span> <span class="token operator">+</span> <span class="token number">1323964787</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">199</span> <span class="token operator">+</span> <span class="token number">1302258424</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">198</span> <span class="token operator">+</span> <span class="token number">271875267</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">197</span> <span class="token operator">+</span> <span class="token number">1297768962</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">196</span> <span class="token operator">+</span> <span class="token number">2147341770</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">195</span> <span class="token operator">+</span> <span class="token number">1665066191</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">194</span> <span class="token operator">+</span> <span class="token number">2342921569</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">193</span> <span class="token operator">+</span> <span class="token number">1450622685</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">192</span> <span class="token operator">+</span> <span class="token number">1453466049</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">191</span> <span class="token operator">+</span> <span class="token number">1105227173</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">190</span> <span class="token operator">+</span> <span class="token number">2357717379</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">189</span> <span class="token operator">+</span> <span class="token number">1044263540</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">188</span> <span class="token operator">+</span> <span class="token number">697816284</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">187</span> <span class="token operator">+</span> <span class="token number">647124526</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">186</span> <span class="token operator">+</span> <span class="token number">1414769298</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">185</span> <span class="token operator">+</span> <span class="token number">657373752</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">184</span> <span class="token operator">+</span> <span class="token number">91863906</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">183</span> <span class="token operator">+</span> <span class="token number">1095083181</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">182</span> <span class="token operator">+</span> <span class="token number">658171402</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">181</span> <span class="token operator">+</span> <span class="token number">75339882</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">180</span> <span class="token operator">+</span> <span class="token number">2216678027</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">179</span> <span class="token operator">+</span> <span class="token number">2208320155</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">178</span> <span class="token operator">+</span> <span class="token number">1351845267</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">177</span> <span class="token operator">+</span> <span class="token number">1740451894</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">176</span> <span class="token operator">+</span> <span class="token number">1302531891</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">175</span> <span class="token operator">+</span> <span class="token number">320751753</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">174</span> <span class="token operator">+</span> <span class="token number">1303477598</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">173</span> <span class="token operator">+</span> <span class="token number">783321123</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">172</span> <span class="token operator">+</span> <span class="token number">1400145206</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">171</span> <span class="token operator">+</span> <span class="token number">1379768234</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">170</span> <span class="token operator">+</span> <span class="token number">1191445903</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">169</span> <span class="token operator">+</span> <span class="token number">946530449</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">168</span> <span class="token operator">+</span> <span class="token number">2008674144</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">167</span> <span class="token operator">+</span> <span class="token number">2247371104</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">166</span> <span class="token operator">+</span> <span class="token number">1267042416</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">165</span> <span class="token operator">+</span> <span class="token number">1795774455</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">164</span> <span class="token operator">+</span> <span class="token number">1976911493</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">163</span> <span class="token operator">+</span> <span class="token number">167037165</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">162</span> <span class="token operator">+</span> <span class="token number">1848717750</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">161</span> <span class="token operator">+</span> <span class="token number">573072954</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">160</span> <span class="token operator">+</span> <span class="token number">1126046031</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">159</span> <span class="token operator">+</span> <span class="token number">376257986</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">158</span> <span class="token operator">+</span> <span class="token number">1001726783</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">157</span> <span class="token operator">+</span> <span class="token number">2250967824</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">156</span> <span class="token operator">+</span> <span class="token number">2339380314</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">155</span> <span class="token operator">+</span> <span class="token number">571922874</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">154</span> <span class="token operator">+</span> <span class="token number">961000788</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">153</span> <span class="token operator">+</span> <span class="token number">306686020</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">152</span> <span class="token operator">+</span> <span class="token number">80717392</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">151</span> <span class="token operator">+</span> <span class="token number">2454799241</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">150</span> <span class="token operator">+</span> <span class="token number">1005427673</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">149</span> <span class="token operator">+</span> <span class="token number">1032257735</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">148</span> <span class="token operator">+</span> <span class="token number">593980163</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">147</span> <span class="token operator">+</span> <span class="token number">1656568780</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">146</span> <span class="token operator">+</span> <span class="token number">1865541316</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">145</span> <span class="token operator">+</span> <span class="token number">2003844061</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">144</span> <span class="token operator">+</span> <span class="token number">1265566902</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">143</span> <span class="token operator">+</span> <span class="token number">573548790</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">142</span> <span class="token operator">+</span> <span class="token number">494063408</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">141</span> <span class="token operator">+</span> <span class="token number">1722266624</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">140</span> <span class="token operator">+</span> <span class="token number">938551278</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">139</span> <span class="token operator">+</span> <span class="token number">2284832499</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">138</span> <span class="token operator">+</span> <span class="token number">597191613</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">137</span> <span class="token operator">+</span> <span class="token number">476121126</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">136</span> <span class="token operator">+</span> <span class="token number">1237943942</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">135</span> <span class="token operator">+</span> <span class="token number">275861976</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">134</span> <span class="token operator">+</span> <span class="token number">1603993606</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">133</span> <span class="token operator">+</span> <span class="token number">1895285286</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">132</span> <span class="token operator">+</span> <span class="token number">589034062</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">131</span> <span class="token operator">+</span> <span class="token number">713986937</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">130</span> <span class="token operator">+</span> <span class="token number">1206118526</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">129</span> <span class="token operator">+</span> <span class="token number">311679750</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">128</span> <span class="token operator">+</span> <span class="token number">1989860861</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">127</span> <span class="token operator">+</span> <span class="token number">1551409650</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">126</span> <span class="token operator">+</span> <span class="token number">2188452501</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">125</span> <span class="token operator">+</span> <span class="token number">1175930901</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">124</span> <span class="token operator">+</span> <span class="token number">1991529213</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">123</span> <span class="token operator">+</span> <span class="token number">2019090583</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">122</span> <span class="token operator">+</span> <span class="token number">215965300</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">121</span> <span class="token operator">+</span> <span class="token number">532432639</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">120</span> <span class="token operator">+</span> <span class="token number">1148806816</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">119</span> <span class="token operator">+</span> <span class="token number">493362403</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">118</span> <span class="token operator">+</span> <span class="token number">2166920790</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">117</span> <span class="token operator">+</span> <span class="token number">185609624</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">116</span> <span class="token operator">+</span> <span class="token number">184370704</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">115</span> <span class="token operator">+</span> <span class="token number">2141702861</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">114</span> <span class="token operator">+</span> <span class="token number">223551915</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">113</span> <span class="token operator">+</span> <span class="token number">298497455</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">112</span> <span class="token operator">+</span> <span class="token number">722376028</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">111</span> <span class="token operator">+</span> <span class="token number">678813029</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">110</span> <span class="token operator">+</span> <span class="token number">915121681</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">109</span> <span class="token operator">+</span> <span class="token number">1107871854</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">108</span> <span class="token operator">+</span> <span class="token number">1369194845</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">107</span> <span class="token operator">+</span> <span class="token number">328165402</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">106</span> <span class="token operator">+</span> <span class="token number">1792110161</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">105</span> <span class="token operator">+</span> <span class="token number">798151427</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">104</span> <span class="token operator">+</span> <span class="token number">954952187</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">103</span> <span class="token operator">+</span> <span class="token number">471555401</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">102</span> <span class="token operator">+</span> <span class="token number">68969853</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">101</span> <span class="token operator">+</span> <span class="token number">453598910</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">100</span> <span class="token operator">+</span> <span class="token number">2458706380</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">99</span> <span class="token operator">+</span> <span class="token number">889221741</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">98</span> <span class="token operator">+</span> <span class="token number">320515821</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">97</span> <span class="token operator">+</span> <span class="token number">1549538476</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">96</span> <span class="token operator">+</span> <span class="token number">909607400</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">95</span> <span class="token operator">+</span> <span class="token number">499973742</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">94</span> <span class="token operator">+</span> <span class="token number">552728308</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">93</span> <span class="token operator">+</span> <span class="token number">1538610725</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">92</span> <span class="token operator">+</span> <span class="token number">186272117</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">91</span> <span class="token operator">+</span> <span class="token number">862153635</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">90</span> <span class="token operator">+</span> <span class="token number">981463824</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">89</span> <span class="token operator">+</span> <span class="token number">2400233482</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">88</span> <span class="token operator">+</span> <span class="token number">1742475067</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">87</span> <span class="token operator">+</span> <span class="token number">437801940</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">86</span> <span class="token operator">+</span> <span class="token number">1504315277</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">85</span> <span class="token operator">+</span> <span class="token number">1756497351</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">84</span> <span class="token operator">+</span> <span class="token number">197089583</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">83</span> <span class="token operator">+</span> <span class="token number">2082285292</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">82</span> <span class="token operator">+</span> <span class="token number">109369793</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">81</span> <span class="token operator">+</span> <span class="token number">2197572728</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">80</span> <span class="token operator">+</span> <span class="token number">107235697</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">79</span> <span class="token operator">+</span> <span class="token number">567322310</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">78</span> <span class="token operator">+</span> <span class="token number">1755205142</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">77</span> <span class="token operator">+</span> <span class="token number">1089091449</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">76</span> <span class="token operator">+</span> <span class="token number">1993836978</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">75</span> <span class="token operator">+</span> <span class="token number">2393709429</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">74</span> <span class="token operator">+</span> <span class="token number">170647828</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">73</span> <span class="token operator">+</span> <span class="token number">1205814501</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">72</span> <span class="token operator">+</span> <span class="token number">2444570340</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">71</span> <span class="token operator">+</span> <span class="token number">328372190</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">70</span> <span class="token operator">+</span> <span class="token number">1929704306</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">69</span> <span class="token operator">+</span> <span class="token number">717796715</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">68</span> <span class="token operator">+</span> <span class="token number">1057597610</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">67</span> <span class="token operator">+</span> <span class="token number">482243092</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">66</span> <span class="token operator">+</span> <span class="token number">277530014</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">65</span> <span class="token operator">+</span> <span class="token number">2393168828</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">64</span> <span class="token operator">+</span> <span class="token number">12380707</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">63</span> <span class="token operator">+</span> <span class="token number">1108646500</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">62</span> <span class="token operator">+</span> <span class="token number">637721571</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">61</span> <span class="token operator">+</span> <span class="token number">604983755</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">60</span> <span class="token operator">+</span> <span class="token number">1142068056</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">59</span> <span class="token operator">+</span> <span class="token number">1911643955</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">58</span> <span class="token operator">+</span> <span class="token number">1713852330</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">57</span> <span class="token operator">+</span> <span class="token number">1757273231</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">56</span> <span class="token operator">+</span> <span class="token number">1778819295</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">55</span> <span class="token operator">+</span> <span class="token number">957146826</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">54</span> <span class="token operator">+</span> <span class="token number">900005615</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">53</span> <span class="token operator">+</span> <span class="token number">521467961</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">52</span> <span class="token operator">+</span> <span class="token number">1255707235</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">51</span> <span class="token operator">+</span> <span class="token number">861871574</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">50</span> <span class="token operator">+</span> <span class="token number">397953653</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">49</span> <span class="token operator">+</span> <span class="token number">1259753202</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">48</span> <span class="token operator">+</span> <span class="token number">471431762</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">47</span> <span class="token operator">+</span> <span class="token number">1245956917</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">46</span> <span class="token operator">+</span> <span class="token number">1688297180</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">45</span> <span class="token operator">+</span> <span class="token number">1536178591</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">44</span> <span class="token operator">+</span> <span class="token number">1833258462</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">43</span> <span class="token operator">+</span> <span class="token number">1369087493</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">42</span> <span class="token operator">+</span> <span class="token number">459426544</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">41</span> <span class="token operator">+</span> <span class="token number">418389643</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">40</span> <span class="token operator">+</span> <span class="token number">1800239647</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">39</span> <span class="token operator">+</span> <span class="token number">2467433889</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">38</span> <span class="token operator">+</span> <span class="token number">477713059</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">37</span> <span class="token operator">+</span> <span class="token number">1898813986</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">36</span> <span class="token operator">+</span> <span class="token number">2202042708</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">35</span> <span class="token operator">+</span> <span class="token number">894088738</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">34</span> <span class="token operator">+</span> <span class="token number">1204601190</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">33</span> <span class="token operator">+</span> <span class="token number">1592921228</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">32</span> <span class="token operator">+</span> <span class="token number">2234027582</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">31</span> <span class="token operator">+</span> <span class="token number">1308900201</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">30</span> <span class="token operator">+</span> <span class="token number">461430959</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">29</span> <span class="token operator">+</span> <span class="token number">718926726</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">28</span> <span class="token operator">+</span> <span class="token number">2081988029</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">27</span> <span class="token operator">+</span> <span class="token number">1337342428</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">26</span> <span class="token operator">+</span> <span class="token number">2039153142</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">25</span> <span class="token operator">+</span> <span class="token number">1364177470</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">24</span> <span class="token operator">+</span> <span class="token number">613659517</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">23</span> <span class="token operator">+</span> <span class="token number">853968854</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">22</span> <span class="token operator">+</span> <span class="token number">1013582418</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">21</span> <span class="token operator">+</span> <span class="token number">1167857934</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">20</span> <span class="token operator">+</span> <span class="token number">2014147362</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">19</span> <span class="token operator">+</span> <span class="token number">1083466865</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">18</span> <span class="token operator">+</span> <span class="token number">1091690302</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">17</span> <span class="token operator">+</span> <span class="token number">302196939</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">16</span> <span class="token operator">+</span> <span class="token number">1946675573</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">15</span> <span class="token operator">+</span> <span class="token number">2450124113</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">14</span> <span class="token operator">+</span> <span class="token number">1199066291</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">13</span> <span class="token operator">+</span> <span class="token number">401889502</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">12</span> <span class="token operator">+</span> <span class="token number">712045611</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">11</span> <span class="token operator">+</span> <span class="token number">1850096904</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">10</span> <span class="token operator">+</span> <span class="token number">1808400208</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">9</span> <span class="token operator">+</span> <span class="token number">1567687877</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">8</span> <span class="token operator">+</span> <span class="token number">2013445952</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">7</span> <span class="token operator">+</span> <span class="token number">2435360770</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">6</span> <span class="token operator">+</span> <span class="token number">2414019676</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">5</span> <span class="token operator">+</span> <span class="token number">2277377050</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">4</span> <span class="token operator">+</span> <span class="token number">2148341337</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">3</span> <span class="token operator">+</span> <span class="token number">1073721716</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1045363399</span><span class="token operator">*</span>x <span class="token operator">+</span> <span class="token number">1809685811</span>
c <span class="token operator">=</span> <span class="token number">922927962</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">254</span> <span class="token operator">+</span> <span class="token number">1141958714</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">253</span> <span class="token operator">+</span> <span class="token number">295409606</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">252</span> <span class="token operator">+</span> <span class="token number">1197491798</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">251</span> <span class="token operator">+</span> <span class="token number">2463440866</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">250</span> <span class="token operator">+</span> <span class="token number">1671460946</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">249</span> <span class="token operator">+</span> <span class="token number">967543123</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">248</span> <span class="token operator">+</span> <span class="token number">119796323</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">247</span> <span class="token operator">+</span> <span class="token number">1172760592</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">246</span> <span class="token operator">+</span> <span class="token number">770640267</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">245</span> <span class="token operator">+</span> <span class="token number">1093816376</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">244</span> <span class="token operator">+</span> <span class="token number">196379610</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">243</span> <span class="token operator">+</span> <span class="token number">2205270506</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">242</span> <span class="token operator">+</span> <span class="token number">459693142</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">241</span> <span class="token operator">+</span> <span class="token number">829093322</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">240</span> <span class="token operator">+</span> <span class="token number">816440689</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">239</span> <span class="token operator">+</span> <span class="token number">648546871</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">238</span> <span class="token operator">+</span> <span class="token number">1533372161</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">237</span> <span class="token operator">+</span> <span class="token number">1349964227</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">236</span> <span class="token operator">+</span> <span class="token number">2132166634</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">235</span> <span class="token operator">+</span> <span class="token number">403690250</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">234</span> <span class="token operator">+</span> <span class="token number">835793319</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">233</span> <span class="token operator">+</span> <span class="token number">2056945807</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">232</span> <span class="token operator">+</span> <span class="token number">480459588</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">231</span> <span class="token operator">+</span> <span class="token number">1401028924</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">230</span> <span class="token operator">+</span> <span class="token number">2231055325</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">229</span> <span class="token operator">+</span> <span class="token number">1716893325</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">228</span> <span class="token operator">+</span> <span class="token number">16299164</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">227</span> <span class="token operator">+</span> <span class="token number">1125072063</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">226</span> <span class="token operator">+</span> <span class="token number">1903340994</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">225</span> <span class="token operator">+</span> <span class="token number">1372971897</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">224</span> <span class="token operator">+</span> <span class="token number">242927971</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">223</span> <span class="token operator">+</span> <span class="token number">711296789</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">222</span> <span class="token operator">+</span> <span class="token number">535407256</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">221</span> <span class="token operator">+</span> <span class="token number">976773179</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">220</span> <span class="token operator">+</span> <span class="token number">533569974</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">219</span> <span class="token operator">+</span> <span class="token number">501041034</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">218</span> <span class="token operator">+</span> <span class="token number">326232105</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">217</span> <span class="token operator">+</span> <span class="token number">2248775507</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">216</span> <span class="token operator">+</span> <span class="token number">1010397596</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">215</span> <span class="token operator">+</span> <span class="token number">1641864795</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">214</span> <span class="token operator">+</span> <span class="token number">1365178317</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">213</span> <span class="token operator">+</span> <span class="token number">1038477612</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">212</span> <span class="token operator">+</span> <span class="token number">2201213637</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">211</span> <span class="token operator">+</span> <span class="token number">760847531</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">210</span> <span class="token operator">+</span> <span class="token number">2072085932</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">209</span> <span class="token operator">+</span> <span class="token number">168159257</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">208</span> <span class="token operator">+</span> <span class="token number">70202009</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">207</span> <span class="token operator">+</span> <span class="token number">1193933930</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">206</span> <span class="token operator">+</span> <span class="token number">1559162272</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">205</span> <span class="token operator">+</span> <span class="token number">1380642174</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">204</span> <span class="token operator">+</span> <span class="token number">1296625644</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">203</span> <span class="token operator">+</span> <span class="token number">1338288152</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">202</span> <span class="token operator">+</span> <span class="token number">843839510</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">201</span> <span class="token operator">+</span> <span class="token number">460174838</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">200</span> <span class="token operator">+</span> <span class="token number">660412151</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">199</span> <span class="token operator">+</span> <span class="token number">716865491</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">198</span> <span class="token operator">+</span> <span class="token number">772161222</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">197</span> <span class="token operator">+</span> <span class="token number">924177515</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">196</span> <span class="token operator">+</span> <span class="token number">1372790342</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">195</span> <span class="token operator">+</span> <span class="token number">320044037</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">194</span> <span class="token operator">+</span> <span class="token number">117027412</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">193</span> <span class="token operator">+</span> <span class="token number">814803809</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">192</span> <span class="token operator">+</span> <span class="token number">1175035545</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">191</span> <span class="token operator">+</span> <span class="token number">244769161</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">190</span> <span class="token operator">+</span> <span class="token number">2116927976</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">189</span> <span class="token operator">+</span> <span class="token number">617780431</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">188</span> <span class="token operator">+</span> <span class="token number">342577832</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">187</span> <span class="token operator">+</span> <span class="token number">356586691</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">186</span> <span class="token operator">+</span> <span class="token number">695795444</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">185</span> <span class="token operator">+</span> <span class="token number">281750528</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">184</span> <span class="token operator">+</span> <span class="token number">133432552</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">183</span> <span class="token operator">+</span> <span class="token number">741747447</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">182</span> <span class="token operator">+</span> <span class="token number">2138036298</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">181</span> <span class="token operator">+</span> <span class="token number">524386605</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">180</span> <span class="token operator">+</span> <span class="token number">1231287380</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">179</span> <span class="token operator">+</span> <span class="token number">1246706891</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">178</span> <span class="token operator">+</span> <span class="token number">69277523</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">177</span> <span class="token operator">+</span> <span class="token number">2124927225</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">176</span> <span class="token operator">+</span> <span class="token number">2334697345</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">175</span> <span class="token operator">+</span> <span class="token number">1769733543</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">174</span> <span class="token operator">+</span> <span class="token number">2248037872</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">173</span> <span class="token operator">+</span> <span class="token number">1899902290</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">172</span> <span class="token operator">+</span> <span class="token number">409421149</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">171</span> <span class="token operator">+</span> <span class="token number">1223261878</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">170</span> <span class="token operator">+</span> <span class="token number">666594221</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">169</span> <span class="token operator">+</span> <span class="token number">1795456341</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">168</span> <span class="token operator">+</span> <span class="token number">406003299</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">167</span> <span class="token operator">+</span> <span class="token number">992699270</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">166</span> <span class="token operator">+</span> <span class="token number">2201384104</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">165</span> <span class="token operator">+</span> <span class="token number">907692883</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">164</span> <span class="token operator">+</span> <span class="token number">1667882231</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">163</span> <span class="token operator">+</span> <span class="token number">1414341647</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">162</span> <span class="token operator">+</span> <span class="token number">1592159752</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">161</span> <span class="token operator">+</span> <span class="token number">28054099</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">160</span> <span class="token operator">+</span> <span class="token number">2184618098</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">159</span> <span class="token operator">+</span> <span class="token number">2047102725</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">158</span> <span class="token operator">+</span> <span class="token number">103202495</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">157</span> <span class="token operator">+</span> <span class="token number">1803852525</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">156</span> <span class="token operator">+</span> <span class="token number">446464179</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">155</span> <span class="token operator">+</span> <span class="token number">909116906</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">154</span> <span class="token operator">+</span> <span class="token number">1541693644</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">153</span> <span class="token operator">+</span> <span class="token number">166545130</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">152</span> <span class="token operator">+</span> <span class="token number">2283548843</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">151</span> <span class="token operator">+</span> <span class="token number">2348768005</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">150</span> <span class="token operator">+</span> <span class="token number">71682607</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">149</span> <span class="token operator">+</span> <span class="token number">484339546</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">148</span> <span class="token operator">+</span> <span class="token number">669511666</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">147</span> <span class="token operator">+</span> <span class="token number">2110974006</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">146</span> <span class="token operator">+</span> <span class="token number">1634563992</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">145</span> <span class="token operator">+</span> <span class="token number">1810433926</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">144</span> <span class="token operator">+</span> <span class="token number">2388805064</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">143</span> <span class="token operator">+</span> <span class="token number">1200258695</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">142</span> <span class="token operator">+</span> <span class="token number">1555191384</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">141</span> <span class="token operator">+</span> <span class="token number">363842947</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">140</span> <span class="token operator">+</span> <span class="token number">1105757887</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">139</span> <span class="token operator">+</span> <span class="token number">402111289</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">138</span> <span class="token operator">+</span> <span class="token number">361094351</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">137</span> <span class="token operator">+</span> <span class="token number">1788238752</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">136</span> <span class="token operator">+</span> <span class="token number">2017677334</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">135</span> <span class="token operator">+</span> <span class="token number">1506224550</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">134</span> <span class="token operator">+</span> <span class="token number">648916609</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">133</span> <span class="token operator">+</span> <span class="token number">2008973424</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">132</span> <span class="token operator">+</span> <span class="token number">2452922307</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">131</span> <span class="token operator">+</span> <span class="token number">1446527028</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">130</span> <span class="token operator">+</span> <span class="token number">29659632</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">129</span> <span class="token operator">+</span> <span class="token number">627390142</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">128</span> <span class="token operator">+</span> <span class="token number">1695661760</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">127</span> <span class="token operator">+</span> <span class="token number">734686497</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">126</span> <span class="token operator">+</span> <span class="token number">227059690</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">125</span> <span class="token operator">+</span> <span class="token number">1219692361</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">124</span> <span class="token operator">+</span> <span class="token number">635166359</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">123</span> <span class="token operator">+</span> <span class="token number">428703291</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">122</span> <span class="token operator">+</span> <span class="token number">2334823064</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">121</span> <span class="token operator">+</span> <span class="token number">204888978</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">120</span> <span class="token operator">+</span> <span class="token number">1694957361</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">119</span> <span class="token operator">+</span> <span class="token number">94211180</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">118</span> <span class="token operator">+</span> <span class="token number">2207723563</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">117</span> <span class="token operator">+</span> <span class="token number">872340606</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">116</span> <span class="token operator">+</span> <span class="token number">46197669</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">115</span> <span class="token operator">+</span> <span class="token number">710312088</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">114</span> <span class="token operator">+</span> <span class="token number">305132032</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">113</span> <span class="token operator">+</span> <span class="token number">1621042631</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">112</span> <span class="token operator">+</span> <span class="token number">2023404084</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">111</span> <span class="token operator">+</span> <span class="token number">2169254305</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">110</span> <span class="token operator">+</span> <span class="token number">463525650</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">109</span> <span class="token operator">+</span> <span class="token number">2349964255</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">108</span> <span class="token operator">+</span> <span class="token number">626689949</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">107</span> <span class="token operator">+</span> <span class="token number">2072533779</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">106</span> <span class="token operator">+</span> <span class="token number">177264308</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">105</span> <span class="token operator">+</span> <span class="token number">153948342</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">104</span> <span class="token operator">+</span> <span class="token number">1992646054</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">103</span> <span class="token operator">+</span> <span class="token number">2379817214</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">102</span> <span class="token operator">+</span> <span class="token number">1396334187</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">101</span> <span class="token operator">+</span> <span class="token number">2254165812</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">100</span> <span class="token operator">+</span> <span class="token number">1300455472</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">99</span> <span class="token operator">+</span> <span class="token number">2396842759</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">98</span> <span class="token operator">+</span> <span class="token number">2398953180</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">97</span> <span class="token operator">+</span> <span class="token number">88249450</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">96</span> <span class="token operator">+</span> <span class="token number">1726340322</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">95</span> <span class="token operator">+</span> <span class="token number">2004986735</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">94</span> <span class="token operator">+</span> <span class="token number">2446249940</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">93</span> <span class="token operator">+</span> <span class="token number">520126803</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">92</span> <span class="token operator">+</span> <span class="token number">821544954</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">91</span> <span class="token operator">+</span> <span class="token number">1177737015</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">90</span> <span class="token operator">+</span> <span class="token number">676286546</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">89</span> <span class="token operator">+</span> <span class="token number">1519043368</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">88</span> <span class="token operator">+</span> <span class="token number">224894464</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">87</span> <span class="token operator">+</span> <span class="token number">1742023262</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">86</span> <span class="token operator">+</span> <span class="token number">142627164</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">85</span> <span class="token operator">+</span> <span class="token number">1427710141</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">84</span> <span class="token operator">+</span> <span class="token number">1504189919</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">83</span> <span class="token operator">+</span> <span class="token number">688315682</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">82</span> <span class="token operator">+</span> <span class="token number">1397842239</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">81</span> <span class="token operator">+</span> <span class="token number">435187331</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">80</span> <span class="token operator">+</span> <span class="token number">433176780</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">79</span> <span class="token operator">+</span> <span class="token number">454834357</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">78</span> <span class="token operator">+</span> <span class="token number">1046713282</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">77</span> <span class="token operator">+</span> <span class="token number">1208458516</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">76</span> <span class="token operator">+</span> <span class="token number">811240741</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">75</span> <span class="token operator">+</span> <span class="token number">151611952</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">74</span> <span class="token operator">+</span> <span class="token number">164192249</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">73</span> <span class="token operator">+</span> <span class="token number">353336244</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">72</span> <span class="token operator">+</span> <span class="token number">1779538914</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">71</span> <span class="token operator">+</span> <span class="token number">1489144873</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">70</span> <span class="token operator">+</span> <span class="token number">213140082</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">69</span> <span class="token operator">+</span> <span class="token number">1874778522</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">68</span> <span class="token operator">+</span> <span class="token number">908618863</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">67</span> <span class="token operator">+</span> <span class="token number">1058334731</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">66</span> <span class="token operator">+</span> <span class="token number">1706255211</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">65</span> <span class="token operator">+</span> <span class="token number">708134837</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">64</span> <span class="token operator">+</span> <span class="token number">1382118347</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">63</span> <span class="token operator">+</span> <span class="token number">2111915733</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">62</span> <span class="token operator">+</span> <span class="token number">1273497300</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">61</span> <span class="token operator">+</span> <span class="token number">368639880</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">60</span> <span class="token operator">+</span> <span class="token number">1652005004</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">59</span> <span class="token operator">+</span> <span class="token number">1977610754</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">58</span> <span class="token operator">+</span> <span class="token number">1412680185</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">57</span> <span class="token operator">+</span> <span class="token number">2312775720</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">56</span> <span class="token operator">+</span> <span class="token number">59793381</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">55</span> <span class="token operator">+</span> <span class="token number">1345145822</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">54</span> <span class="token operator">+</span> <span class="token number">627534850</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">53</span> <span class="token operator">+</span> <span class="token number">2159477761</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">52</span> <span class="token operator">+</span> <span class="token number">10450988</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">51</span> <span class="token operator">+</span> <span class="token number">1479007796</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">50</span> <span class="token operator">+</span> <span class="token number">2082579205</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">49</span> <span class="token operator">+</span> <span class="token number">1158447154</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">48</span> <span class="token operator">+</span> <span class="token number">126359830</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">47</span> <span class="token operator">+</span> <span class="token number">393411272</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">46</span> <span class="token operator">+</span> <span class="token number">2343384236</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">45</span> <span class="token operator">+</span> <span class="token number">2191577465</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">44</span> <span class="token operator">+</span> <span class="token number">1281188680</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">43</span> <span class="token operator">+</span> <span class="token number">230049708</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">42</span> <span class="token operator">+</span> <span class="token number">539600199</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">41</span> <span class="token operator">+</span> <span class="token number">1711135601</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">40</span> <span class="token operator">+</span> <span class="token number">1659775448</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">39</span> <span class="token operator">+</span> <span class="token number">1716176055</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">38</span> <span class="token operator">+</span> <span class="token number">904363231</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">37</span> <span class="token operator">+</span> <span class="token number">2385749710</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">36</span> <span class="token operator">+</span> <span class="token number">567278351</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">35</span> <span class="token operator">+</span> <span class="token number">404199078</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">34</span> <span class="token operator">+</span> <span class="token number">372670353</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">33</span> <span class="token operator">+</span> <span class="token number">1286079784</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">32</span> <span class="token operator">+</span> <span class="token number">1744355671</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">31</span> <span class="token operator">+</span> <span class="token number">2316856064</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">30</span> <span class="token operator">+</span> <span class="token number">2106475476</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">29</span> <span class="token operator">+</span> <span class="token number">614988454</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">28</span> <span class="token operator">+</span> <span class="token number">2149964943</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">27</span> <span class="token operator">+</span> <span class="token number">1065233185</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">26</span> <span class="token operator">+</span> <span class="token number">188130174</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">25</span> <span class="token operator">+</span> <span class="token number">540415659</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">24</span> <span class="token operator">+</span> <span class="token number">1031409799</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">23</span> <span class="token operator">+</span> <span class="token number">1067085678</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">22</span> <span class="token operator">+</span> <span class="token number">1005161755</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">21</span> <span class="token operator">+</span> <span class="token number">249654085</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">20</span> <span class="token operator">+</span> <span class="token number">1816791634</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">19</span> <span class="token operator">+</span> <span class="token number">1437500292</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">18</span> <span class="token operator">+</span> <span class="token number">448596413</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">17</span> <span class="token operator">+</span> <span class="token number">2397497659</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">16</span> <span class="token operator">+</span> <span class="token number">2353732701</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">15</span> <span class="token operator">+</span> <span class="token number">2068949189</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">14</span> <span class="token operator">+</span> <span class="token number">1826419168</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">13</span> <span class="token operator">+</span> <span class="token number">1265366199</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">12</span> <span class="token operator">+</span> <span class="token number">547031306</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">11</span> <span class="token operator">+</span> <span class="token number">1016962374</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">10</span> <span class="token operator">+</span> <span class="token number">160089486</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">9</span> <span class="token operator">+</span> <span class="token number">2264803979</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">8</span> <span class="token operator">+</span> <span class="token number">1081806194</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">7</span> <span class="token operator">+</span> <span class="token number">824215340</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">6</span> <span class="token operator">+</span> <span class="token number">497731793</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">5</span> <span class="token operator">+</span> <span class="token number">45017166</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">4</span> <span class="token operator">+</span> <span class="token number">317548920</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">3</span> <span class="token operator">+</span> <span class="token number">1391127733</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1752881284</span><span class="token operator">*</span>x <span class="token operator">+</span> <span class="token number">1290424106</span>

q1<span class="token punctuation">,</span> q2 <span class="token operator">=</span> n<span class="token punctuation">.</span>factor<span class="token punctuation">(</span><span class="token punctuation">)</span>
q1<span class="token punctuation">,</span> q2 <span class="token operator">=</span> q1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">**</span>q1<span class="token punctuation">.</span>degree<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>p<span class="token operator">**</span>q2<span class="token punctuation">.</span>degree<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> gcd<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span>
d <span class="token operator">=</span> inverse_mod<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span>

flag <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>coefficients<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Flag: "</span><span class="token punctuation">,</span> flag<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h2 id="funnyrsa1"><a href="#funnyrsa1" class="headerlink" title="funnyrsa1"></a>funnyrsa1</h2><p>题目如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">e1 <span class="token operator">=</span> <span class="token number">14606334023791426</span>
p1 <span class="token operator">=</span> <span class="token number">121009772735460235364940622989433807619211926015494087453674747614331295040063679722422298286549493698150690694965106103822315378461970129912436074962111424616439032849788953648286506433464358834178903821069564798378666159882090757625817745990230736982709059859613843100974349380542982235135982530318438330859</span>
q1 <span class="token operator">=</span> <span class="token number">130968576816900149996914427770826228884925960001279609559095138835900329492765336419489982304805369724685145941218640504262821549441728192761733409684831633194346504685627189375724517070780334885673563409259345291959439026700006694655545512308390416859315892447092639503318475587220630455745460309886030186593</span>
c1 <span class="token operator">=</span> <span class="token number">11402389955595766056824801105373550411371729054679429421548608725777586555536302409478824585455648944737304660137306241012321255955693234304201530700362069004620531537922710568821152217381257446478619320278993539785699090234418603086426252498046106436360959622415398647198014716351359752734123844386459925553497427680448633869522591650121047156082228109421246662020164222925272078687550896012363926358633323439494967417041681357707006545728719651494384317497942177993032739778398001952201667284323691607312819796036779374423837576479275454953999865750584684592993292347483309178232523897058253412878901324740104919248</span>

e2 <span class="token operator">=</span> <span class="token number">13813369129257838</span>
p2 <span class="token operator">=</span> <span class="token number">121009772735460235364940622989433807619211926015494087453674747614331295040063679722422298286549493698150690694965106103822315378461970129912436074962111424616439032849788953648286506433464358834178903821069564798378666159882090757625817745990230736982709059859613843100974349380542982235135982530318438330859</span>
q2 <span class="token operator">=</span> <span class="token number">94582257784130735233174402362819395926641026753071039760251190444144495369829487705195913337502962816079184062352678128843179586054535283861793827497892600954650126991213176547276006780610945133603745974181504975165082485845571788686928859549252522952174376071500707863379238688200493621993937563296490615649</span>
c2 <span class="token operator">=</span> <span class="token number">7984888899827615209197324489527982755561403577403539988687419233579203660429542197972867526015619223510964699107198708420785278262082902359114040327940253582108364104049849773108799812000586446829979564395322118616382603675257162995702363051699403525169767736410365076696890117813211614468971386159587698853722658492385717150691206731593509168262529568464496911821756352254486299361607604338523750318977620039669792468240086472218586697386948479265417452517073901655900118259488507311321060895347770921790483894095085039802955700146474474606794444308825840221205073230671387989412399673375520605000270180367035526919</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>首先看到两个e都不是素数，直接上factordb，两个可以分解为：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">14606334023791426</span> <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token number">7</span> <span class="token operator">*</span> <span class="token number">1043309573127959</span>
<span class="token number">13813369129257838</span> <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token number">7</span> <span class="token operator">*</span> <span class="token number">986669223518417</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>原本的想法是先求出m^14，再对m开14次方，但指数过大，这个方法是不合理的。题目既然给了两组数据，自然有它的道理。仔细观察发现p1是一样的，又有两组n和e，联想到中国剩余定理， 巧妙之处在于可以把n1和n2拆开，构造出同余方程组，求解m。：</p>
<p><img "" class="lazyload placeholder" data-original="/2021/09/15/CTFSHOW-unusualrsa/Post15_image5.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt></p>
<p>但是这题不能使用：</p>
<p><img "" class="lazyload placeholder" data-original="/2021/09/15/CTFSHOW-unusualrsa/Post15_image4.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt></p>
<p>因为14依然和phin有公约数，所以我们要构造出与14互素的数，<a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/164575">参考博客</a>中说到在上面的三个同余方程中的最后两个方程可以合并成：</p>
<p><img "" class="lazyload placeholder" data-original="/2021/09/15/CTFSHOW-unusualrsa/Post15_image6.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt></p>
<p>这样就变成了新的RSA解密了，注意最后的e依然不是素数开拆成：2 * 7，最后开平方就是m，脚本如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> gmpy2

<span class="token keyword">def</span> <span class="token function">CRT</span><span class="token punctuation">(</span>a_list<span class="token punctuation">,</span> m_list<span class="token punctuation">)</span><span class="token punctuation">:</span>
    M <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>m_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        M <span class="token operator">*=</span> m_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span>

    x <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>m_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        Mi <span class="token operator">=</span> M <span class="token operator">//</span> m_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        M_inverse <span class="token operator">=</span> inverse<span class="token punctuation">(</span>Mi<span class="token punctuation">,</span> m_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        x <span class="token operator">+=</span> a_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> M_inverse <span class="token operator">*</span> Mi
    x <span class="token operator">%=</span> M
    <span class="token keyword">return</span> x

e1 <span class="token operator">=</span> <span class="token number">14606334023791426</span>
p1 <span class="token operator">=</span> <span class="token number">121009772735460235364940622989433807619211926015494087453674747614331295040063679722422298286549493698150690694965106103822315378461970129912436074962111424616439032849788953648286506433464358834178903821069564798378666159882090757625817745990230736982709059859613843100974349380542982235135982530318438330859</span>
q1 <span class="token operator">=</span> <span class="token number">130968576816900149996914427770826228884925960001279609559095138835900329492765336419489982304805369724685145941218640504262821549441728192761733409684831633194346504685627189375724517070780334885673563409259345291959439026700006694655545512308390416859315892447092639503318475587220630455745460309886030186593</span>
c1 <span class="token operator">=</span> <span class="token number">11402389955595766056824801105373550411371729054679429421548608725777586555536302409478824585455648944737304660137306241012321255955693234304201530700362069004620531537922710568821152217381257446478619320278993539785699090234418603086426252498046106436360959622415398647198014716351359752734123844386459925553497427680448633869522591650121047156082228109421246662020164222925272078687550896012363926358633323439494967417041681357707006545728719651494384317497942177993032739778398001952201667284323691607312819796036779374423837576479275454953999865750584684592993292347483309178232523897058253412878901324740104919248</span>

e2 <span class="token operator">=</span> <span class="token number">13813369129257838</span>
p2 <span class="token operator">=</span> <span class="token number">121009772735460235364940622989433807619211926015494087453674747614331295040063679722422298286549493698150690694965106103822315378461970129912436074962111424616439032849788953648286506433464358834178903821069564798378666159882090757625817745990230736982709059859613843100974349380542982235135982530318438330859</span>
q2 <span class="token operator">=</span> <span class="token number">94582257784130735233174402362819395926641026753071039760251190444144495369829487705195913337502962816079184062352678128843179586054535283861793827497892600954650126991213176547276006780610945133603745974181504975165082485845571788686928859549252522952174376071500707863379238688200493621993937563296490615649</span>
c2 <span class="token operator">=</span> <span class="token number">7984888899827615209197324489527982755561403577403539988687419233579203660429542197972867526015619223510964699107198708420785278262082902359114040327940253582108364104049849773108799812000586446829979564395322118616382603675257162995702363051699403525169767736410365076696890117813211614468971386159587698853722658492385717150691206731593509168262529568464496911821756352254486299361607604338523750318977620039669792468240086472218586697386948479265417452517073901655900118259488507311321060895347770921790483894095085039802955700146474474606794444308825840221205073230671387989412399673375520605000270180367035526919</span>

phin1 <span class="token operator">=</span> <span class="token punctuation">(</span>p1 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q1 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
tmp <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> e2<span class="token punctuation">)</span>
e1 <span class="token operator">=</span> e1<span class="token operator">//</span> tmp
d <span class="token operator">=</span> invmod<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> phin1<span class="token punctuation">)</span>
plainer1 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> d<span class="token punctuation">,</span> p1 <span class="token operator">*</span> q1<span class="token punctuation">)</span>

phin2 <span class="token operator">=</span> <span class="token punctuation">(</span>p2 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q2 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
e2 <span class="token operator">=</span> e2<span class="token operator">//</span> tmp
d <span class="token operator">=</span> invmod<span class="token punctuation">(</span>e2<span class="token punctuation">,</span> phin2<span class="token punctuation">)</span>
plainer2 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c2<span class="token punctuation">,</span> d<span class="token punctuation">,</span> p2 <span class="token operator">*</span> q2<span class="token punctuation">)</span>

m3 <span class="token operator">=</span> plainer1 <span class="token operator">%</span> <span class="token punctuation">(</span>p1 <span class="token operator">*</span> q1<span class="token punctuation">)</span>
m2 <span class="token operator">=</span> plainer2 <span class="token operator">%</span> <span class="token punctuation">(</span>p2 <span class="token operator">*</span> q2<span class="token punctuation">)</span>
m1 <span class="token operator">=</span> plainer1 <span class="token operator">%</span> q1
alist <span class="token operator">=</span> <span class="token punctuation">[</span>m1<span class="token punctuation">,</span> m2<span class="token punctuation">,</span> m3<span class="token punctuation">]</span>
mlist <span class="token operator">=</span> <span class="token punctuation">[</span>q1<span class="token punctuation">,</span> q2<span class="token punctuation">,</span> p1<span class="token punctuation">]</span>
m <span class="token operator">=</span> CRT<span class="token punctuation">(</span>alist<span class="token punctuation">,</span> mlist<span class="token punctuation">)</span>

n <span class="token operator">=</span> q1 <span class="token operator">*</span> q2
phin3 <span class="token operator">=</span> <span class="token punctuation">(</span>q1 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q2 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
d <span class="token operator">=</span> invmod<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> phin3<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>gmpy2<span class="token punctuation">.</span>iroot<span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h2 id="De1CTF2019-babyrsa"><a href="#De1CTF2019-babyrsa" class="headerlink" title="[De1CTF2019]babyrsa"></a>[De1CTF2019]babyrsa</h2><p>题目如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> binascii
<span class="token keyword">from</span> data <span class="token keyword">import</span> e1<span class="token punctuation">,</span>e2<span class="token punctuation">,</span>p<span class="token punctuation">,</span>q1p<span class="token punctuation">,</span>q1q<span class="token punctuation">,</span>hint<span class="token punctuation">,</span>flag

n <span class="token operator">=</span>  <span class="token punctuation">[</span>20129615352491765499340112943188317180548761597861300847305827141510465619670536844634558246439230371658836928103063432870245707180355907194284861510906071265352409579441048101084995923962148527097370705452070577098780246282820065573711015664291991372085157016901209114191068574208680397710042842835940428451949500607613634682684113208766694028789275748528254287705759528498986306494267817198340658241873024800336013946294891687591013414935237821291805123285905335762719823771647853378892868896078424572232934360940672962436849523915563328779942134504499568866135266628078485232098208237036724121481835035731201383423L<span class="token punctuation">,</span> 31221650155627849964466413749414700613823841060149524451234901677160009099014018926581094879840097248543411980533066831976617023676225625067854003317018794041723612556008471579060428898117790587991055681380408263382761841625714415879087478072771968160384909919958010983669368360788505288855946124159513118847747998656422521414980295212646675850690937883764000571667574381419144372824211798018586804674824564606122592483286575800685232128273820087791811663878057827386379787882962763290066072231248814920468264741654086011072638211075445447843691049847262485759393290853117072868406861840793895816215956869523289231421L<span class="token punctuation">,</span> 29944537515397953361520922774124192605524711306753835303703478890414163510777460559798334313021216389356251874917792007638299225821018849648520673813786772452822809546571129816310207232883239771324122884804993418958309460009406342872173189008449237959577469114158991202433476710581356243815713762802478454390273808377430685157110095496727966308001254107517967559384019734279861840997239176254236069001453544559786063915970071130087811123912044312219535513880663913831358790376650439083660611831156205113873793106880255882114422025746986403355066996567909581710647746463994280444700922867397754748628425967488232530303L<span class="token punctuation">,</span> 25703437855600135215185778453583925446912731661604054184163883272265503323016295700357253105301146726667897497435532579974951478354570415554221401778536104737296154316056314039449116386494323668483749833147800557403368489542273169489080222009368903993658498263905567516798684211462607069796613434661148186901892016282065916190920443378756167250809872483501712225782004396969996983057423942607174314132598421269169722518224478248836881076484639837343079324636997145199835034833367743079935361276149990997875905313642775214486046381368619638551892292787783137622261433528915269333426768947358552919740901860982679180791L<span class="token punctuation">]</span>
c <span class="token operator">=</span>  <span class="token punctuation">[</span>19131432661217908470262338421299691998526157790583544156741981238822158563988520225986915234570037383888112724408392918113942721994125505014727545946133307329781747600302829588248042922635714391033431930411180545085316438084317927348705241927570432757892985091396044950085462429575440060652967253845041398399648442340042970814415571904057667028157512971079384601724816308078631844480110201787343583073815186771790477712040051157180318804422120472007636722063989315320863580631330647116993819777750684150950416298085261478841177681677867236865666207391847046483954029213495373613490690687473081930148461830425717614569L<span class="token punctuation">,</span> 15341898433226638235160072029875733826956799982958107910250055958334922460202554924743144122170018355117452459472017133614642242411479849369061482860570279863692425621526056862808425135267608544855833358314071200687340442512856575278712986641573012456729402660597339609443771145347181268285050728925993518704899005416187250003304581230701444705157412790787027926810710998646191467130550713600765898234392350153965811595060656753711278308005193370936296124790772689433773414703645703910742193898471800081321469055211709339846392500706523670145259024267858368216902176489814789679472227343363035428541915118378163012031L<span class="token punctuation">,</span> 18715065071648040017967211297231106538139985087685358555650567057715550586464814763683688299037897182845007578571401359061213777645114414642903077003568155508465819628553747173244235936586812445440095450755154357646737087071605811984163416590278352605433362327949048243722556262979909488202442530307505819371594747936223835233586945423522256938701002370646382097846105014981763307729234675737702252155130837154876831885888669150418885088089324534892506199724486783446267336789872782137895552509353583305880144947714110009893134162185382309992604435664777436197587312317224862723813510974493087450281755452428746194446L<span class="token punctuation">,</span> 2282284561224858293138480447463319262474918847630148770112472703128549032592187797289965592615199709857879008271766433462032328498580340968871260189669707518557157836592424973257334362931639831072584824103123486522582531666152363874396482744561758133655406410364442174983227005501860927820871260711861008830120617056883514525798709601744088135999465598338635794275123149165498933580159945032363880613524921913023341209439657145962332213468573402863796920571812418200814817086234262280338221161622789516829363805084715652121739036183264026120868756523770196284142271849879003202190966150390061195469351716819539183797L<span class="token punctuation">]</span>
f<span class="token operator">=</span><span class="token keyword">lambda</span> m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">,</span>c<span class="token punctuation">:</span><span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">==</span>c
<span class="token keyword">assert</span><span class="token punctuation">(</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span><span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">,</span>n<span class="token punctuation">,</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">4</span><span class="token punctuation">)</span>

ee1 <span class="token operator">=</span> <span class="token number">42</span>
ee2 <span class="token operator">=</span> <span class="token number">3</span>
ce1 <span class="token operator">=</span>  <span class="token number">45722651786340123946960815003059322528810481841378247280642868553607692149509126962872583037142461398806689489141741494974836882341505234255325683219092163052843461632338442529011502378931140356111756932712822516814023166068902569458299933391973504078898958921809723346229893913662577294963528318424676803942288386430172430880307619748186863890050113934573820505570928109017842647598266634344447182347849367714564686341871007505886728393751147033556889217604647355628557502208364412269944908011305064122941446516990168924709684092200183860653173856272384</span>
ce2 <span class="token operator">=</span>  <span class="token number">13908468332333567158469136439932325992349696889129103935400760239319454409539725389747059213835238373047899198211128689374049729578146875309231962936554403287882999967840346216695208424582739777034261079550395918048421086843927009452479936045850799096750074359160775182238980989229190157551197830879877097703347301072427149474991803868325769967332356950863518504965486565464059770451458557744949735282131727956056279292800694203866167270268988437389945703117070604488999247750139568614939965885211276821987586882908159585863514561191905040244967655444219603287214405014887994238259270716355378069726760953320025828158</span>
tmp <span class="token operator">=</span>  <span class="token number">864078778078609835167779565982540757684070450697854309005171742813414963447462554999012718960925081621571487444725528982424037419052194840720949809891134854871222612682162490991065015935449289960707882463387</span>
n  <span class="token operator">=</span>  <span class="token number">15911581555796798614711625288508309704791837516232122410440958830726078821069050404012820896260071751380436992710638364294658173571101596931605797509712839622479368850251206419748090059752427303611760004621378226431226983665746837779056271530181865648115862947527212787824629516204832313026456390047768174765687040950636530480549014401279054346098030395100387004111574278813749630986724706263655166289586230453975953773791945408589484679371854113457758157492241225180907090235116325034822993748409011554673180494306003272836905082473475046277554085737627846557240367696214081276345071055578169299060706794192776825039</span>
<span class="token keyword">assert</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>e1<span class="token punctuation">,</span>ee1<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">==</span>ce1<span class="token punctuation">)</span>
<span class="token keyword">assert</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>e2<span class="token operator">+</span>tmp<span class="token punctuation">,</span>ee2<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">==</span>ce2<span class="token punctuation">)</span>

e <span class="token operator">=</span> <span class="token number">46531</span>
n <span class="token operator">=</span> <span class="token number">16278524034278364842964386062476113517067911891699789991355982121084973951738324063305190630865511554888330215827724887964565979607808294168282995825864982603759381323048907814961279012375346497781046417204954101076457350988751188332353062731641153547102721113593787978587135707313755661153376485647168543680503160420091693269984008764444291289486805840439906620313162344057956594836197521501755378387944609246120662335790110901623740990451586621846212047950084207251595169141015645449217847180683357626383565631317253913942886396494396189837432429078251573229378917400841832190737518763297323901586866664595327850603</span>
c <span class="token operator">=</span> <span class="token number">14992132140996160330967307558503117255626925777426611978518339050671013041490724616892634911030918360867974894371539160853827180596100892180735770688723270765387697604426715670445270819626709364566478781273676115921657967761494619448095207169386364541164659123273236874649888236433399127407801843412677293516986398190165291102109310458304626261648346825196743539220198199366711858135271877662410355585767124059539217274691606825103355310348607611233052725805236763220343249873849646219850954945346791015858261715967952461021650307307454434510851869862964236227932964442289459508441345652423088404453536608812799355469</span>
hint<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>binascii<span class="token punctuation">.</span>hexlify<span class="token punctuation">(</span>hint<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span><span class="token punctuation">(</span>q1p<span class="token operator">*</span>q1q<span class="token operator">==</span>n<span class="token punctuation">)</span>
<span class="token keyword">assert</span><span class="token punctuation">(</span>q1p<span class="token operator">&lt;</span>q1q<span class="token punctuation">)</span>
<span class="token keyword">assert</span><span class="token punctuation">(</span>c<span class="token operator">==</span><span class="token builtin">pow</span><span class="token punctuation">(</span>hint<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>

flag<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>binascii<span class="token punctuation">.</span>hexlify<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span>
q1<span class="token operator">=</span>q1p
q2 <span class="token operator">=</span>  <span class="token number">114401188227479584680884046151299704656920536168767132916589182357583461053336386996123783294932566567773695426689447410311969456458574731187512974868297092638677515283584994416382872450167046416573472658841627690987228528798356894803559278308702635288537653192098514966089168123710854679638671424978221959513</span>
c1 <span class="token operator">=</span>  <span class="token number">262739975753930281690942784321252339035906196846340713237510382364557685379543498765074448825799342194332681181129770046075018122033421983227887719610112028230603166527303021036386350781414447347150383783816869784006598225583375458609586450854602862569022571672049158809874763812834044257419199631217527367046624888837755311215081173386523806086783266198390289097231168172692326653657393522561741947951887577156666663584249108899327053951891486355179939770150550995812478327735917006194574412518819299303783243886962455399783601229227718787081785391010424030509937403600351414176138124705168002288620664809270046124</span>
c2 <span class="token operator">=</span>  <span class="token number">7395591129228876649030819616685821899204832684995757724924450812977470787822266387122334722132760470911599176362617225218345404468270014548817267727669872896838106451520392806497466576907063295603746660003188440170919490157250829308173310715318925771643105064882620746171266499859049038016902162599261409050907140823352990750298239508355767238575709803167676810456559665476121149766947851911064706646506705397091626648713684511780456955453552020460909638016134124590438425738826828694773960514221910109473941451471431637903182205738738109429736425025621308300895473186381826756650667842656050416299166317372707709596</span>
<span class="token keyword">assert</span><span class="token punctuation">(</span>c1<span class="token operator">==</span><span class="token builtin">pow</span><span class="token punctuation">(</span>flag<span class="token punctuation">,</span>e1<span class="token punctuation">,</span>p<span class="token operator">*</span>q1<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span><span class="token punctuation">(</span>c2<span class="token operator">==</span><span class="token builtin">pow</span><span class="token punctuation">(</span>flag<span class="token punctuation">,</span>e2<span class="token punctuation">,</span>p<span class="token operator">*</span>q2<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>看到最后的加密算法，用到了e1、e2、p、q1、q2等需要求解的数。首先看看p怎么求的吧，map函数将参数应用到f函数，相当于有4个p^4 %n = c，所以这里用到的是中国剩余定理。</p>
<p>转到第二段的e1和e2的加密算法，c1比n小数十个数量级，有可能是因为e1的42次方很小导致模n没有效果，所以直接对c1开42次方。ee2很小，直接用低加密指数攻击获取(e2+tmp)。</p>
<p>看到第三段加密算法，q1q和q1p相乘得到n，对n进行分解就可以得到了。hint内容：orz…you.found.me.but.sorry.no.hint…keep.on.and.enjoy.it!</p>
<p>来到最后一关，前面得到的e1和e2都不是素数，对它们进行分解后是2 x 7 x。。。，下面又只有两个密文，所以它的特征符合RSA相关信息攻击。前几天做到的funnyrsa2就是这种题型，所以可以直接引用前面做过的脚本，完整的脚本如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> gmpy2

<span class="token keyword">def</span> <span class="token function">CRT</span><span class="token punctuation">(</span>a_list<span class="token punctuation">,</span> m_list<span class="token punctuation">)</span><span class="token punctuation">:</span>
    M <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>m_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        M <span class="token operator">*=</span> m_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span>

    x <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>m_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        Mi <span class="token operator">=</span> M <span class="token operator">//</span> m_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        Mi_inverse <span class="token operator">=</span> inverse<span class="token punctuation">(</span>Mi<span class="token punctuation">,</span> m_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        x <span class="token operator">+=</span> a_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> Mi <span class="token operator">*</span> Mi_inverse
    x <span class="token operator">%=</span> M
    <span class="token keyword">return</span> x

n <span class="token operator">=</span>  <span class="token punctuation">[</span><span class="token number">20129615352491765499340112943188317180548761597861300847305827141510465619670536844634558246439230371658836928103063432870245707180355907194284861510906071265352409579441048101084995923962148527097370705452070577098780246282820065573711015664291991372085157016901209114191068574208680397710042842835940428451949500607613634682684113208766694028789275748528254287705759528498986306494267817198340658241873024800336013946294891687591013414935237821291805123285905335762719823771647853378892868896078424572232934360940672962436849523915563328779942134504499568866135266628078485232098208237036724121481835035731201383423</span><span class="token punctuation">,</span> <span class="token number">31221650155627849964466413749414700613823841060149524451234901677160009099014018926581094879840097248543411980533066831976617023676225625067854003317018794041723612556008471579060428898117790587991055681380408263382761841625714415879087478072771968160384909919958010983669368360788505288855946124159513118847747998656422521414980295212646675850690937883764000571667574381419144372824211798018586804674824564606122592483286575800685232128273820087791811663878057827386379787882962763290066072231248814920468264741654086011072638211075445447843691049847262485759393290853117072868406861840793895816215956869523289231421</span><span class="token punctuation">,</span> <span class="token number">29944537515397953361520922774124192605524711306753835303703478890414163510777460559798334313021216389356251874917792007638299225821018849648520673813786772452822809546571129816310207232883239771324122884804993418958309460009406342872173189008449237959577469114158991202433476710581356243815713762802478454390273808377430685157110095496727966308001254107517967559384019734279861840997239176254236069001453544559786063915970071130087811123912044312219535513880663913831358790376650439083660611831156205113873793106880255882114422025746986403355066996567909581710647746463994280444700922867397754748628425967488232530303</span><span class="token punctuation">,</span> <span class="token number">25703437855600135215185778453583925446912731661604054184163883272265503323016295700357253105301146726667897497435532579974951478354570415554221401778536104737296154316056314039449116386494323668483749833147800557403368489542273169489080222009368903993658498263905567516798684211462607069796613434661148186901892016282065916190920443378756167250809872483501712225782004396969996983057423942607174314132598421269169722518224478248836881076484639837343079324636997145199835034833367743079935361276149990997875905313642775214486046381368619638551892292787783137622261433528915269333426768947358552919740901860982679180791</span><span class="token punctuation">]</span>
c <span class="token operator">=</span>  <span class="token punctuation">[</span><span class="token number">19131432661217908470262338421299691998526157790583544156741981238822158563988520225986915234570037383888112724408392918113942721994125505014727545946133307329781747600302829588248042922635714391033431930411180545085316438084317927348705241927570432757892985091396044950085462429575440060652967253845041398399648442340042970814415571904057667028157512971079384601724816308078631844480110201787343583073815186771790477712040051157180318804422120472007636722063989315320863580631330647116993819777750684150950416298085261478841177681677867236865666207391847046483954029213495373613490690687473081930148461830425717614569</span><span class="token punctuation">,</span> <span class="token number">15341898433226638235160072029875733826956799982958107910250055958334922460202554924743144122170018355117452459472017133614642242411479849369061482860570279863692425621526056862808425135267608544855833358314071200687340442512856575278712986641573012456729402660597339609443771145347181268285050728925993518704899005416187250003304581230701444705157412790787027926810710998646191467130550713600765898234392350153965811595060656753711278308005193370936296124790772689433773414703645703910742193898471800081321469055211709339846392500706523670145259024267858368216902176489814789679472227343363035428541915118378163012031</span><span class="token punctuation">,</span> <span class="token number">18715065071648040017967211297231106538139985087685358555650567057715550586464814763683688299037897182845007578571401359061213777645114414642903077003568155508465819628553747173244235936586812445440095450755154357646737087071605811984163416590278352605433362327949048243722556262979909488202442530307505819371594747936223835233586945423522256938701002370646382097846105014981763307729234675737702252155130837154876831885888669150418885088089324534892506199724486783446267336789872782137895552509353583305880144947714110009893134162185382309992604435664777436197587312317224862723813510974493087450281755452428746194446</span><span class="token punctuation">,</span> <span class="token number">2282284561224858293138480447463319262474918847630148770112472703128549032592187797289965592615199709857879008271766433462032328498580340968871260189669707518557157836592424973257334362931639831072584824103123486522582531666152363874396482744561758133655406410364442174983227005501860927820871260711861008830120617056883514525798709601744088135999465598338635794275123149165498933580159945032363880613524921913023341209439657145962332213468573402863796920571812418200814817086234262280338221161622789516829363805084715652121739036183264026120868756523770196284142271849879003202190966150390061195469351716819539183797</span><span class="token punctuation">]</span>
p <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>iroot<span class="token punctuation">(</span>CRT<span class="token punctuation">(</span>c<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

e <span class="token operator">=</span> <span class="token number">46531</span>
n <span class="token operator">=</span> <span class="token number">16278524034278364842964386062476113517067911891699789991355982121084973951738324063305190630865511554888330215827724887964565979607808294168282995825864982603759381323048907814961279012375346497781046417204954101076457350988751188332353062731641153547102721113593787978587135707313755661153376485647168543680503160420091693269984008764444291289486805840439906620313162344057956594836197521501755378387944609246120662335790110901623740990451586621846212047950084207251595169141015645449217847180683357626383565631317253913942886396494396189837432429078251573229378917400841832190737518763297323901586866664595327850603</span>
c <span class="token operator">=</span> <span class="token number">14992132140996160330967307558503117255626925777426611978518339050671013041490724616892634911030918360867974894371539160853827180596100892180735770688723270765387697604426715670445270819626709364566478781273676115921657967761494619448095207169386364541164659123273236874649888236433399127407801843412677293516986398190165291102109310458304626261648346825196743539220198199366711858135271877662410355585767124059539217274691606825103355310348607611233052725805236763220343249873849646219850954945346791015858261715967952461021650307307454434510851869862964236227932964442289459508441345652423088404453536608812799355469</span>
q1p <span class="token operator">=</span> <span class="token number">127587319253436643569312142058559706815497211661083866592534217079310497260365307426095661281103710042392775453866174657404985539066741684196020137840472950102380232067786400322600902938984916355631714439668326671310160916766472897536055371474076089779472372913037040153356437528808922911484049460342088834871</span>
q1q <span class="token operator">=</span> <span class="token number">127587319253436643569312142058559706815497211661083866592534217079310497260365307426095661281103710042392775453866174657404985539066741684196020137840472950102380232067786400322600902938984916355631714439668326671310160916766472897536055371474076089779472372913037040153356437528808922911484049460342088835693</span>
phin1 <span class="token operator">=</span> <span class="token punctuation">(</span>q1p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q1q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
d <span class="token operator">=</span> inverse<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phin1<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>

ee1 <span class="token operator">=</span> <span class="token number">42</span>
ee2 <span class="token operator">=</span> <span class="token number">3</span>
ce1 <span class="token operator">=</span>  <span class="token number">45722651786340123946960815003059322528810481841378247280642868553607692149509126962872583037142461398806689489141741494974836882341505234255325683219092163052843461632338442529011502378931140356111756932712822516814023166068902569458299933391973504078898958921809723346229893913662577294963528318424676803942288386430172430880307619748186863890050113934573820505570928109017842647598266634344447182347849367714564686341871007505886728393751147033556889217604647355628557502208364412269944908011305064122941446516990168924709684092200183860653173856272384</span>
ce2 <span class="token operator">=</span>  <span class="token number">13908468332333567158469136439932325992349696889129103935400760239319454409539725389747059213835238373047899198211128689374049729578146875309231962936554403287882999967840346216695208424582739777034261079550395918048421086843927009452479936045850799096750074359160775182238980989229190157551197830879877097703347301072427149474991803868325769967332356950863518504965486565464059770451458557744949735282131727956056279292800694203866167270268988437389945703117070604488999247750139568614939965885211276821987586882908159585863514561191905040244967655444219603287214405014887994238259270716355378069726760953320025828158</span>
tmp <span class="token operator">=</span>  <span class="token number">864078778078609835167779565982540757684070450697854309005171742813414963447462554999012718960925081621571487444725528982424037419052194840720949809891134854871222612682162490991065015935449289960707882463387</span>
n <span class="token operator">=</span>  <span class="token number">15911581555796798614711625288508309704791837516232122410440958830726078821069050404012820896260071751380436992710638364294658173571101596931605797509712839622479368850251206419748090059752427303611760004621378226431226983665746837779056271530181865648115862947527212787824629516204832313026456390047768174765687040950636530480549014401279054346098030395100387004111574278813749630986724706263655166289586230453975953773791945408589484679371854113457758157492241225180907090235116325034822993748409011554673180494306003272836905082473475046277554085737627846557240367696214081276345071055578169299060706794192776825039</span>
e1 <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>iroot<span class="token punctuation">(</span>ce1<span class="token punctuation">,</span> ee1<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token comment">#print(m1[0])</span>
<span class="token comment">#15218928658178</span>
k <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>
    ans <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>iroot<span class="token punctuation">(</span>k <span class="token operator">*</span> n <span class="token operator">+</span> ce2<span class="token punctuation">,</span> ee2<span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ans<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">sum</span> <span class="token operator">=</span> ans<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        <span class="token keyword">break</span>
    k <span class="token operator">+=</span> <span class="token number">1</span>
<span class="token builtin">sum</span> <span class="token operator">=</span> <span class="token number">864078778078609835167779565982540757684070450697854309005171742813414963447462554999012718960925081621571487444725528982424037419052194840720949809891134854871222612682162490991065015935449290342499311738517</span>
e2 <span class="token operator">=</span> <span class="token builtin">sum</span> <span class="token operator">-</span> tmp
<span class="token comment">#print(e2)</span>
<span class="token comment">#381791429275130</span>

q1 <span class="token operator">=</span> q1p
q2 <span class="token operator">=</span>  <span class="token number">114401188227479584680884046151299704656920536168767132916589182357583461053336386996123783294932566567773695426689447410311969456458574731187512974868297092638677515283584994416382872450167046416573472658841627690987228528798356894803559278308702635288537653192098514966089168123710854679638671424978221959513</span>
c1 <span class="token operator">=</span>  <span class="token number">262739975753930281690942784321252339035906196846340713237510382364557685379543498765074448825799342194332681181129770046075018122033421983227887719610112028230603166527303021036386350781414447347150383783816869784006598225583375458609586450854602862569022571672049158809874763812834044257419199631217527367046624888837755311215081173386523806086783266198390289097231168172692326653657393522561741947951887577156666663584249108899327053951891486355179939770150550995812478327735917006194574412518819299303783243886962455399783601229227718787081785391010424030509937403600351414176138124705168002288620664809270046124</span>
c2 <span class="token operator">=</span>  <span class="token number">7395591129228876649030819616685821899204832684995757724924450812977470787822266387122334722132760470911599176362617225218345404468270014548817267727669872896838106451520392806497466576907063295603746660003188440170919490157250829308173310715318925771643105064882620746171266499859049038016902162599261409050907140823352990750298239508355767238575709803167676810456559665476121149766947851911064706646506705397091626648713684511780456955453552020460909638016134124590438425738826828694773960514221910109473941451471431637903182205738738109429736425025621308300895473186381826756650667842656050416299166317372707709596</span>

<span class="token keyword">assert</span><span class="token punctuation">(</span>gmpy2<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q1 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> gmpy2<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>e2<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q2 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

tmp <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q1 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
e1 <span class="token operator">=</span> e1 <span class="token operator">//</span> tmp
e2 <span class="token operator">=</span> e2 <span class="token operator">//</span> tmp
d1 <span class="token operator">=</span> inverse<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q1 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
d2 <span class="token operator">=</span> inverse<span class="token punctuation">(</span>e2<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q2 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
m1 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> d1<span class="token punctuation">,</span> p <span class="token operator">*</span> q1<span class="token punctuation">)</span>
m2 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c2<span class="token punctuation">,</span> d2<span class="token punctuation">,</span> p <span class="token operator">*</span> q2<span class="token punctuation">)</span>

m3 <span class="token operator">=</span> m1 <span class="token operator">%</span> p
m2 <span class="token operator">=</span> m2 <span class="token operator">%</span> q2
m1 <span class="token operator">=</span> m1 <span class="token operator">%</span> q1
alist <span class="token operator">=</span> <span class="token punctuation">[</span>m1<span class="token punctuation">,</span> m2<span class="token punctuation">,</span> m3<span class="token punctuation">]</span>
mlist <span class="token operator">=</span> <span class="token punctuation">[</span>q1<span class="token punctuation">,</span> q2<span class="token punctuation">,</span> p<span class="token punctuation">]</span>
m <span class="token operator">=</span> CRT<span class="token punctuation">(</span>alist<span class="token punctuation">,</span> mlist<span class="token punctuation">)</span>

n <span class="token operator">=</span> q1 <span class="token operator">*</span> q2
phin <span class="token operator">=</span> <span class="token punctuation">(</span>q1 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q2 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
d <span class="token operator">=</span> inverse<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> phin<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>gmpy2<span class="token punctuation">.</span>iroot<span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h2 id="小二难度R54"><a href="#小二难度R54" class="headerlink" title="小二难度R54"></a>小二难度R54</h2><p>题目如下：</p>
<pre class="line-numbers language-none"><code class="language-none">todo:
x, y &#x3D; [random_prime(2 ^ 1024 - 1, False, 2 ^ 1023) for _ in range(2)]
x * y, pow(2021 * x + 501 * y, x * y - x - y, x * y), pow(flag, 0o200001, x * y)
------------------------------------------------------------------------------------------------------------
gift:
[20947495659013288660808536751393787394664606045798093048128257278988208709333248671898749660848208653968668634891579612784633367362177864996602736258460476691940723323282467207875842974409286563660436709535601954405015261428106261369927836045794170912665351432105165546188591486357060490032334793140396757102052999128194027485573053073959574695808224922102635888141991154365047911830780778957642166757152369955362399379720841279167832886144458760347392316082994786119404006382441787685301119197529946566027319295285387108473752590621030421978808950305190250697199878929419723511578437404000924310974770501204226510397, 12911378830212711575909332427930495830030418987483519620282504671823307660633472092466534392403086505995560725428252134905285658936113891795434303336259751169171583600394870893708505805256284455729584616439559184469715186920464999723861722097244025658190194027561300165723184060071016117033960821040587421503448139025974851980482004179865110864844573575034406782936965166402665401330436229441569042660851847498727291447251591027480750458209012729510702196684303778564353025395186191064801000127420683298000173389589468742142444444759536629401472836827952997758216526858512433131954439154124668711408079361172485321041, 13390681135321846035598057088735733735860895610541899486616159864716324918810264721878447895634342127744578566110322466944217562868186608760962032192994397783118528288276520451944892998435079744244578731427626946331165523865930693902700790185275273534104979885060728696532991031786741950704918951536399577118136416956670893081637730646528913282395731901667720418372650030593319596584787752412110672058692368924987360383096340538971725402687347195347344826404005229912821371282465882351660619944919637382790572267512735645269618163597227604601321699186335016345484182059187046972681187078878556533926780789183784240737]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>看到加密算法：</p>
<p><img "" class="lazyload placeholder" data-original="/2021/09/15/CTFSHOW-unusualrsa/Post15_image7.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt></p>
<p>形式似于欧拉定理：</p>
<p><img "" class="lazyload placeholder" data-original="/2021/09/15/CTFSHOW-unusualrsa/Post15_image8.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif" alt></p>
<p>φ(n) = p<em>q - p - q + 1，根据欧拉定理pow(2021 </em> x + 501 <em> y, x </em> y - x - y，N)等于pow(2021 <em> x + 501 </em> y, -1，N)，那么把它求模N的逆就等于(2021 <em> x + 501 </em> y)。这样子，就有两个关于p和q的方程，使用z3求得p和q。脚本如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> gmpy2
<span class="token keyword">from</span> z3 <span class="token keyword">import</span> <span class="token operator">*</span>

N<span class="token punctuation">,</span> a<span class="token punctuation">,</span> cipher <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">20947495659013288660808536751393787394664606045798093048128257278988208709333248671898749660848208653968668634891579612784633367362177864996602736258460476691940723323282467207875842974409286563660436709535601954405015261428106261369927836045794170912665351432105165546188591486357060490032334793140396757102052999128194027485573053073959574695808224922102635888141991154365047911830780778957642166757152369955362399379720841279167832886144458760347392316082994786119404006382441787685301119197529946566027319295285387108473752590621030421978808950305190250697199878929419723511578437404000924310974770501204226510397</span><span class="token punctuation">,</span> <span class="token number">12911378830212711575909332427930495830030418987483519620282504671823307660633472092466534392403086505995560725428252134905285658936113891795434303336259751169171583600394870893708505805256284455729584616439559184469715186920464999723861722097244025658190194027561300165723184060071016117033960821040587421503448139025974851980482004179865110864844573575034406782936965166402665401330436229441569042660851847498727291447251591027480750458209012729510702196684303778564353025395186191064801000127420683298000173389589468742142444444759536629401472836827952997758216526858512433131954439154124668711408079361172485321041</span><span class="token punctuation">,</span> <span class="token number">13390681135321846035598057088735733735860895610541899486616159864716324918810264721878447895634342127744578566110322466944217562868186608760962032192994397783118528288276520451944892998435079744244578731427626946331165523865930693902700790185275273534104979885060728696532991031786741950704918951536399577118136416956670893081637730646528913282395731901667720418372650030593319596584787752412110672058692368924987360383096340538971725402687347195347344826404005229912821371282465882351660619944919637382790572267512735645269618163597227604601321699186335016345484182059187046972681187078878556533926780789183784240737</span><span class="token punctuation">]</span>
aa <span class="token operator">=</span> inverse<span class="token punctuation">(</span>a<span class="token punctuation">,</span> N<span class="token punctuation">)</span>

p<span class="token punctuation">,</span> q <span class="token operator">=</span> Ints<span class="token punctuation">(</span><span class="token string">'p q'</span><span class="token punctuation">)</span>
sol <span class="token operator">=</span> Solver<span class="token punctuation">(</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>p <span class="token operator">*</span> q <span class="token operator">==</span> N<span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">2021</span> <span class="token operator">*</span> p <span class="token operator">+</span> <span class="token number">501</span> <span class="token operator">*</span> q <span class="token operator">==</span> aa<span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>sol<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> sat<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>sol<span class="token punctuation">.</span>model<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

p <span class="token operator">=</span> <span class="token number">118025808013874567502972067396154378205921004159004592806833496003217679639841107629090128959992942958292926872941356148283178987927403535617729247751812776636333788905610726461255956234207606642302396722821445909489968841256943549868105578713493559907241758893208485830735235619636112619927867287431575647321</span>
q <span class="token operator">=</span> <span class="token number">177482332140024816122816575300851746457741976238942019223639223243373845838446387378093437677008231609976122718397287922224412805145965728166071230572137942154170172214953182121671014605624049869925600226560127948579957435119412752482229481128742488177414523194528098131635883615390771259266866469500527361157</span>
phin <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
e <span class="token operator">=</span> <span class="token number">0o200001</span>
<span class="token keyword">assert</span> gmpy2<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phin<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span>
d <span class="token operator">=</span> inverse<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phin<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>cipher<span class="token punctuation">,</span> d<span class="token punctuation">,</span> p <span class="token operator">*</span> q<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>解得的还是一个密文：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">emkkocy<span class="token punctuation">&#123;</span>lnyu_wp_kxs_kc_ahz_dvjg_by?<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>前面几个字符是“ctfshow”，把对应字符的序号写在下面：</p>
<p>明文：</p>
<pre class="line-numbers language-none"><code class="language-none">2  19  5  18  7  14  22<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>密文：</p>
<pre class="line-numbers language-none"><code class="language-none">4  12  10 10  14  2  24<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>有的密文的字符序号比明文的字符序号小，说明经过了模运算，发现前六个字符正好是自己加上自己的序号模26，而第七个字符是加2后模26，与第一个字符加上的数字相同，猜测密钥是以6循环的密钥。脚本如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">dic <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'0'</span><span class="token punctuation">:</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'1'</span><span class="token punctuation">:</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'2'</span><span class="token punctuation">:</span><span class="token string">'c'</span><span class="token punctuation">,</span><span class="token string">'3'</span><span class="token punctuation">:</span><span class="token string">'d'</span><span class="token punctuation">,</span><span class="token string">'4'</span><span class="token punctuation">:</span><span class="token string">'e'</span><span class="token punctuation">,</span><span class="token string">'5'</span><span class="token punctuation">:</span><span class="token string">'f'</span><span class="token punctuation">,</span>
       <span class="token string">'6'</span><span class="token punctuation">:</span><span class="token string">'g'</span><span class="token punctuation">,</span><span class="token string">'7'</span><span class="token punctuation">:</span><span class="token string">'h'</span><span class="token punctuation">,</span><span class="token string">'8'</span><span class="token punctuation">:</span><span class="token string">'i'</span><span class="token punctuation">,</span><span class="token string">'9'</span><span class="token punctuation">:</span><span class="token string">'j'</span><span class="token punctuation">,</span><span class="token string">'10'</span><span class="token punctuation">:</span><span class="token string">'k'</span><span class="token punctuation">,</span><span class="token string">'11'</span><span class="token punctuation">:</span><span class="token string">'l'</span><span class="token punctuation">,</span>
       <span class="token string">'12'</span><span class="token punctuation">:</span><span class="token string">'m'</span><span class="token punctuation">,</span><span class="token string">'13'</span><span class="token punctuation">:</span><span class="token string">'n'</span><span class="token punctuation">,</span><span class="token string">'14'</span><span class="token punctuation">:</span><span class="token string">'o'</span><span class="token punctuation">,</span><span class="token string">'15'</span><span class="token punctuation">:</span><span class="token string">'p'</span><span class="token punctuation">,</span><span class="token string">'16'</span><span class="token punctuation">:</span><span class="token string">'q'</span><span class="token punctuation">,</span><span class="token string">'17'</span><span class="token punctuation">:</span><span class="token string">'r'</span><span class="token punctuation">,</span>
       <span class="token string">'18'</span><span class="token punctuation">:</span><span class="token string">'s'</span><span class="token punctuation">,</span><span class="token string">'19'</span><span class="token punctuation">:</span><span class="token string">'t'</span><span class="token punctuation">,</span><span class="token string">'20'</span><span class="token punctuation">:</span><span class="token string">'u'</span><span class="token punctuation">,</span><span class="token string">'21'</span><span class="token punctuation">:</span><span class="token string">'v'</span><span class="token punctuation">,</span><span class="token string">'22'</span><span class="token punctuation">:</span><span class="token string">'w'</span><span class="token punctuation">,</span><span class="token string">'23'</span><span class="token punctuation">:</span><span class="token string">'x'</span><span class="token punctuation">,</span>
       <span class="token string">'24'</span><span class="token punctuation">:</span><span class="token string">'y'</span><span class="token punctuation">,</span><span class="token string">'25'</span><span class="token punctuation">:</span><span class="token string">'z'</span><span class="token punctuation">&#125;</span>

redic <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> t<span class="token punctuation">:</span><span class="token punctuation">(</span>t<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dic<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
cipher <span class="token operator">=</span> <span class="token string">"emkkocylnyuwpkxskcahzdvjgby"</span>
key <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">]</span>
flag <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    flag <span class="token operator">+=</span> dic<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>redic<span class="token punctuation">[</span>cipher<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token builtin">int</span><span class="token punctuation">(</span>key<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span> <span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
<span class="token comment">#ctfshow&#123;sign_in_rsa_do_you_love_it?&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>

      </div>
      <div class="post-tags-categories">
        
        <div class="tags">
          
            <a href="/tags/%E5%8D%9A%E5%AE%A2/" class="">
              博客
            </a>
          
        </div>
        
      </div>
      
        <div class="copyright">
  <ul class="post-copyright">
    <li class="post-copyright-author">
    <strong>author:  </strong>sinanya</a>
    </li>
    <li class="post-copyright-link">
    <strong>link:  </strong>
    <a href="/2021/09/15/CTFSHOW-unusualrsa/" target="_blank" title="CTFSHOW-unusualrsa">https://sinanya.github.io/2021/09/15/CTFSHOW-unusualrsa/</a>
    </li>
    <li class="post-copyright-license">
      <strong>Copyright notice:   </strong>
      All articles on this website, unless otherwise stated, adopt <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">CC BY-NC-ND 4.0</a>
      reprint policy. If reproduced, please indicate source!
    </li>
  </ul>
<div>
      
    </article>
    <!-- 上一篇文章和下一篇文章 -->
    
      <!-- 文章详情页的上一页和下一页 -->
<div class="post-nav">



  
  <div class="post-nav-prev post-nav-item">
    <div class="post-nav-img lazyload" data-original="/medias/1.jpg" style="background-size: cover; 
      background-position: center center;">
    </div>
    <a href="/2021/09/22/%E4%BC%BD%E7%BD%97%E5%8D%8E%E5%9F%9F/" class="post-nav-link">
      <div class="title">
        <i class="fa fa-angle-left"></i> Prev:
        <div class="title-text">伽罗华域</div>
      </div>
      
      <!-- <div class="content">
        GF(2 ^ 3)今天看到《密码编码学与网络安全》一书中的有限域，特别不理解在GF(2 ^ 3)上的乘法运算，索性就上网
      </div> -->
    </a>
  </div>



  
  <div class="post-nav-next post-nav-item">
    <div class="post-nav-img lazyload" data-original="/medias/11.jpg" style="background-size: cover; 
      background-position: center center;">
    </div>
    <a href="/2021/09/14/%E4%BC%A0%E7%BB%9F%E5%8A%A0%E5%AF%86%E6%8A%80%E6%9C%AF/" class="post-nav-link">
      <div class="title">
        Next: <i class="fa fa-angle-right"></i>
        <div class="title-text">传统加密技术</div>
      </div>
      <!-- <div class="content">
        传统密码学密码分析学和穷举攻击攻击传统的密码体制有两种通用的方法：
密码分析学：密码分析学攻击依赖于算法的性质、明文的一
      </div> -->
    </a>
  </div>

</div>

    
    

    <!-- 打赏 -->
    

    <!-- 分享 -->
    
      <!-- https://github.com/overtrue/share.js -->
<!-- 文章详情页的分享 -->
<div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>

<script src="/js/shareJs/social-share.min.js"></script>
</script>

<style>
  .social-share {
    margin: 20px 0;
  }
</style>


    
    
    <!-- 评论 -->
    <!-- 评论 -->

  <div id="myComment">
    
      
<section id="comments" style="padding: 1em; margin: 15px auto;"
	class="animated bounceInUp">
	<div id="vcomment" class="comment"></div>
</section>
<style>
	#comments {
		background: rgba(255,255,255,0.9);
	}
	#veditor {
		background-image: url('https://img.zcool.cn/community/01a253594c71cfa8012193a329a77f.gif');
		background-size: contain;
		background-repeat: no-repeat;
		background-position: right;
		background-color: rgba(255, 255, 255, 0);
		resize: vertical;
	}
	#veditor:focus{
		background-position-y: 200px;
		transition: all 0.2s ease-in-out 0s;
	}
	#vcomment .vcards .vcard .vh .vhead .vtag.vvisitor {
		background-color: #42b983;
	}
	.v[data-class=v] .vbtn:active, .v[data-class=v] .vbtn:hover {
		color: #42b983;
		border-color: #42b983;
	}
	#vcomment .vcards .vcard .vhead .vsys i {
		display: none;
	}
	/* 底部valine链接 */
	#vcomment .vpower {
		display: none;
	}
	
	/* 底下注释是修改 名称和邮箱和网址输入框的样式 */
	/* #vcomment .vheader {
		display: flex;
		justify-content: space-around;
	}
	
	#vcomment .vheader .vnick {
		width: 31%;
		border: 2px solid #dedede;
		padding-left: 10px;
		padding-right: 10px;
		border-radius: 5px
	}

	#vcomment .vheader .vmail {
		width: 31%;
		border: 2px solid #dedede;
		padding-left: 10px;
		padding-right: 10px;
		border-radius: 5px
	}

	#vcomment .vheader .vlink {
		width: 31%;
		border: 2px solid #dedede;
		padding-left: 10px;
		padding-right: 10px;
		border-radius: 5px
	} */

	img.vimg {
		transition: all 1s;
		/* 头像旋转时间为 1s */
	}

	img.vimg:hover {
		transform: rotate(360deg);
		-webkit-transform: rotate(360deg);
		-moz-transform: rotate(360deg);
		-o-transform: rotate(360deg);
		-ms-transform: rotate(360deg);
	}

	#vcomment .vcards .vcard {
		padding: 15px 20px 0 20px;
		border-radius: 10px;
		margin-bottom: 15px;
		box-shadow: 0 0 4px 1px rgba(0, 0, 0, .12);
		transition: all .3s
	}

	#vcomment .vcards .vcard:hover {
		box-shadow: 0 0 8px 3px rgba(0, 0, 0, .12)
	}

	#vcomment .vcards .vcard .vh .vcard {
		border: none;
		box-shadow: none;
	}
</style>
    
  </div>


  </div>

  <!-- 目录 -->
  <!-- 文章详情页右侧目录 -->

  <div class="toc-aside">
    <div class="toc-main">
      <div class="toc-aside-title">
        <i class="fa fa-list-ul" aria-hidden="true"></i><span>catalog</span>
        
          <div class="toc-open-close">catalog</div>
        
      </div>
      <div class="toc-content">
        <div class="toc"></div>
      </div>
    </div>
  </div>
  <!-- js在scripts目录下的的toc.ejs里面 -->
  

  <script>
    function openBtnClickFn () {
      let openOrCloseBtn = $('.toc-aside .toc-aside-title .toc-open-close');
      let open = eval('' || 'true');
      openOrCloseBtn.click(function() {
        if (open === true) {
          $(".toc-aside").css({'width': 0, 'padding': 0});
          $(".toc-content").css({'width': 0});
          $(".toc-aside-title span, .toc-aside-title i").css({'display': 'none'});
          $(".main-content").css({'width': '75%', 'margin': '10px auto'});
          open = false;
        } else {
          $(".toc-aside").css({'width': '300px', 'padding': '0 10px'});
          $(".toc-content").css({'width': '300px'});
          $(".toc-aside-title span, .toc-aside-title i").css({'display': 'inline-block'});
          $(".main-content").css({'width': '65%', 'margin-right': '10px', 'margin-left': 'calc(35% - 350px)'});
          open = true;
        }
      });
    };
    openBtnClickFn();
    document.addEventListener('pjax:complete', function () {
      openBtnClickFn();
    })
  </script>


  

  <!-- 图片放大 Wrap images with fancybox support -->
  <script src="/js/wrapImage.js"></script>
</div>

<!-- 文章详情页背景图 -->
<div id="appBgSwiper" style="position: fixed;left: 0;top: 0;width: 100%;height: 100%;z-index: -2;" :style="{'background-color': bgColor ? bgColor : 'transparent'}">
    <transition-group tag="ul" :name="names">
        <li v-for='(image,index) in img' :key='index' v-show="index === mark" class="bg-swiper-box">
            <img :src="image" class="bg-swiper-img">
        </li>
    </transition-group>
</div>
<script>
    var vm = new Vue({
        el: '#appBgSwiper',
        data: {
            names: '' || 'fade' || 'fade', // translate-fade fade
            mark: 0,
            img: [],
            bgColor: '',
            time: null
        },
        methods: {   //添加方法
            change(i, m) {
                if (i > m) {
                    // this.names = 'fade';
                } else if (i < m) {
                    // this.names = 'fade';
                } else {
                    return;
                }
                this.mark = i;
            },
            prev() {
                // this.names = 'fade';
                this.mark--;
                if (this.mark === -1) {
                    this.mark = 3;
                    return
                }
            },
            next() {
                // this.names = 'fade';
                this.mark++;
                if (this.mark === this.img.length) {
                    this.mark = 0;
                    return
                }
            },
            autoPlay() {
                // this.names = 'fade';
                this.mark++;
                if (this.mark === this.img.length) {
                    this.mark = 0;
                    return
                }
            },
            play() {
                let bgImgDelay = '' || '180000'
                let delay = parseInt(bgImgDelay) || 180000;
                this.time = setInterval(this.autoPlay, delay);
            },
            enter() {
                clearInterval(this.time);
            },
            leave() {
                this.play();
            }
        },
        created() {
            this.play()
        },
        beforeDestroy() {
            clearInterval(this.time);
        },
        mounted() {
            let prop = ''|| '';
            let isImg = prop.includes('.bmp') || prop.includes('.jpg') || prop.includes('.png') || prop.includes('.tif') || prop.includes('.gif') || prop.includes('.pcx') || prop.includes('.tga') || prop.includes('.exif') || prop.includes('.fpx') || prop.includes('.psd') || prop.includes('.cdr') || prop.includes('.pcd') || prop.includes('.dxf') || prop.includes('.ufo') || prop.includes('.eps') || prop.includes('.ai') || prop.includes('.raw') || prop.includes('.WMF') || prop.includes('.webp') || prop.includes('.jpeg') || prop.includes('http://') || prop.includes('https://') 
            if (isImg) {
                let img = prop.split(',');
                let configRoot = '/'
                let arrImg = [];
                img.forEach(el => {
                    var Expression=/http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- .\/?%&=]*)?/;
			        var objExp = new RegExp(Expression);

                    if(objExp.test(el)) {
                        // http or https
                        arrImg.push(el);
                    } else {
                        // 非http or https开头
                        // 本地文件
                        let firstStr = el.charAt(0);
                        if (firstStr == '/') {
                            el = el.substr(1); // 删除第一个字符 '/',因为 configRoot最后一个字符为 /
                        }
                        el = configRoot + el;
                        arrImg.push(el);
                    }
                })
                this.img = arrImg;
            } else {
                this.bgColor = prop;
            }
        }
    })
</script>

<style>
    .bg-swiper-box {
        position: absolute;
        display: block;
        width: 100%;
        height: 100%;
    }
    .bg-swiper-img {
        object-fit: cover;
        width: 100%;
        height: 100%;
    }
</style>

    </main>

    <!-- 页脚 -->
    <div class="footer bg-color">
  <div class="footer-main">
    <div class="link">
      
    </div>
    <div class="footer-copyright">
      <p>Copyright © 2019 - 2020 <a target="_blank" rel="noopener" href="https://github.com/yuang01">yuang01</a> | Powered by <a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/docs/">Hexo</a> | Theme <a target="_blank" rel="noopener" href="https://github.com/yuang01/theme">Bamboo</a> </p>

    </div>
    <div class="footer-custom">
      
    </div>
    <!-- 不蒜子统计 -->
    
      
  <!-- 不蒜子统计 -->
  <span id="busuanzi_container_site_pv">
        <i class="fa fa-eye" aria-hidden="true"></i>Total visits：<span id="busuanzi_value_site_pv"></span> times
  </span>
  <span class="post-meta-divider">|</span>
  <span id="busuanzi_container_site_uv" style='display:none'>
        <i class="fa fa-users" aria-hidden="true"></i>Number of visitors：<span id="busuanzi_value_site_uv"></span> people
  </span>
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" data-pjax></script>

    
  </div>
</div>


    <!-- 渲染暗黑按钮 -->
    
      <div class="dark">
  <div class="dark-content">
    <i class="fa fa-moon-o" aria-hidden="true"></i>
    <!-- <span>关灯</span> -->
  </div>
  
</div>

<script>
  $(function() {
    let isDark = JSON.parse(localStorage.getItem('dark'))  || JSON.parse('false');
    if (isDark) {
      $(".dark-content").replaceWith(
          `
          <div class='dark-content'>
            <i class="fa fa-lightbulb-o" aria-hidden="true"></i>
          </div>
          `
        );
    }
    $('.dark').click(function() {
      if ($(document.body).is('.darkModel')) {
        $(document.body).removeClass('darkModel');
        localStorage.setItem('dark', false);
        $(".dark-content").replaceWith(
          `
          <div class='dark-content'>
            <i class="fa fa-moon-o" aria-hidden="true"></i>
          </div>
          `
        );
      } else {
        $(document.body).addClass('darkModel');
        localStorage.setItem('dark', true);
        $(".dark-content").replaceWith(
          `
          <div class='dark-content'>
            <i class="fa fa-lightbulb-o" aria-hidden="true"></i>
          </div>
          `
        );
      }
    })
  })
</script>
    
    <!-- 渲染回到顶部按钮 -->
    
      <div class="goTop top-btn-color" pointer>
  <i class="fa fa-arrow-up" aria-hidden="true"></i>
</div>
<script src="/js/goTop.js"></script>
    
    <!-- 渲染左下角音乐播放器 -->
    

    <!-- 图片放大 -->
    
      <script src="/js/fancybox/jquery.fancybox.min.js"></script>
    

    <!-- 百度解析 -->
    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <!-- 背景彩带 -->
    
    
    <script src="/js/app.js" data-pjax></script>
    
    <!-- 文章目录所需js -->
<link href="/js/tocbot/tocbot.css" rel="stylesheet">
<script src="/js/tocbot/tocbot.min.js"></script>

<script>
  var headerEl = 'h2, h3, h4',  //headers 
      content = '.post-detail',//文章容器
      idArr = {};  //标题数组以确定是否增加索引id
      //add #id
  var option = {
    // Where to render the table of contents.
    tocSelector: '.toc',
    // Where to grab the headings to build the table of contents.
    contentSelector: content,
    // Which headings to grab inside of the contentSelector element.
    headingSelector: headerEl,
    scrollSmooth: true,
    scrollSmoothOffset: -80,
    headingsOffset: -($(window).height() * 0.4 - 45),
    positionFixedSelector: '.toc-main',
    positionFixedClass: 'is-position-fixed',
    fixedSidebarOffset: 'auto',
  }
  if ($('.toc').length > 0) {

    $(content).children(headerEl).each(function () {
      //去除空格以及多余标点
      var headerId = $(this).text().replace(/[\s|\~|`|\!|\@|\#|\$|\%|\^|\&|\*|\(|\)|\_|\+|\=|\||\|\[|\]|\{|\}|\;|\:|\"|\'|\,|\<|\.|\>|\/|\?|\：|\，|\。]/g, '');

      headerId = headerId.toLowerCase();
      if (idArr[headerId]) {
        //id已经存在
        $(this).attr('id', headerId + '-' + idArr[headerId]);
        idArr[headerId]++;
      }
      else {
        //id未存在
        idArr[headerId] = 1;
        $(this).attr('id', headerId);
      }
    });

    tocbot.init(option);
    
  }


  document.addEventListener('pjax:send', function () {
    if ($('.toc').length) {
      tocbot.destroy();
    }
  });

  document.addEventListener('pjax:complete', function () {
    if ($('.toc').length) {
      tocbot.init(option);
    }
  });

  
</script>

<style>
.is-position-fixed {
  position:sticky !important;
  top: 74px;
}
.toc-main ul {
  counter-reset: show-list;
}
.toc-main ul li::before {
  content: counter(item)".";
  display: block;
  position: absolute;
  left: 12px;
  top:0;
}
/* .toc > .toc-list {
  padding-left: 35px;
}
.toc>.toc-list li {
  list-style: decimal;
}
.toc-list {
  padding-left: 25px;
} */
</style> 

<!-- 渲染issues标签里的内容 -->
<script>
  function loadIssuesJS() {
    if ($(".post-detail").find(".issues-api").length == 0) {
      return;
    } 
    loadScript('/js/issues/index.js');
  };
  $(function () {
    loadIssuesJS();
  });
  document.addEventListener('pjax:complete', function () {
    if (typeof IssuesAPI == "undefined") {
      loadIssuesJS();
    }
  })
</script>

<!-- div滚动到显示区域的动画 -->

  <script src="/js/aos/aos.js"></script>
  <script>
    // https://github.com/michalsnik/aos
    var themeOffset = parseInt('120') || 120;
    var themeDelay = parseInt('0') || 0;
    var themeDuration = parseInt('400') || 400;
    var themeEasing = 'ease' || 'ease';
    var themeOnce = eval('true') || false;
    var themeMirror = eval('false') || false;
    var themeAnchorPlacement = 'top-bottom' || 'top-bottom';
    AOS.init({
      // Global settings:
      disable: false, // accepts following values: 'phone', 'tablet', 'mobile', boolean, expression or function
      startEvent: 'DOMContentLoaded', // name of the event dispatched on the document, that AOS should initialize on
      initClassName: 'aos-init', // class applied after initialization
      animatedClassName: 'aos-animate', // class applied on animation
      useClassNames: false, // if true, will add content of `data-aos` as classes on scroll
      disableMutationObserver: false, // disables automatic mutations' detections (advanced)
      debounceDelay: 50, // the delay on debounce used while resizing window (advanced)
      throttleDelay: 99, // the delay on throttle used while scrolling the page (advanced)

      // Settings that can be overridden on per-element basis, by `data-aos-*` attributes:
      offset: themeOffset, // offset (in px) from the original trigger point
      delay: themeDelay, // values from 0 to 3000, with step 50ms
      duration: themeDuration, // values from 0 to 3000, with step 50ms
      easing: themeEasing, // default easing for AOS animations
      once: themeOnce, // whether animation should happen only once - while scrolling down
      mirror: themeMirror, // whether elements should animate out while scrolling past them
      anchorPlacement: themeAnchorPlacement, // defines which position of the element regarding to window should trigger the animation

    });

    document.addEventListener('pjax:complete', function () {
      AOS.refresh();
    })
  </script>


<!-- 输入框打字特效 -->
<!-- 输入框打字特效 -->

  <script src="/js/activate-power-mode.js"></script>
  <script>
    POWERMODE.colorful = true;  // 打开随机颜色特效
    POWERMODE.shake = false;    // 关闭输入框抖动
    document.body.addEventListener('input', POWERMODE);//监听打字事件
  </script>


<!-- markdown代码一键复制功能 -->

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/v-plugs-ayu/lib/ayu.css">
  <script src="https://cdn.jsdelivr.net/npm/v-plugs-ayu/lib/ayu.umd.min.js"></script>
  <script src="/js/clipboard/clipboard.min.js"></script>
  <div id="appCopy">
  </div>
  <script data-pjax>
    var vm = new Vue({
      el: '#appCopy',
      data: {
      },
      computed: {
      },
      mounted() {
        const that = this;
        var copy = 'copy';
        /* code */
        var initCopyCode = function () {
          var copyHtml = '';
          copyHtml += '<button class="btn-copy" data-clipboard-snippet="" style="position:absolute;top:0;right:0;z-index:1;">';
          copyHtml += '<i class="fa fa-copy"></i><span>' + copy + '</span>';
          copyHtml += '</button>';
          $(".post-detail pre").not('.gutter pre').wrap("<div class='codeBox' style='position:relative;width:100%;'></div>")
          $(".post-detail pre").not('.gutter pre').before(copyHtml);
          new ClipboardJS('.btn-copy', {
            target: function (trigger) {
              return trigger.nextElementSibling;
            }
          });
        }
        initCopyCode();
        $('.btn-copy').unbind('click').bind('click', function () {
          doSomething();
        })
        $(document).unbind('keypress').bind('keypress', function (e) {
          if (e.ctrlKey && e.keyCode == 67) {
            doSomething();
            // 返回false, 防止重复触发copy事件  
            // return false;
          }
        })
        //  监听 ctrl + c事件  
        // $(document).unbind('keypress').bind('keypress', function (e) {
        //   if (e.ctrlKey && e.keyCode == 67) {
        //     doSomething();
        //     // 返回false, 防止重复触发copy事件  
        //     return false;
        //   }
        // })

        // // 鼠标右键的复制事件  
        // $(document).unbind('copy').bind('copy', function (e) {
        //   doSomething();
        // });

        function doSomething() {
          that.$notify({
            title: "成功",
            content: "代码已复制，请遵守相关授权协议。",
            type: 'success'
          })
        }
      },
      methods: {
      },
      created() { }
    })
  </script>


<!-- 图片懒加载 -->
<script src="/js/lazyload/lazyload@1.9.1.js"></script>
<script data-pjax>
  $(function () {
    $("div.lazyload, img.lazyload, a.lazyload").lazyload(
      {
        effect: "show",
        placeholder: "https://img10.360buyimg.com/ddimg/jfs/t1/159345/8/2271/222193/5ff7b36fEe49f5663/a95287c20385127f.gif"    //图片未加载出来时显示的占位图
      }
    );
  });
</script>

<!-- 评论所需js -->

    
        <!-- 弹幕所需的css和js -->
        
<!-- 具体js，请前往valine/script.ejs查看 -->

        <script>
  var requiredFields = '';
  requiredFields = requiredFields.split(',');
  comment_el = '.comment';
  let looperValine = null;
  load_valine = function () {
    if ($(comment_el).length) {
      var valine = new Valine({
        el: '#vcomment',
        path: window.location.pathname,
        notify: false,
        verify: false,
        app_id: "",
        app_key: "",
        placeholder: "客官，说点什么吧",
        avatar: "",
        master: "",   //博主邮箱md5
        tagMeta: ["博主","小伙伴","访客"],     //标识字段名
        friends: "",
        metaPlaceholder: { "nick": "昵称/QQ号", "mail": "邮箱" },
        requiredFields: requiredFields,
        enableQQ: true,
      });
      function debounce(fn) {
        var timerID = null
        return function () {
          var arg = arguments[0]   //获取事件
          if (timerID) {
            clearTimeout(timerID)
          }
          timerID = setTimeout(function () {
            fn(arg)              //事件传入函数
          }, 200)
        }
      }
      //查询评论 valine.Q('*').limit(7) -- 查询所有，限制7条, 下面的的代码是查询当前页面
      var themeDanmu = eval('false');
      var themeLoop = eval('false');
      var themeLooperTime = '5000' || 5000;
      var speed = '40' || 20;
      var isBarrager = true;
      if (themeDanmu == true) {
        do_barrager();
        if ($('.danmuBox').length <= 0) {
          $('.navbar').append('<div class="danmuBox"><div class="danmuBtn open"><span class="danmuCircle"></span><span class="danmuText">弹幕</span></div></div>');
        }
        $('.danmuBtn').on('click', debounce(
          function () {
            if ($('.danmuBtn').hasClass('open')) {
              $('.danmuBtn').removeClass('open')
              clearInterval(looperValine);
              $.fn.barrager.removeAll();
            } else {
              $('.danmuBtn').addClass("open");
              do_barrager();
            }
          }
        ))
      }
      function do_barrager() {
        isBarrager && valine.Q(window.location.pathname).find().then(function (comments) {
          // var num = 0; // 可以记录条数，循环调用的时候只取最新的评论放入弹幕中
          var run_once = true;
          var looper_time = themeLooperTime;
          var total = comments.length;
          // var looper = null;
          var index = 0;
          if (total > 0) {
            barrager();
          } else {
            // 当评论数为0的时候，自动关闭弹幕
            // $('.danmuBtn').removeClass('open');
          }
          function barrager() {
            if (run_once) {
              //如果是首次执行,则设置一个定时器,并且把首次执行置为false
              looperValine = setInterval(barrager, looper_time);
              run_once = false;
            }
            var content = comments[index]._serverData.comment;
            var email = comments[index]._serverData.mail;
            var link = comments[index]._serverData.link;
            var newcontent = content.substring(0, 50).replace(/<[^>]+>/g, "");
            //发布一个弹幕
            const item = {
              img: `https://q1.qlogo.cn/g?b=qq&nk=${email}&s=640`, //图片 
              info: newcontent, //文字 
              href: link, //链接 
              close: true, //显示关闭按钮 
              speed: speed, //延迟,单位秒,默认6 
              color: '#fff', //颜色,默认白色 
              old_ie_color: '#000000', //ie低版兼容色,不能与网页背景相同,默认黑色
            }
            $('body').barrager(item);
            //索引自增
            index++;
            //所有弹幕发布完毕，清除计时器。
            if (index == total) {
              clearInterval(looperValine);
              if (themeLoop === true) {
                setTimeout(function () {
                  do_barrager();
                }, 5000);
              } else {
                $('.danmuBtn').removeClass('open');
              }
              return false;
            }

          }
        })
      }
    }
  };
  $(document).ready(load_valine);
  document.addEventListener('pjax:send', function (e) {
    
  })
  document.addEventListener('pjax:complete', function () {
    load_valine();
  });
</script>
    


<!-- 鼠标点击特效 -->
<!-- 爱心点击 -->




    <!-- pjax -->
    

<!-- pjax -->


  <script src="/js/pjax@0.2.8/index.js"></script>
  
    <!-- 样式位于：source/css/_third-party/pjaxanimate.styl -->

<div class="pjax-animate">
  
    <div class="loading-circle"><div id="loader-circle"></div></div>
    <script>
      window.ShowLoading = function() {
        $(".loading-circle").css("display", "block");
      };
      window.HideLoading = function() {
        $(".loading-circle").css("display", "none");
      }
    </script>
  
	<script>
    document.addEventListener('pjax:complete', function () {
      window.HideLoading();
    })
    document.addEventListener('pjax:send', function () {
      window.ShowLoading();
    })
    document.addEventListener('pjax:error', function () {
      window.HideLoading();
    })
	</script>
</div>

  

  <script>
    var pjax = new Pjax({
      elements: 'a[href]:not([href^="#"]):not([href="javascript:void(0)"])',   // 拦截正常带链接的 a 标签
      selectors: ["#pjax-container","title"],                                   // 根据实际需要确认重载区域
      cacheBust: false,   // url 地址追加时间戳，用以避免浏览器缓存
      timeout: 5000
    });

    document.addEventListener('pjax:send', function (e) {

      try {
        var currentUrl = window.location.pathname;
        var targetUrl = e.triggerElement.href;
        var banUrl = [""];
        if (banUrl[0] != "") {
          banUrl.forEach(item => {
            if(currentUrl.indexOf(item) != -1 || targetUrl.indexOf(item) != -1) {
              window.location.href = targetUrl;
            }
          });
        }
      } catch (error) {}

      $(window).unbind('resize');
      $(window).unbind('scroll');
      $(document).unbind('scroll');
      $(document).unbind('click');
      $('body').unbind('click');

    })
    
    document.addEventListener('pjax:complete', function () {
      $('script[data-pjax], .pjax-reload script').each(function () {
        $(this).parent().append($(this).remove());
      });
    });

    document.addEventListener('pjax:error', function (e) {
      window.location.href = e.triggerElement.href;
    })
  </script>



  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
</body>
</html>