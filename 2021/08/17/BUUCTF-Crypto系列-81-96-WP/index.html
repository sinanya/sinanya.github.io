<!DOCTYPE html>
<html>
  <!-- meta/link... -->
  



<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <!-- Global site tag (gtag.js) - Google Analytics -->


  <title>BUUCTF-Crypto系列[81-96]WP | 司南的博客</title>

  
    
<link rel="stylesheet" href="/js/aos/aos.css">

  

  <link rel="icon" type="image/x-icon, image/vnd.microsoft.icon" href="/favicon.ico">
  <link rel="stylesheet" href="https://at.alicdn.com/t/font_1911880_c1nvbyezg17.css">
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">

  
  
<link rel="stylesheet" href="/css/animate.min.css">

  
<link rel="stylesheet" href="/css/style.css">

  
  
    
<link rel="stylesheet" href="/js/fancybox/jquery.fancybox.min.css">

  
  
    
<link rel="stylesheet" href="/js/shareJs/share.min.css">

  
  <style>
        @media (max-width: 992px) {
            #waifu {
                display: none;
            }
        }
    </style>
    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">

    
        <script src="/js/valine/av-min@3.0.4.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/HCLonely/Valine@latest/dist/Valine.min.js"></script>
    
<meta name="generator" content="Hexo 5.4.0"></head>

  
  <!-- 依赖于jquery和vue -->
  <script src="/js/jquery3.5.1.js"></script>
  <script src="/js/vue2.6.11.js"></script>
  
  <body>
    <!-- 预加载动画 -->
    <!-- 页面预加载动画 -->

<div id='loader'>
  <link rel="stylesheet" href="/js/loaded/index.css" >
  <div class="loading-left-bg"></div>
  <div class="loading-right-bg"></div>
  <div class="spinner-box">
    <div class="configure-border-1">
      <div class="configure-core"></div>
    </div>
    <div class="configure-border-2">
      <div class="configure-core"></div>
    </div>
    <div class="loading-word">loading...</div>
  </div>
</div>

<script>
  var endLoading = function () {
    document.body.style.overflow = 'auto';
    document.getElementById('loader').classList.add("loading");
  }
  window.addEventListener('DOMContentLoaded',endLoading);
  
</script>

    
    <!-- 判断是否为暗黑风格 -->
    <!-- 判断是否为黑夜模式 -->
<script>
  let isDark = JSON.parse(localStorage.getItem('dark')) || JSON.parse('false');

  if (isDark) {
    $(document.body).addClass('darkModel');
  }
</script>

    <!-- 头部导航等 -->
    
<header class="header " id="navHeader"
  style="position: fixed;
  left: 0; top: 0; z-index: 10;width: 100%;"
>
  <div class="header-content">
    <div class="bars">
      <div id="appDrawer" class="sidebar-image">
  <div class="drawer-box-icon">
    <i class="fa fa-bars" aria-hidden="true" @click="showDialogDrawer"></i>
  </div>
  
  <transition name="fade">
    <div class="drawer-box_mask" v-cloak style="display: none;" v-show="visible" @click.self="cancelDialogDrawer">
    </div>
  </transition>
  <div class="drawer-box" :class="{'active': visible}">
    <div class="drawer-box-head bg-color">
      <img class="drawer-box-head_logo" src="/medias/logo.png" alt="logo">
      <h3 class="drawer-box-head_title">司南的博客</h3>
      <h5 class="drawer-box-head_desc"></h5>
    </div>
    
    <div class="drawer-box-content">
      <ul class="drawer-box-content_menu">
        
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/" class="drawer-menu-item-link">
                  
                    <i class="fa fa-home" aria-hidden="true"></i>
                  
                  <span class="name">Home</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/tags" class="drawer-menu-item-link">
                  
                    <i class="fa fa-tags" aria-hidden="true"></i>
                  
                  <span class="name">Tags</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/categories" class="drawer-menu-item-link">
                  
                    <i class="fa fa-bookmark" aria-hidden="true"></i>
                  
                  <span class="name">Categories</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/about" class="drawer-menu-item-link">
                  
                    <i class="fa fa-user" aria-hidden="true"></i>
                  
                  <span class="name">About</span>
                </a>
              
            </li>
          
        
        
          <li class="drawer-box-content_item">
            <a target="_blank" rel="noopener" href="https://github.com/yuang01/hexo-theme-bamboo">
              <i class="fa fa-github" aria-hidden="true"></i>
              <span>Github</span>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>

<script>
  var body = document.body || document.documentElement || window;
  var vm = new Vue({
    el: '#appDrawer',
    data: {
      visible: false,
      top: 0,
      openArr: [],
    },
    computed: {
    },
    mounted() {
    },
    methods: {
      isOpen(index) {
        if (this.openArr.includes(index)) {
          return true;
        } else {
          return false;
        }
      },
      openOrCloseMenu(curIndex) {
        const index = this.openArr.indexOf(curIndex);
        if (index !== -1) {
          this.openArr.splice(index, 1);
        } else {
          this.openArr.push(curIndex);
        }
      },
      showDialogDrawer() {
        this.visible = true;
        // 防止页面滚动，只能让弹框滚动
        this.top = $(document).scrollTop()
        body.style.cssText = 'width: 100%; height: 100%;overflow: hidden;';
      },
      cancelDialogDrawer() {
        this.visible = false;
        body.removeAttribute('style');
        $(document).scrollTop(this.top)
      }
    },
    created() {}
  })
</script>

    </div>
    <div class="blog-title" id="author-avatar">
      
        <div class="avatar">
          <img src="/medias/logo.png" alt="logo">
        </div>
      
      <a href="/" class="logo">司南的博客</a>
    </div>
    <nav class="navbar">
      <ul class="menu">
        
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/" class="menu-item-link" title="Home">
                  
                    <i class="fa fa-home" aria-hidden="true"></i>
                  
                  <span class="name">Home</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/tags" class="menu-item-link" title="Tags">
                  
                    <i class="fa fa-tags" aria-hidden="true"></i>
                  
                  <span class="name">Tags</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/categories" class="menu-item-link" title="Categories">
                  
                    <i class="fa fa-bookmark" aria-hidden="true"></i>
                  
                  <span class="name">Categories</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/about" class="menu-item-link" title="About">
                  
                    <i class="fa fa-user" aria-hidden="true"></i>
                  
                  <span class="name">About</span>
                </a>
              
            </li>
          
        
      </ul>
      
      
        <div id="appSearch">
  <div class="search"  @click="showDialog()"><i class="fa fa-search" aria-hidden="true"></i></div>
  <transition name="fade">
    <div class="message-box_wrapper" style="display: none;" v-cloak v-show="dialogVisible" @click.self="cancelDialogVisible()">
      <div class="message-box animated bounceInDown">
        <!-- <div class="close" style="overflow: hidden;">
          <i class="fa fa-close" aria-hidden="true" style="float:right;" @click.self="cancelDialogVisible()"></i>
        </div> -->
        <h2>
          <span>
            <i class="fa fa-search" aria-hidden="true"></i>
            <span class="title">Search</span>
          </span>
          <i class="fa fa-close close" pointer style="float:right;" aria-hidden="true" @click.self="cancelDialogVisible()"></i>
        </h2>
        <form class="site-search-form">
          <input type="text"
            placeholder="Please enter keywords"
            id="local-search-input" 
            @click="getSearchFile()"
            class="st-search-input"
            v-model="searchInput"
          />
        </form>
        <div class="result-wrapper">
          <div id="local-search-result" class="local-search-result-cls"></div>
        </div>
      </div>
    </div>
  </transition>
</div>
<script src="/js/local_search.js"></script>
<script>
  var body = document.body || document.documentElement || window;
  var vm = new Vue({
    el: '#appSearch',
    data: {
      dialogVisible: false,
      searchInput: '',
      top: 0,
    },
    computed: {
    },
    mounted() {
    },
    methods: {
      showDialog() {
        this.dialogVisible = true;
        // 防止页面滚动，只能让弹框滚动
        this.top = $(document).scrollTop()
        body.style.cssText = 'overflow: hidden;';
      },
      getSearchFile() {
        if (!this.searchInput) {
          getSearchFile("/search.xml");
        }
      },
      cancelDialogVisible() {
        this.dialogVisible = false;
        body.removeAttribute('style');
        $(document).scrollTop(this.top)
      },
    },
    created() {}
  })
</script>
<!-- 解决刷新页面闪烁问题，可以在元素上添加display: none, 或者用vue.extend方法，详情：https://blog.csdn.net/qq_31393401/article/details/81017912 -->
<!-- 下面是搜索基本写法 -->
<!-- <script type="text/javascript" id="local.search.active">
  var inputArea = document.querySelector("#local-search-input");
  inputArea.onclick   = function(){ getSearchFile(); this.onclick = null }
  inputArea.onkeydown = function(){ if(event.keyCode == 13) return false }
</script> -->

      

    </nav>
  </div>
  
    <a target="_blank" rel="noopener" href="https://github.com/yuang01/hexo-theme-bamboo" class="github-corner color-primary" aria-label="View source on GitHub"><svg width="60" height="60" viewBox="0 0 250 250" style="fill:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
  
  

    <!-- 当头部导航设置为背景透明的时候  -->
    
      <script src="/js/header/index.js" data-pjax></script>
    
</header>

    <!-- 需要在上面加载的js -->
    <script>
    function loadScript(src, cb) {
        setTimeout(function () {
            var HEAD = document.getElementsByTagName('head')[0] || document.documentElement;
            var script = document.createElement('script');
            script.setAttribute('type', 'text/javascript');
            if (cb) script.onload = cb;
            script.setAttribute('src', src);
            HEAD.appendChild(script);
        });
    }

    //https://github.com/filamentgroup/loadCSS
    var loadCSS = function (href, before, media, attributes) {
        var doc = window.document;
        var ss = doc.createElement("link");
        var ref;
        if (before) {
            ref = before;
        }
        else {
            var refs = (doc.body || doc.getElementsByTagName("head")[0]).childNodes;
            ref = refs[refs.length - 1];
        }
        var sheets = doc.styleSheets;
        if (attributes) {
            for (var attributeName in attributes) {
                if (attributes.hasOwnProperty(attributeName)) {
                    ss.setAttribute(attributeName, attributes[attributeName]);
                }
            }
        }
        ss.rel = "stylesheet";
        ss.href = href;
        ss.media = "only x";
        function ready(cb) {
            if (doc.body) {
                return cb();
            }
            setTimeout(function () {
                ready(cb);
            });
        }
        ready(function () {
            ref.parentNode.insertBefore(ss, (before ? ref : ref.nextSibling));
        });
        var onloadcssdefined = function (cb) {
            var resolvedHref = ss.href;
            var i = sheets.length;
            while (i--) {
                if (sheets[i].href === resolvedHref) {
                    return cb();
                }
            }
            setTimeout(function () {
                onloadcssdefined(cb);
            });
        };
        function loadCB() {
            if (ss.addEventListener) {
                ss.removeEventListener("load", loadCB);
            }
            ss.media = media || "all";
        }
        if (ss.addEventListener) {
            ss.addEventListener("load", loadCB);
        }
        ss.onloadcssdefined = onloadcssdefined;
        onloadcssdefined(loadCB);
        return ss;
    };
    
</script>
 

<!-- 轮播图所需要的js -->
<script src="/js/swiper/swiper.min.js"></script>
<script src="/js/swiper/vue-awesome-swiper.js"></script>
<script src="/js/swiper/swiper.animate1.0.3.min.js"></script>


  <script src="/js/vue-typed-js/index.js"></script>


<!-- 首页的公告滚动插件的js需要重新加载 -->
<script src="/js/vue-seamless-scroll/index.js"></script>

<!-- 打字机效果js -->
<script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11"></script>


    <!-- 内容区域 -->
    <main class="main" id="pjax-container" style="margin-top: 0;">
      
 <!-- prismjs 代码高亮 -->
 
    
    <link href="/js/prism/prism-line-numbers.css" rel="stylesheet">
    
        <link href="/js/prism/prism-okaidia.min.css" rel="stylesheet">
    

    <style>
        pre[class*="language-"] {
            overflow-y: hidden;
        }
        .line-numbers .line-numbers-rows {
            border: none;
        }
    </style>
  


<div class="bg-dark-floor" style="position: fixed;left: 0;top: 0;width: 100%;height: 100%;z-index: -1;"></div>

<!-- 文章详情页顶部图片和标题 -->




<div class="post-detail-header lazyload" id="thumbnail_canvas" data-original="/medias/13.jpg" style="background-repeat: no-repeat; background-size: cover; 
  background-position: center center;position: relative;">
  <div class="post-detail-header-mask"></div>
  <canvas id="header_canvas"style="position:absolute;bottom:0;pointer-events:none;"></canvas>
  
  <div class="post-detail-header_info-box">
    <div class="title-box">
      <span class="title">
        BUUCTF-Crypto系列[81-96]WP
      </span>
    </div>
    
    
      
        <span class="post-detail-header_date">
          <i class="fa fa-calendar"></i> Published in：2021-08-17 |
        </span>
      

      
        <span class="post-detail-header_categories">
          <i class="iconfont iconbookmark1"></i> category：
          
            <a href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/" class="post-detail-header_category">
              密码学
            </a>
          
            <a href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/BUUCTF/" class="post-detail-header_category">
              BUUCTF
            </a>
          
        </span>
      

      
    
  </div>
  
  
    <script src="/js/bubble/bubble.js"></script>
  
</div>



<div class="row justify-position">
  <div class="main-content">
    <article class="post post-detail">
      
      <div class="post-content">
        <h2 id="RSA-amp-what"><a href="#RSA-amp-what" class="headerlink" title="RSA &amp; what"></a>RSA &amp; what</h2><p>题目如下：</p>
<pre class="line-numbers language-none"><code class="language-none">HUB1:
785095419718268286866508214304816985447077293766819398728046411166917810820484759314291028976498223661229395009474063173705162627037610993539617751905443039278227583504604808251931083818909467613277587874545761074364427549966555519371913859875313577282243053150056274667798049694695703660313532933165449312949725581708965417273055582216295994587600975970124811496270080896977076946000102701030260990598181466447208054713391526313700681341093922240317428173599031624125155188216489476825606191521182034969120343287691181300399683515414809262700457525876691808180257730351707673660380698973884642306898810000633684878715402823143549139850732982897459698089649561190746850698130299458080255582312696873149210028240898137822888492559957665067936573356367589784593119016624072433872744537432005911668494455733330689385141214653091888017782049043434862620306783436169856564175929871100669913438980899219579329897753233450934770193915434791427728636586218049874617231705308003720066269312729135764175698611068808404054125581540114956463603240222497919384691718744014002554201602395969312999994159599536026359879060218056496345745457493919771337601177449899066579857630036350871090452649830775029695488575574985078428560054253180863725364147
1697

412629526163150748619328091306742267675740578011800062477174189782151273970783531227579758540364970485350157944321579108232221072397135934034064481497887079641131808838242743811511451355024436983050572020925065644355566434625618133203024215941534926113892937988520918939061441606915556516246057349589921494351383160036280826024605351878408056180907759973804117263002554923041750587548819746346813966673034182913325507826219961923932100526305289894965216608254252188398580139545189681875824089456195044984585824938384521905334289906422454152976834867304693292466676355760173232407753256256317546190171995276258924613533179898467683358934751999655196790168438343198229183747091108262988777659858609744709324571850262293294975336628234767258858873839342596887193772615000676401522431518310648303975593582965021189182246986957349253156736526071639973844039068996404290548474640668851856078201093335425412842295604919065487301340901573809617549185106072798799159726375235125260509158832996701927878713084753334549129580912412168594170659605421750204835970231909591063407612779337478065175988365401590396247576709343727196106058477166945670117868989025903023998142850338956985816131805349549059377047477131270847579095628384569645636821650
494644347943710545224678831941589086572700792465459558770782213550069709458568349686998660541810166872034041584767487150140111151788221460027897193248273461607411027815984883969396220626358625041781558277804930212654296704055890683796941327712758797770820006623289146990000114915293539639766846910274034245607746230740851938158390562286057002223177609606376329007676845450142537930798148258428701466415483232670659815791064681384406494388237742330786225557303988025468036820082959712050733095860546860468575857084616069132051094882919253745234762029759124776348047587755897123575123506976140900565238840752841856713613368250071926171873213897914794115466890719123299469964019450899291410760762179836946570945555295288184698184555018368687708432612286248476073758067175481771199066581572870175460016017100414479346437034291784837132240891321931601494414908927713208448927221095745802380014441841139882391378410438764884597938773868771896252329517440068673532468372840830510218585255432000690265226016573313570977945083879214961394087065558376158826938257664840570952233832852869328785568175434516247720356520242602299510374317488182738732700078879665745909603766482100138001417023680647717824323143388857817595766172152883484274718248
152942283599728307168144137370127212672611894072038732126041098102628831053000986759260271210671922070555948023688596575415822984026159010574404359474670428678518262175033880513984372909748992727828381694416776740981021730545374002974037896534944567124543272737618380646771071804878796585983783360553761828325817820260204820004421979881871027255562690952334900616675606524933557440263648233514757200263521499508373975003431306847453046714027687108396945719803444444954079308404947126216395526551292104722047878178373207886033071857277857997932255251315982837892164421298202073945919187779856785892717251746704537315003771369737854896595170485152591013676942418134278534037654467840633528916812275267230155352077736583130992587670941654695382287023971261529987384520843829695778029311786431227409189019205818351911572757145556993606643464336196802350204616056286497246016800105003143046120608673496196758720552776772796609670537056331996894322779267635281472481559819839042424017171718303214059720568484939239370144038161541354254182769979771948759413102933987773401644506930205164891773826513161783736386604783484446345744957119469799231796368324927570694496679453313927562345656690240414624431304646248599226046524702364131095964335
79717988936247951265489157583697956031893477858854186991051529161879478488281744062318600470906120960002282886511477294555606503083169449335174864424180701080203993329996226566203834693869525797695969610065991941396723959032680019082506816443041598300477625793433080664346470586416385854692124426348587211026568667694805849554780794033764714016521711467557284846737236374990121316809833819996821592832639024026411520407330206281265390130763948165694574512140518775603040182029818771866749548761938870605590174330887949847420877829240131490902432602005681085180807294176837646062568094875766945890382971790015490163385088144673549085079635083262975154206269679142412897438231719704933258660779310737302680265445437771977749959110744959368586293082016067927548564967400845992380076107522755566531760628823374519718763740378295585535591752887339222947397184116326706799921515431185636740825707782742373783475781052674257292910213843986132987466810027275052416774693363446184518901899202502828670309452622347532932678874990809930682575738653876289384151496807194146308614368821006660626870989784697045160231069428458961107751207771093777394616856305293335603892178327520756554333365975114235981173451368131680404850832773147333013716920
123111353650401158556639983459870663057297871992927053886971224773529636525110628183715748795987525113177540092814119928708272290370336537110381023134637759740716140969662183269370676630325583385284994943164692397459103195434968057377474610500216801375394703781249039351368816958227409657934091741509357152328382960684515093945552479461382281913961956745154260686029997827565075768703774895750561575155143606297116391666385705899138085693913246313778033627210312268959737394553510894720099165193981333775907531107232556909478156441457899797515694348816961762796703443502856101079430585547997496001098926600499728389113862894833789669213630332988693669889340482430613291490613803204484751470676686041002772556117213612152322606737150858116122936539131795111263513114569794532805886643087299918196635113037777138666914296986040549274559835214505300618256105508764026461518876579387159881983544667258537064954616097750399839661065797883103731694314852301848272092388637114950059216922969842082648527035538090054093890365647676119748995243416337805666557501345234056968476142608491830438065401219751688687373709390057521910942736632126729711606256158399963682990881473178216060827021373776598901281958527655543318413664277921492723185984
36869806815936046911848195817405817350259890871483063184373728397968909458432625046025376290214729914038387534731762237978339011724858818860181178811639468996206294711495853807311240013786226884265118119546377272154555615363105236192878292703331473547623021744317034819416624562896226194523639793573028006666236271812390759036235867495803255905843636447252225413871038762657801345647584493917576263471587347202664391908570140389126903204602391093990827188675090199750617303773574821926387194478875191828814971296674530519321530805302667925998711835019806761133078403281404889374663875077339168901297819436499920958268483684335998301056068380228873524800383911402490807139268964095165069610454677558808756444381542173782815227920906224931028457073652453777424387873533280455944646592996920617956675786286711447540353883400282402551158169958389450168079568459656526911857835375748015814860506707921852997096156275804955989964215077733621769938075413007804223217091604613132253046399456747595300404564172224333936405545921819654435437072133387523533568472443532200069133022979195685683508297337961701169394794966256415112246587706103819620428258245999539040721929317130088874161577093962579487428358736401687123174207198251449851429295

HUB2:
785095419718268286866508214304816985447077293766819398728046411166917810820484759314291028976498223661229395009474063173705162627037610993539617751905443039278227583504604808251931083818909467613277587874545761074364427549966555519371913859875313577282243053150056274667798049694695703660313532933165449312949725581708965417273055582216295994587600975970124811496270080896977076946000102701030260990598181466447208054713391526313700681341093922240317428173599031624125155188216489476825606191521182034969120343287691181300399683515414809262700457525876691808180257730351707673660380698973884642306898810000633684878715402823143549139850732982897459698089649561190746850698130299458080255582312696873149210028240898137822888492559957665067936573356367589784593119016624072433872744537432005911668494455733330689385141214653091888017782049043434862620306783436169856564175929871100669913438980899219579329897753233450934770193915434791427728636586218049874617231705308003720066269312729135764175698611068808404054125581540114956463603240222497919384691718744014002554201602395969312999994159599536026359879060218056496345745457493919771337601177449899066579857630036350871090452649830775029695488575574985078428560054253180863725364147
599

592169079372093727306100216011395857825646323934289480976073629037543922902098120901138454462177159996376654176248238979132528728327590301098966139983157980612320563496546128644967731000716697705104079039156276714872147463350811303393260622707024952543509891692246246277965823414460326811240048060543656588688604452353899779068825120910282167004715339763187734797180326976132213325054697165320479166356562518029805927741656605174809726397565772271562066078076105491745903986597877400370206718954975288721072048333678609055008135809089304229015364348490924974097403734627265297637171818849461766523691595241613878709865506436588268999163342945070495338153600520537498539457396582804692959296612715752573140296135784933206146091436617979599749774330699946637591406356289409716084034451049094715202196203486088368791744107629271647320273259836915312794297246589501008666299165717722507702866033454215783240025504356157664454861755286285777763585177751796252655008206383024707883077513745863312079349790275094080707502392866946325796914450602264462588722052297430827681750827349094323968337670311272933785838850649376115667223821665435911506351891489985627506615492005617098615432522564204152887767244129985681083657783356557756654335186
373940646416832740878733255707567753033716583448402000789202767511920210382830343955553654111486728333980557319799362514960627879016797491389812007768832730979916230647641872759001906846747977631675704310179448857128160385701185892914523053669366534408863734305635222625590986006420486092550427301086984563126480814987024980594613542978310129247678826691418335300577577527951623696426435497835228167084738007750914270251001921329521479047662848650808989996085600197309361410863238526802127877523767262921515150984998560136647154865791163316503073285223966216441025637452229043510097323724381056976302288136843260163922706692913035222445496716008888946581535004546355744211680390731257309941902587303353139951102244865270295414474488798335404630458489706639805186573874814586736746232358849677477533671968344154242963289415569487579895910660999043578737461300406937828924818002658292769882181668784501439254131996848948120781562158861495883827848139425862249576454689133681009549361314460818658995959098228995702202268649635363105549975932395335076521137604288520082040121286614922986554652700056148966514178935952363036963217619879899671383604638416567950421350546204434902113156720006282720889591288850271076074941927715678306057176
527630926460622936571385649841758214453416849039412401087443444317101857090904711485538107058823056085840539073345920792871368232355475394571098380596835468509997340505604333730547799560998822989747473780307779717715522787724471724766494090783971030594671013168209717686720448579582618378459567979027822271918653169622428153856198907810040224340270362413432495029672123261375400927159831537760709974778708160583252613784358234858583174544777979242887938827573604837766801998381379999076416444683891078093889686055482709838668356120916040352123019019255084513769603803814947774554028717814638951416291274696771515474086351482107953150253616922787262398450376249126999644026382478413080973933173079111305142716133389111399235545279259017424722601848670061556859163943895466553927946412523750166582734005733378328468250568944945912238495877929717101722314678120172228493787964904072583905721074766711732215815561012960394537195757832959268603775112932862105945720853959285187521763557915356428113876893276879775603217718981852114599706699524551973934242045743122744146361596971245034059345915315495232135483464496114770357536576200511490922413208178149869347802988786513451486411409887164516065062084917556120712465074206435831498113605
8786437178698940322877889807009957616777351844979869726962356553244050911283984280960665761649310895230455072977431415102053987735969326553978994853162483051544656873294555116009995592043183070208706258164840540599577072097104139505857517663273929851202628854185356185647194933800084230503413037858893307713037149307477830536758283681093517617820169181420796105338681582230788318108428132051793761014952837330456262272828627355701464740578197966332613127307037255647286823496355917642353327912440019621838870388091824748629637425759125214639885130163183752378908729773517053259212525494555880921052679512582051516604297098204363525081039382358483926727008679327719083138865969291911863630382097160230960738043575559330264018212774424527719153248563876760067931499029384228993253862501939337758514377472011933279273181144830381169849387893799390755052093069179605579485710343655570028592595882436632426527654452895431758715126580164902410286422637215098476316042367916779431052267545769495994723721129943616294879642305545894912914632980455031755879087401575310699765408473606166727137934224515998416625122213056208800095077933103150699272650116151674702438463062734472714004926103668378506804002740045547964716693536349447660850580
205314962204511500352858372254132533167549960825498949618514841570703199264867431580754674275990554478140637041427842111391746883257447120035947621456863890934062044010795443059281736346976175772415034838334682726635263432655537852942177334888025283748611576171534251461847349566505628290587224150869640386437623371249743165260396675220683302142805646368906930575140628610003919131999295855501215111393294818218799982703289304596989070475000081175510085432290264502023736899104746316830742226946395027029820825791831870857382647221322734605026210073093918331247494307555600335550942340526536281372036612138713881098866303169425501998978400008829873080965592009371176208668290074288903681417933657472279670688597862835627506340169978450918788539270346340385928840299573889292189531738082166408734046381423516467694328971385421907314814283489322619386570046183556572383980777277173349209330683424343658179781015072259378576130442222984963071166207642585589822061597282467850868050737957726423713761694231879497037175627546427449730638216214828463003483408928375620315193290871300316930139260521382533279767663839278693750409419493280753368451508802658272220767624766390639285308433607255253282702383762149755935518922075584637512494819
271453634732502613378948161256470991260052778799128789839624515809143527363206813219580098196957510291648493698144497567392065251244844074992734669490296293997386198359280316655904691639367482203210051809125904410431506925238374843856343243276508280641059690938930957474434518308646618959004216831130099873532714372402117796666560677624822509159287675432413016478948594640872091688482149004426363946048517480052906306290126242866034249478040406351940088231081456109195799442996799641647167552689564613346415247906852055588498305665928450828756152103096629274760601528737639415361467941349982213641454967962723875032638267311935042334584913897338553953961877439389588793074211502597238465542889335363559052368180212013206172712561221352833891640659020253527584706465205486408990762759230842192028381048563437724528409174790022752557512795782713125166158329880702730769957185428522011430144840232256419113631679343171680631630775266488738173707357123139368825087043785842169049943237537188129367275730984789479909103397937113837824575137021012333461552176687570010445744268373840742899299977372834041925102853718964831225250407279578465008537542659673685686242773379131904890865110699190451534445434533919127658976874721029586168106207

rsa.py:
from Crypto.Util.number import bytes_to_long, getPrime
from random import randint
from gmpy2 import powmod

p &#x3D; getPrime(2048)
q &#x3D; getPrime(2048)
N &#x3D; p*q
Phi &#x3D; (p-1)*(q-1)
def get_enc_key(N,Phi):
    e &#x3D; getPrime(N)
    if Phi % e &#x3D;&#x3D; 0:
        return get_enc_key(N, Phi)
    else:
        return e
e1 &#x3D; get_enc_key(randint(10, 12), Phi)
e2 &#x3D; get_enc_key(randint(10, 12), Phi)

fr &#x3D; open(r&quot;.&#x2F;base64&quot;, &quot;rb&quot;)#flag is in this file
f1 &#x3D; open(r&quot;.&#x2F;HUB1&quot;, &quot;wb&quot;)
f2 &#x3D; open(r&quot;.&#x2F;HUB2&quot;, &quot;wb&quot;)
base64 &#x3D; fr.read(255)
f1.write(&quot;%d\n%d\n&quot; % (N, e1))
f2.write(&quot;%d\n%d\n&quot; % (N, e2))
while len(base64)&gt;0:
    pt &#x3D; bytes_to_long(base64)
    ct1 &#x3D; powmod(pt, e1, N)
    ct2 &#x3D; powmod(pt, e2, N)
    f1.write(&quot;\n%d&quot; % ct1)
    f2.write(&quot;\n%d&quot; % ct2)
    base64 &#x3D; fr.read(255)
fr.close()
f1.close()
f2.close()

hind.txt:
素数生成算法太麻烦了，有没有取巧的方法呢？
诶，这里好像有个不错的想法哟。
看起来节约了不少时间呢，嘿嘿嘿……
顺便问问，应该大家都知道base64吧，用来编码还是很方便的呢！<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>题目中的HUB文件包含了N，e1, e2, 6组密文，考察的是rsa的共模攻击，最后还有base64隐写。</p>
<p>什么是base64隐写？我们知道base64的加密过程中，如果不够4个6字节的时候，会在原始数据后面补上0，编码是’=’，这样在解密的时候会自动忽略掉这些数据，所以我们可以用其他数据填充到这些位置上而不改变原来的解码效果。这道题是通过比较朴素的base64编码来找到隐写的数据，最后再解码。</p>
<p>脚本如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes<span class="token punctuation">,</span> inverse
<span class="token keyword">import</span> gmpy2
<span class="token keyword">import</span> base64

n <span class="token operator">=</span> <span class="token number">785095419718268286866508214304816985447077293766819398728046411166917810820484759314291028976498223661229395009474063173705162627037610993539617751905443039278227583504604808251931083818909467613277587874545761074364427549966555519371913859875313577282243053150056274667798049694695703660313532933165449312949725581708965417273055582216295994587600975970124811496270080896977076946000102701030260990598181466447208054713391526313700681341093922240317428173599031624125155188216489476825606191521182034969120343287691181300399683515414809262700457525876691808180257730351707673660380698973884642306898810000633684878715402823143549139850732982897459698089649561190746850698130299458080255582312696873149210028240898137822888492559957665067936573356367589784593119016624072433872744537432005911668494455733330689385141214653091888017782049043434862620306783436169856564175929871100669913438980899219579329897753233450934770193915434791427728636586218049874617231705308003720066269312729135764175698611068808404054125581540114956463603240222497919384691718744014002554201602395969312999994159599536026359879060218056496345745457493919771337601177449899066579857630036350871090452649830775029695488575574985078428560054253180863725364147</span>
e1 <span class="token operator">=</span> <span class="token number">1697</span>
e2 <span class="token operator">=</span> <span class="token number">599</span>
c1_1 <span class="token operator">=</span> <span class="token number">412629526163150748619328091306742267675740578011800062477174189782151273970783531227579758540364970485350157944321579108232221072397135934034064481497887079641131808838242743811511451355024436983050572020925065644355566434625618133203024215941534926113892937988520918939061441606915556516246057349589921494351383160036280826024605351878408056180907759973804117263002554923041750587548819746346813966673034182913325507826219961923932100526305289894965216608254252188398580139545189681875824089456195044984585824938384521905334289906422454152976834867304693292466676355760173232407753256256317546190171995276258924613533179898467683358934751999655196790168438343198229183747091108262988777659858609744709324571850262293294975336628234767258858873839342596887193772615000676401522431518310648303975593582965021189182246986957349253156736526071639973844039068996404290548474640668851856078201093335425412842295604919065487301340901573809617549185106072798799159726375235125260509158832996701927878713084753334549129580912412168594170659605421750204835970231909591063407612779337478065175988365401590396247576709343727196106058477166945670117868989025903023998142850338956985816131805349549059377047477131270847579095628384569645636821650</span>
c1_2 <span class="token operator">=</span> <span class="token number">494644347943710545224678831941589086572700792465459558770782213550069709458568349686998660541810166872034041584767487150140111151788221460027897193248273461607411027815984883969396220626358625041781558277804930212654296704055890683796941327712758797770820006623289146990000114915293539639766846910274034245607746230740851938158390562286057002223177609606376329007676845450142537930798148258428701466415483232670659815791064681384406494388237742330786225557303988025468036820082959712050733095860546860468575857084616069132051094882919253745234762029759124776348047587755897123575123506976140900565238840752841856713613368250071926171873213897914794115466890719123299469964019450899291410760762179836946570945555295288184698184555018368687708432612286248476073758067175481771199066581572870175460016017100414479346437034291784837132240891321931601494414908927713208448927221095745802380014441841139882391378410438764884597938773868771896252329517440068673532468372840830510218585255432000690265226016573313570977945083879214961394087065558376158826938257664840570952233832852869328785568175434516247720356520242602299510374317488182738732700078879665745909603766482100138001417023680647717824323143388857817595766172152883484274718248</span>
c1_3 <span class="token operator">=</span> <span class="token number">152942283599728307168144137370127212672611894072038732126041098102628831053000986759260271210671922070555948023688596575415822984026159010574404359474670428678518262175033880513984372909748992727828381694416776740981021730545374002974037896534944567124543272737618380646771071804878796585983783360553761828325817820260204820004421979881871027255562690952334900616675606524933557440263648233514757200263521499508373975003431306847453046714027687108396945719803444444954079308404947126216395526551292104722047878178373207886033071857277857997932255251315982837892164421298202073945919187779856785892717251746704537315003771369737854896595170485152591013676942418134278534037654467840633528916812275267230155352077736583130992587670941654695382287023971261529987384520843829695778029311786431227409189019205818351911572757145556993606643464336196802350204616056286497246016800105003143046120608673496196758720552776772796609670537056331996894322779267635281472481559819839042424017171718303214059720568484939239370144038161541354254182769979771948759413102933987773401644506930205164891773826513161783736386604783484446345744957119469799231796368324927570694496679453313927562345656690240414624431304646248599226046524702364131095964335</span>
c1_4 <span class="token operator">=</span> <span class="token number">79717988936247951265489157583697956031893477858854186991051529161879478488281744062318600470906120960002282886511477294555606503083169449335174864424180701080203993329996226566203834693869525797695969610065991941396723959032680019082506816443041598300477625793433080664346470586416385854692124426348587211026568667694805849554780794033764714016521711467557284846737236374990121316809833819996821592832639024026411520407330206281265390130763948165694574512140518775603040182029818771866749548761938870605590174330887949847420877829240131490902432602005681085180807294176837646062568094875766945890382971790015490163385088144673549085079635083262975154206269679142412897438231719704933258660779310737302680265445437771977749959110744959368586293082016067927548564967400845992380076107522755566531760628823374519718763740378295585535591752887339222947397184116326706799921515431185636740825707782742373783475781052674257292910213843986132987466810027275052416774693363446184518901899202502828670309452622347532932678874990809930682575738653876289384151496807194146308614368821006660626870989784697045160231069428458961107751207771093777394616856305293335603892178327520756554333365975114235981173451368131680404850832773147333013716920</span>
c1_5 <span class="token operator">=</span> <span class="token number">123111353650401158556639983459870663057297871992927053886971224773529636525110628183715748795987525113177540092814119928708272290370336537110381023134637759740716140969662183269370676630325583385284994943164692397459103195434968057377474610500216801375394703781249039351368816958227409657934091741509357152328382960684515093945552479461382281913961956745154260686029997827565075768703774895750561575155143606297116391666385705899138085693913246313778033627210312268959737394553510894720099165193981333775907531107232556909478156441457899797515694348816961762796703443502856101079430585547997496001098926600499728389113862894833789669213630332988693669889340482430613291490613803204484751470676686041002772556117213612152322606737150858116122936539131795111263513114569794532805886643087299918196635113037777138666914296986040549274559835214505300618256105508764026461518876579387159881983544667258537064954616097750399839661065797883103731694314852301848272092388637114950059216922969842082648527035538090054093890365647676119748995243416337805666557501345234056968476142608491830438065401219751688687373709390057521910942736632126729711606256158399963682990881473178216060827021373776598901281958527655543318413664277921492723185984</span>
c1_6 <span class="token operator">=</span> <span class="token number">36869806815936046911848195817405817350259890871483063184373728397968909458432625046025376290214729914038387534731762237978339011724858818860181178811639468996206294711495853807311240013786226884265118119546377272154555615363105236192878292703331473547623021744317034819416624562896226194523639793573028006666236271812390759036235867495803255905843636447252225413871038762657801345647584493917576263471587347202664391908570140389126903204602391093990827188675090199750617303773574821926387194478875191828814971296674530519321530805302667925998711835019806761133078403281404889374663875077339168901297819436499920958268483684335998301056068380228873524800383911402490807139268964095165069610454677558808756444381542173782815227920906224931028457073652453777424387873533280455944646592996920617956675786286711447540353883400282402551158169958389450168079568459656526911857835375748015814860506707921852997096156275804955989964215077733621769938075413007804223217091604613132253046399456747595300404564172224333936405545921819654435437072133387523533568472443532200069133022979195685683508297337961701169394794966256415112246587706103819620428258245999539040721929317130088874161577093962579487428358736401687123174207198251449851429295</span>

c2_1 <span class="token operator">=</span> <span class="token number">592169079372093727306100216011395857825646323934289480976073629037543922902098120901138454462177159996376654176248238979132528728327590301098966139983157980612320563496546128644967731000716697705104079039156276714872147463350811303393260622707024952543509891692246246277965823414460326811240048060543656588688604452353899779068825120910282167004715339763187734797180326976132213325054697165320479166356562518029805927741656605174809726397565772271562066078076105491745903986597877400370206718954975288721072048333678609055008135809089304229015364348490924974097403734627265297637171818849461766523691595241613878709865506436588268999163342945070495338153600520537498539457396582804692959296612715752573140296135784933206146091436617979599749774330699946637591406356289409716084034451049094715202196203486088368791744107629271647320273259836915312794297246589501008666299165717722507702866033454215783240025504356157664454861755286285777763585177751796252655008206383024707883077513745863312079349790275094080707502392866946325796914450602264462588722052297430827681750827349094323968337670311272933785838850649376115667223821665435911506351891489985627506615492005617098615432522564204152887767244129985681083657783356557756654335186</span>
c2_2 <span class="token operator">=</span> <span class="token number">373940646416832740878733255707567753033716583448402000789202767511920210382830343955553654111486728333980557319799362514960627879016797491389812007768832730979916230647641872759001906846747977631675704310179448857128160385701185892914523053669366534408863734305635222625590986006420486092550427301086984563126480814987024980594613542978310129247678826691418335300577577527951623696426435497835228167084738007750914270251001921329521479047662848650808989996085600197309361410863238526802127877523767262921515150984998560136647154865791163316503073285223966216441025637452229043510097323724381056976302288136843260163922706692913035222445496716008888946581535004546355744211680390731257309941902587303353139951102244865270295414474488798335404630458489706639805186573874814586736746232358849677477533671968344154242963289415569487579895910660999043578737461300406937828924818002658292769882181668784501439254131996848948120781562158861495883827848139425862249576454689133681009549361314460818658995959098228995702202268649635363105549975932395335076521137604288520082040121286614922986554652700056148966514178935952363036963217619879899671383604638416567950421350546204434902113156720006282720889591288850271076074941927715678306057176</span>
c2_3 <span class="token operator">=</span> <span class="token number">527630926460622936571385649841758214453416849039412401087443444317101857090904711485538107058823056085840539073345920792871368232355475394571098380596835468509997340505604333730547799560998822989747473780307779717715522787724471724766494090783971030594671013168209717686720448579582618378459567979027822271918653169622428153856198907810040224340270362413432495029672123261375400927159831537760709974778708160583252613784358234858583174544777979242887938827573604837766801998381379999076416444683891078093889686055482709838668356120916040352123019019255084513769603803814947774554028717814638951416291274696771515474086351482107953150253616922787262398450376249126999644026382478413080973933173079111305142716133389111399235545279259017424722601848670061556859163943895466553927946412523750166582734005733378328468250568944945912238495877929717101722314678120172228493787964904072583905721074766711732215815561012960394537195757832959268603775112932862105945720853959285187521763557915356428113876893276879775603217718981852114599706699524551973934242045743122744146361596971245034059345915315495232135483464496114770357536576200511490922413208178149869347802988786513451486411409887164516065062084917556120712465074206435831498113605</span>
c2_4 <span class="token operator">=</span> <span class="token number">8786437178698940322877889807009957616777351844979869726962356553244050911283984280960665761649310895230455072977431415102053987735969326553978994853162483051544656873294555116009995592043183070208706258164840540599577072097104139505857517663273929851202628854185356185647194933800084230503413037858893307713037149307477830536758283681093517617820169181420796105338681582230788318108428132051793761014952837330456262272828627355701464740578197966332613127307037255647286823496355917642353327912440019621838870388091824748629637425759125214639885130163183752378908729773517053259212525494555880921052679512582051516604297098204363525081039382358483926727008679327719083138865969291911863630382097160230960738043575559330264018212774424527719153248563876760067931499029384228993253862501939337758514377472011933279273181144830381169849387893799390755052093069179605579485710343655570028592595882436632426527654452895431758715126580164902410286422637215098476316042367916779431052267545769495994723721129943616294879642305545894912914632980455031755879087401575310699765408473606166727137934224515998416625122213056208800095077933103150699272650116151674702438463062734472714004926103668378506804002740045547964716693536349447660850580</span>
c2_5 <span class="token operator">=</span> <span class="token number">205314962204511500352858372254132533167549960825498949618514841570703199264867431580754674275990554478140637041427842111391746883257447120035947621456863890934062044010795443059281736346976175772415034838334682726635263432655537852942177334888025283748611576171534251461847349566505628290587224150869640386437623371249743165260396675220683302142805646368906930575140628610003919131999295855501215111393294818218799982703289304596989070475000081175510085432290264502023736899104746316830742226946395027029820825791831870857382647221322734605026210073093918331247494307555600335550942340526536281372036612138713881098866303169425501998978400008829873080965592009371176208668290074288903681417933657472279670688597862835627506340169978450918788539270346340385928840299573889292189531738082166408734046381423516467694328971385421907314814283489322619386570046183556572383980777277173349209330683424343658179781015072259378576130442222984963071166207642585589822061597282467850868050737957726423713761694231879497037175627546427449730638216214828463003483408928375620315193290871300316930139260521382533279767663839278693750409419493280753368451508802658272220767624766390639285308433607255253282702383762149755935518922075584637512494819</span>
c2_6 <span class="token operator">=</span> <span class="token number">271453634732502613378948161256470991260052778799128789839624515809143527363206813219580098196957510291648493698144497567392065251244844074992734669490296293997386198359280316655904691639367482203210051809125904410431506925238374843856343243276508280641059690938930957474434518308646618959004216831130099873532714372402117796666560677624822509159287675432413016478948594640872091688482149004426363946048517480052906306290126242866034249478040406351940088231081456109195799442996799641647167552689564613346415247906852055588498305665928450828756152103096629274760601528737639415361467941349982213641454967962723875032638267311935042334584913897338553953961877439389588793074211502597238465542889335363559052368180212013206172712561221352833891640659020253527584706465205486408990762759230842192028381048563437724528409174790022752557512795782713125166158329880702730769957185428522011430144840232256419113631679343171680631630775266488738173707357123139368825087043785842169049943237537188129367275730984789479909103397937113837824575137021012333461552176687570010445744268373840742899299977372834041925102853718964831225250407279578465008537542659673685686242773379131904890865110699190451534445434533919127658976874721029586168106207</span>

<span class="token keyword">def</span> <span class="token function">same_n_attack</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> e1<span class="token punctuation">,</span> e2<span class="token punctuation">,</span> c1<span class="token punctuation">,</span> c2<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">#扩展欧几里得算法，求得a与b的系数</span>
    <span class="token keyword">def</span> <span class="token function">exgcd</span><span class="token punctuation">(</span>a <span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment">#当a % b == 0时表示已求得最大公约数和两个系数</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>b <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment">#返回的第一个参数最大公约数，第二个参数a的系数，第三个参数是b的系数</span>
            <span class="token comment">#这里0和任何数的最大公约数是这个数的本身</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment">#将函数返回的结果依次赋值给d, x, y</span>
            d<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y <span class="token operator">=</span> exgcd<span class="token punctuation">(</span>b<span class="token punctuation">,</span> a <span class="token operator">%</span> b<span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span>d<span class="token punctuation">,</span> y<span class="token punctuation">,</span> x <span class="token operator">-</span> <span class="token punctuation">(</span>a <span class="token operator">//</span> b<span class="token punctuation">)</span> <span class="token operator">*</span> y<span class="token punctuation">)</span>

    s <span class="token operator">=</span> exgcd<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> e2<span class="token punctuation">)</span>
    s1 <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    s2 <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>

    <span class="token comment">#当s是负数的时候，一个数的负数次幂，先计算c的模反元素cr，然后求cr的-s次幂。</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>s1 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        s1 <span class="token operator">=</span> <span class="token operator">-</span>s1
        c1 <span class="token operator">=</span> inverse<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> n<span class="token punctuation">)</span>

    <span class="token keyword">elif</span> <span class="token punctuation">(</span>s2 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        s2 <span class="token operator">=</span> <span class="token operator">-</span>s2
        c2 <span class="token operator">=</span> inverse<span class="token punctuation">(</span>c2<span class="token punctuation">,</span> n<span class="token punctuation">)</span>

    m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span>s1<span class="token punctuation">,</span>n<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c2<span class="token punctuation">,</span>s2<span class="token punctuation">,</span>n<span class="token punctuation">)</span> <span class="token operator">%</span> n
    <span class="token keyword">return</span> m

c1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
c2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
flag <span class="token operator">=</span> <span class="token string">""</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    c1<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token string">"c1_"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    c2<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token string">"c2_"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    flag <span class="token operator">+=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>same_n_attack<span class="token punctuation">(</span>n<span class="token punctuation">,</span> e1<span class="token punctuation">,</span> e2<span class="token punctuation">,</span> c1<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c2<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">#base64隐写</span>
c <span class="token operator">=</span> <span class="token string">b'VEhJUz==\nRkxBR3==\nSVN=\nSElEREVOLo==\nQ0FO\nWU9V\nRklORM==\nSVT=\nT1VUP4==\nRE8=\nWU9V\nS05PV9==\nQkFTRTY0P5==\nWW91bmdD\nVEhJTku=\nWU9V\nQVJF\nTk9U\nVEhBVE==\nRkFNSUxJQVI=\nV0lUSO==\nQkFTRTY0Lh==\nQmFzZTY0\naXO=\nYW==\nZ3JvdXA=\nb2b=\nc2ltaWxhcn==\nYmluYXJ5LXRvLXRleHR=\nZW5jb2Rpbme=\nc2NoZW1lc0==\ndGhhdD==\ncmVwcmVzZW50\nYmluYXJ5\nZGF0YW==\naW5=\nYW6=\nQVNDSUl=\nc3RyaW5n\nZm9ybWF0\nYnk=\ndHJhbnNsYXRpbmd=\naXS=\naW50b1==\nYT==\ncmFkaXgtNjQ=\ncmVwcmVzZW50YXRpb24u\nVGhl\ndGVybc==\nQmFzZTY0\nb3JpZ2luYXRlc8==\nZnJvbd==\nYY==\nc3BlY2lmaWN=\nTUlNRT==\nY29udGVudI==\ndHJhbnNmZXI=\nZW5jb2Rpbmcu\nVGhl\ncGFydGljdWxhct==\nc2V0\nb2b=\nNjR=\nY2hhcmFjdGVyc5==\nY2hvc2Vu\ndG+=\ncmVwcmVzZW50\ndGhl\nNjQ=\ncGxhY2UtdmFsdWVz\nZm9y\ndGhl\nYmFzZd==\ndmFyaWVz\nYmV0d2Vlbt==\naW1wbGVtZW50YXRpb25zLp==\nVGhl\nZ2VuZXJhbI==\nc3RyYXRlZ3n=\naXO=\ndG9=\nY2hvb3Nl\nNjR=\nY2hhcmFjdGVyc5==\ndGhhdA==\nYXJl\nYm90aN==\nbWVtYmVyc5==\nb2a=\nYS==\nc3Vic2V0\nY29tbW9u\ndG8=\nbW9zdM==\nZW5jb2RpbmdzLA==\nYW5k\nYWxzb8==\ncHJpbnRhYmxlLg==\nVGhpc9==\nY29tYmluYXRpb25=\nbGVhdmVz\ndGhl\nZGF0YW==\ndW5saWtlbHk=\ndG/=\nYmV=\nbW9kaWZpZWS=\naW5=\ndHJhbnNpdE==\ndGhyb3VnaN==\naW5mb3JtYXRpb26=\nc3lzdGVtcyw=\nc3VjaN==\nYXM=\nRS1tYWlsLD==\ndGhhdA==\nd2VyZQ==\ndHJhZGl0aW9uYWxseQ==\nbm90\nOC1iaXQ=\nY2xlYW4uWzFd\nRm9y\nZXhhbXBsZSw=\nTUlNRSdz\nQmFzZTY0\naW1wbGVtZW50YXRpb24=\ndXNlcw==\nQahDWiw=\nYahDeiw=\nYW5k\nMKhDOQ==\nZm9y\ndGhl\nZmlyc3Q=\nNjI=\ndmFsdWVzLg==\nT3RoZXI=\ndmFyaWF0aW9ucw==\nc2hhcmU=\ndGhpcw==\ncHJvcGVydHk=\nYnV0\nZGlmZmVy\naW4=\ndGhl\nc3ltYm9scw==\nY2hvc2Vu\nZm9y\ndGhl\nbGFzdA==\ndHdv\ndmFsdWVzOw==\nYW4=\nZXhhbXBsZQ==\naXM=\nVVRGLTcu'</span>

<span class="token keyword">def</span> <span class="token function">get_base64_diff_value</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> s2<span class="token punctuation">)</span><span class="token punctuation">:</span>
    base64chars <span class="token operator">=</span> <span class="token string">b'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span>
    res <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> s1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> s2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token builtin">abs</span><span class="token punctuation">(</span>base64chars<span class="token punctuation">.</span>index<span class="token punctuation">(</span>s1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> base64chars<span class="token punctuation">.</span>index<span class="token punctuation">(</span>s2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> res

<span class="token keyword">def</span> <span class="token function">solve_stego</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    line<span class="token operator">=</span><span class="token string">b''</span>
    bin_str<span class="token operator">=</span><span class="token string">''</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> c<span class="token punctuation">:</span>
        k<span class="token operator">=</span>long_to_bytes<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
        <span class="token keyword">if</span> k<span class="token operator">==</span><span class="token string">b'\n'</span><span class="token punctuation">:</span>
            steg_line <span class="token operator">=</span> line
            norm_line <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">)</span>
            diff <span class="token operator">=</span> get_base64_diff_value<span class="token punctuation">(</span>steg_line<span class="token punctuation">,</span> norm_line<span class="token punctuation">)</span>
            <span class="token comment">#print(diff)</span>
            pads_num <span class="token operator">=</span> steg_line<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token string">b'='</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> diff<span class="token punctuation">:</span>
                bin_str <span class="token operator">+=</span> <span class="token builtin">bin</span><span class="token punctuation">(</span>diff<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span>pads_num <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                bin_str <span class="token operator">+=</span> <span class="token string">'0'</span> <span class="token operator">*</span> pads_num <span class="token operator">*</span> <span class="token number">2</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>goflag<span class="token punctuation">(</span>bin_str<span class="token punctuation">)</span><span class="token punctuation">)</span>
            line<span class="token operator">=</span><span class="token string">b''</span>
            <span class="token keyword">continue</span>
        line<span class="token operator">+=</span>k

<span class="token keyword">def</span> <span class="token function">goflag</span><span class="token punctuation">(</span>bin_str<span class="token punctuation">)</span><span class="token punctuation">:</span>
    res_str <span class="token operator">=</span> <span class="token string">''</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>bin_str<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        res_str <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>bin_str<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> res_str


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    solve_stego<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>运行脚本可得flag。</p>
<hr>
<h2 id="WUSTCTF2020-大数计算"><a href="#WUSTCTF2020-大数计算" class="headerlink" title="[WUSTCTF2020]大数计算"></a>[WUSTCTF2020]大数计算</h2><p>题目描述：</p>
<pre class="line-numbers language-none"><code class="language-none">flag等于 wctf2020&#123;Part1-Part2-Part3-Part4&#125; 每一Part都为数的十六进制形式（不需要0x)，并用 &#39;-&#39; 连接
Part1 &#x3D; 2020*2019*2018* ... *3*2*1 的前8位
Part2 &#x3D; 520^1314 + 2333^666 的前8位
Part3 &#x3D; 宇宙终极问题的答案 x,y,z绝对值和的前8位
Part4 &#x3D; 见图片附件，计算结果乘上1314<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img "" class="lazyload placeholder" data-original="/2021/08/17/BUUCTF-Crypto%E7%B3%BB%E5%88%97-81-96-WP/Post10_image1.jpg" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif"></p>
<p>Part1的答案是：38609695；Part2的答案是：67358675；Part3的答案是：17357662； Part4的答案是：683280。</p>
<p>宇宙终极问题的答案：42 =(-80538738812075974)³+ 80435758145817515³+ 12602123297335631³</p>
<p>分别进行16进制的转换，加上拼接就可以得到flag。</p>
<hr>
<h2 id="坏蛋是雷宾"><a href="#坏蛋是雷宾" class="headerlink" title="坏蛋是雷宾"></a>坏蛋是雷宾</h2><p>题目如下：</p>
<p><img "" class="lazyload placeholder" data-original="/2021/08/17/BUUCTF-Crypto%E7%B3%BB%E5%88%97-81-96-WP/Post10_image2.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif"></p>
<p>加密过程：</p>
<ol>
<li>随机选取两个足够大且两者的值接近的素数p,q</li>
<li>N=p*q</li>
<li>C=M^2 %N(M为明文,C为密文)</li>
</ol>
<p>解密过程：</p>
<p><img "" class="lazyload placeholder" data-original="/2021/08/17/BUUCTF-Crypto%E7%B3%BB%E5%88%97-81-96-WP/Post10_image3.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif"></p>
<p><img "" class="lazyload placeholder" data-original="/2021/08/17/BUUCTF-Crypto%E7%B3%BB%E5%88%97-81-96-WP/Post10_image4.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif"></p>
<p>其中yp和yq可以通过扩展欧几里得算法求得一组解。</p>
<p>在得到了mp,mq,yp,yq之后,最终得到的明文有4个：</p>
<p><img "" class="lazyload placeholder" data-original="/2021/08/17/BUUCTF-Crypto%E7%B3%BB%E5%88%97-81-96-WP/Post10_image5.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif"></p>
<p>得到的4个明文需要通过验证码进行校验筛选。</p>
<p>脚本如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes<span class="token punctuation">,</span> inverse
<span class="token keyword">import</span> gmpy2
<span class="token keyword">import</span> hashlib

n <span class="token operator">=</span> <span class="token number">523798549</span>
p <span class="token operator">=</span> <span class="token number">10663</span>
q <span class="token operator">=</span> <span class="token number">49123</span>  <span class="token comment">#a通过factor分解</span>
c <span class="token operator">=</span> <span class="token number">162853095</span>
test_text <span class="token operator">=</span> <span class="token string">"110001"</span> <span class="token comment">#二进制</span>

<span class="token comment">#扩展欧几里得算法，求得a与b的系数</span>
<span class="token keyword">def</span> <span class="token function">exgcd</span><span class="token punctuation">(</span>a <span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">#当a % b == 0时表示已求得最大公约数和两个系数</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>b <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment">#返回的第一个参数最大公约数，第二个参数a的系数，第三个参数是b的系数</span>
        <span class="token comment">#这里0和任何数的最大公约数是这个数的本身</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token comment">#将函数返回的结果依次赋值给d, x, y</span>
        d<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y <span class="token operator">=</span> exgcd<span class="token punctuation">(</span>b<span class="token punctuation">,</span> a <span class="token operator">%</span> b<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>d<span class="token punctuation">,</span> y<span class="token punctuation">,</span> x <span class="token operator">-</span> <span class="token punctuation">(</span>a <span class="token operator">//</span> b<span class="token punctuation">)</span> <span class="token operator">*</span> y<span class="token punctuation">)</span>

result <span class="token operator">=</span> exgcd<span class="token punctuation">(</span>p<span class="token punctuation">,</span> q<span class="token punctuation">)</span>
yp <span class="token operator">=</span> result<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
yq <span class="token operator">=</span> result<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>

mp <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">4</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span>
mq <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token punctuation">(</span>q <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">4</span><span class="token punctuation">,</span> q<span class="token punctuation">)</span>
r <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token punctuation">(</span>yp <span class="token operator">*</span> p <span class="token operator">*</span> mq <span class="token operator">+</span> yq <span class="token operator">*</span> q <span class="token operator">*</span> mp<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>
sub_r <span class="token operator">=</span> n <span class="token operator">-</span> r
s <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token punctuation">(</span>yp <span class="token operator">*</span> p <span class="token operator">*</span> mq <span class="token operator">-</span> yq <span class="token operator">*</span> q <span class="token operator">*</span> mp<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>
sub_s <span class="token operator">=</span> n <span class="token operator">-</span> s

true_m <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token punctuation">(</span>r<span class="token punctuation">,</span> sub_r<span class="token punctuation">,</span> s<span class="token punctuation">,</span> sub_s<span class="token punctuation">)</span><span class="token punctuation">:</span>
    i <span class="token operator">=</span> <span class="token builtin">bin</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>i<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">==</span> test_text<span class="token punctuation">)</span><span class="token punctuation">:</span>
        true_m <span class="token operator">=</span> i<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>i<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">" "</span><span class="token punctuation">)</span>
        true_m <span class="token operator">=</span> true_m<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'0b'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
        <span class="token keyword">break</span>

int_m <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>true_m<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
str_m <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>int_m<span class="token punctuation">)</span>
hmd5 <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token punctuation">)</span>
hmd5<span class="token punctuation">.</span>update<span class="token punctuation">(</span>str_m<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
flag <span class="token operator">=</span> hmd5<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>运行脚本可得flag。</p>
<hr>
<h2 id="HDCTF2019-together"><a href="#HDCTF2019-together" class="headerlink" title="[HDCTF2019]together"></a>[HDCTF2019]together</h2><p>题目如下：</p>
<pre class="line-numbers language-none"><code class="language-none">myflag1:
R3Noy6r3WLItytAmb4FmHEygoilucEEZbO9ZYXx5JN03HNpBLDx7fXd2fl+UL5+11RCs&#x2F;y0qlTGURWWDtG66eNLzGwNpAKiVj6I7RtUJl2Pcm3NvFeAFwI9UsVREyh7zIV6sI9ZP8l&#x2F;2GVDorLAz5ULW+f0OINGhJmZm8FL&#x2F;aDnlfTElhQ87LPicWpXYoMtyr6WrxjK6Ontn8BqCt0EjQ7TeXZhxIH9VTPWjDmFdmOqaqdVIT+LZemTgLNESwM5nn4g5S3aFDFwj1YiDYl0&#x2F;+8etvKfOrfoKOwR0CxsRHagwdUUTES8EcHLmMGCxCkDZn3SzmmA6Nb3lgLeSgG8P1A&#x3D;&#x3D;
myflag2:
O+rRCXI3aTB6P1rYIOPUdalUp6ujpwEq4I20CoWA+HIL8xxGtqY6N5gpr0guZv9ZgOEAMFnBxOqMdVNnB9GgnhmXtt1ZWydPqIcHvlfwpd&#x2F;Lyd0XSjXnjaz3P3vOQvR71cD&#x2F;uXyBA0XPzmnTIMgEhuGJVFm8min0L&#x2F;2qI7wg&#x2F;Z7w1+4mOmi655JIXeCiG23ukDv6l9bZuqfGvWCa1KKXWDP31nLbp0ZN2obUs6jEAa1qVTaX6M4My+sks+0VvHATrAUuCrmMwVEivqIJ&#x2F;nS6ymGVERN6Ohnzyr168knEBKOVj0FAOx3YLfppMM+XbOGHeqdKJRLpMvqFXDMGQInT3w&#x3D;&#x3D;
pubkey1.pem:
-----BEGIN PUBLIC KEY-----
MIIBITANBgkqhkiG9w0BAQEFAAOCAQ4AMIIBCQKCAQB1qLiqKtKVDprtS+NGGN++
q7jLqDJoXMlPRRczMBAGJIRsz5Dzwtt1ulr0s5yu8RdaufiYeU6sYIKk92b3yygL
FvaYCzjdqBF2EyTWGVE7PL5lh3rPUfxwQFqDR8EhIH5x+Ob8rjlkftIjHTBt1ThJ
JXvDBumXpQKGcBIknRaR9dwR1q8GU58&#x2F;gIk5ND3eCTAadhrhLByWkHbFArxalx4Q
q8s2ZUe8lDc&#x2F;N6V93EOFjbKbqqqtDmhniF6jdXQDAIwWTpx6+jmzxlCJoVHd2MBs
ZCcQhvklWtuKz4IYL4+iUpMKGHlhY1vCqFx2EzD4XIljFLP9rk7+9+CoyTuIVL&#x2F;D
AgMACR0&#x3D;
-----END PUBLIC KEY-----
pubkey2.pem:
-----BEGIN PUBLIC KEY-----
MIIBIDANBgkqhkiG9w0BAQEFAAOCAQ0AMIIBCAKCAQB1qLiqKtKVDprtS+NGGN++
q7jLqDJoXMlPRRczMBAGJIRsz5Dzwtt1ulr0s5yu8RdaufiYeU6sYIKk92b3yygL
FvaYCzjdqBF2EyTWGVE7PL5lh3rPUfxwQFqDR8EhIH5x+Ob8rjlkftIjHTBt1ThJ
JXvDBumXpQKGcBIknRaR9dwR1q8GU58&#x2F;gIk5ND3eCTAadhrhLByWkHbFArxalx4Q
q8s2ZUe8lDc&#x2F;N6V93EOFjbKbqqqtDmhniF6jdXQDAIwWTpx6+jmzxlCJoVHd2MBs
ZCcQhvklWtuKz4IYL4+iUpMKGHlhY1vCqFx2EzD4XIljFLP9rk7+9+CoyTuIVL&#x2F;D
AgJbJQ&#x3D;&#x3D;
-----END PUBLIC KEY-----<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>使用以下脚本分别读取公钥信息：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">pub_key <span class="token operator">=</span> RSA<span class="token punctuation">.</span>importKey<span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'pubkey1.pem'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
n <span class="token operator">=</span> pub_key<span class="token punctuation">.</span>n
e <span class="token operator">=</span> pub_key<span class="token punctuation">.</span>e
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'n=\n%s\ne=\n%s'</span><span class="token operator">%</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>得到：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">n<span class="token operator">=</span><span class="token number">14853081277902411240991719582265437298941606850989432655928075747449227799832389574251190347654658701773951599098366248661597113015221566041305501996451638624389417055956926238595947885740084994809382932733556986107653499144588614105694518150594105711438983069306254763078820574239989253573144558449346681620784979079971559976102366527270867527423001083169127402157598183442923364480383742653117285643026319914244072975557200353546060352744263637867557162046429886176035616570590229646013789737629785488326501654202429466891022723268768841320111152381619260637023031430545168618446134188815113100443559425057634959299</span>
e1<span class="token operator">=</span><span class="token number">2333</span>
e2<span class="token operator">=</span><span class="token number">23333</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>n相同而e不同，共模攻击。先对密文进行base64解码，再转16进制，通过<a target="_blank" rel="noopener" href="https://www.qqxiuzi.cn/bianma/base64.htm">在线工具</a>得到：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">\x47 \x73 \x68 \xcb \xaa \xf7 \x58 \xb2 
\x2d \xca \xd0 \x26 \x6f \x81 \x66 \x1c 
\x4c \xa0 \xa2 \x29 \x6e \x70 \x41 \x19 
\x6c \xef \x59 \x61 \x7c \x79 \x24 \xdd 
\x37 \x1c \xda \x41 \x2c \x3c \x7b \x7d 
\x77 \x76 \x7e \x5f \x94 \x2f \x9f \xb5 
\xd5 \x10 \xac \xff \x2d \x2a \x95 \x31 
\x94 \x45 \x65 \x83 \xb4 \x6e \xba \x78 
\xd2 \xf3 \x1b \x03 \x69 \x00 \xa8 \x95 
\x8f \xa2 \x3b \x46 \xd5 \x09 \x97 \x63 
\xdc \x9b \x73 \x6f \x15 \xe0 \x05 \xc0 
\x8f \x54 \xb1 \x54 \x44 \xca \x1e \xf3 
\x21 \x5e \xac \x23 \xd6 \x4f \xf2 \x5f 
\xf6 \x19 \x50 \xe8 \xac \xb0 \x33 \xe5 
\x42 \xd6 \xf9 \xfd \x0e \x20 \xd1 \xa1 
\x26 \x66 \x66 \xf0 \x52 \xff \x68 \x39 
\xe5 \x7d \x31 \x25 \x85 \x0f \x3b \x2c 
\xf8 \x9c \x5a \x95 \xd8 \xa0 \xcb \x72 
\xaf \xa5 \xab \xc6 \x32 \xba \x3a \x7b 
\x67 \xf0 \x1a \x82 \xb7 \x41 \x23 \x43 
\xb4 \xde \x5d \x98 \x71 \x20 \x7f \x55 
\x4c \xf5 \xa3 \x0e \x61 \x5d \x98 \xea 
\x9a \xa9 \xd5 \x48 \x4f \xe2 \xd9 \x7a 
\x64 \xe0 \x2c \xd1 \x12 \xc0 \xce \x67 
\x9f \x88 \x39 \x4b \x76 \x85 \x0c \x5c 
\x23 \xd5 \x88 \x83 \x62 \x5d \x3f \xfb 
\xc7 \xad \xbc \xa7 \xce \xad \xfa \x0a 
\x3b \x04 \x74 \x0b \x1b \x11 \x1d \xa8 
\x30 \x75 \x45 \x13 \x11 \x2f \x04 \x70 
\x72 \xe6 \x30 \x60 \xb1 \x0a \x40 \xd9 
\x9f \x74 \xb3 \x9a \x60 \x3a \x35 \xbd 
\xe5 \x80 \xb7 \x92 \x80 \x6f \x0f \xd4 

<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
\x3b \xea \xd1 \x09 \x72 \x37 \x69 \x30 
\x7a \x3f \x5a \xd8 \x20 \xe3 \xd4 \x75 
\xa9 \x54 \xa7 \xab \xa3 \xa7 \x01 \x2a 
\xe0 \x8d \xb4 \x0a \x85 \x80 \xf8 \x72 
\x0b \xf3 \x1c \x46 \xb6 \xa6 \x3a \x37 
\x98 \x29 \xaf \x48 \x2e \x66 \xff \x59 
\x80 \xe1 \x00 \x30 \x59 \xc1 \xc4 \xea 
\x8c \x75 \x53 \x67 \x07 \xd1 \xa0 \x9e 
\x19 \x97 \xb6 \xdd \x59 \x5b \x27 \x4f 
\xa8 \x87 \x07 \xbe \x57 \xf0 \xa5 \xdf 
\xcb \xc9 \xdd \x17 \x4a \x35 \xe7 \x8d 
\xac \xf7 \x3f \x7b \xce \x42 \xf4 \x7b 
\xd5 \xc0 \xff \xb9 \x7c \x81 \x03 \x45 
\xcf \xce \x69 \xd3 \x20 \xc8 \x04 \x86 
\xe1 \x89 \x54 \x59 \xbc \x9a \x29 \xf4 
\x2f \xfd \xaa \x23 \xbc \x20 \xfd \x9e 
\xf0 \xd7 \xee \x26 \x3a \x68 \xba \xe7 
\x92 \x48 \x5d \xe0 \xa2 \x1b \x6d \xee 
\x90 \x3b \xfa \x97 \xd6 \xd9 \xba \xa7 
\xc6 \xbd \x60 \x9a \xd4 \xa2 \x97 \x58 
\x33 \xf7 \xd6 \x72 \xdb \xa7 \x46 \x4d 
\xda \x86 \xd4 \xb3 \xa8 \xc4 \x01 \xad 
\x6a \x55 \x36 \x97 \xe8 \xce \x0c \xcb 
\xeb \x24 \xb3 \xed \x15 \xbc \x70 \x13 
\xac \x05 \x2e \x0a \xb9 \x8c \xc1 \x51 
\x22 \xbe \xa2 \x09 \xfe \x74 \xba \xca 
\x61 \x95 \x11 \x13 \x7a \x3a \x19 \xf3 
\xca \xbd \x7a \xf2 \x49 \xc4 \x04 \xa3 
\x95 \x8f \x41 \x40 \x3b \x1d \xd8 \x2d 
\xfa \x69 \x30 \xcf \x97 \x6c \xe1 \x87 
\x7a \xa7 \x4a \x25 \x12 \xe9 \x32 \xfa 
\x85 \x5c \x33 \x06 \x40 \x89 \xd3 \xdf <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>去掉’\‘，脚本如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> inverse<span class="token punctuation">,</span> long_to_bytes
<span class="token keyword">import</span> gmpy2

n<span class="token operator">=</span><span class="token number">14853081277902411240991719582265437298941606850989432655928075747449227799832389574251190347654658701773951599098366248661597113015221566041305501996451638624389417055956926238595947885740084994809382932733556986107653499144588614105694518150594105711438983069306254763078820574239989253573144558449346681620784979079971559976102366527270867527423001083169127402157598183442923364480383742653117285643026319914244072975557200353546060352744263637867557162046429886176035616570590229646013789737629785488326501654202429466891022723268768841320111152381619260637023031430545168618446134188815113100443559425057634959299</span>
e1<span class="token operator">=</span><span class="token number">2333</span>
e2<span class="token operator">=</span><span class="token number">23333</span>
c1<span class="token operator">=</span><span class="token number">0x477368cbaaf758b22dcad0266f81661c4ca0a2296e7041196cef59617c7924dd371cda412c3c7b7d77767e5f942f9fb5d510acff2d2a953194456583b46eba78d2f31b036900a8958fa23b46d5099763dc9b736f15e005c08f54b15444ca1ef3215eac23d64ff25ff61950e8acb033e542d6f9fd0e20d1a1266666f052ff6839e57d3125850f3b2cf89c5a95d8a0cb72afa5abc632ba3a7b67f01a82b7412343b4de5d9871207f554cf5a30e615d98ea9aa9d5484fe2d97a64e02cd112c0ce679f88394b76850c5c23d58883625d3ffbc7adbca7ceadfa0a3b04740b1b111da830754513112f047072e63060b10a40d99f74b39a603a35bde580b792806f0fd4</span>
c2<span class="token operator">=</span><span class="token number">0x3bead109723769307a3f5ad820e3d475a954a7aba3a7012ae08db40a8580f8720bf31c46b6a63a379829af482e66ff5980e1003059c1c4ea8c75536707d1a09e1997b6dd595b274fa88707be57f0a5dfcbc9dd174a35e78dacf73f7bce42f47bd5c0ffb97c810345cfce69d320c80486e1895459bc9a29f42ffdaa23bc20fd9ef0d7ee263a68bae792485de0a21b6dee903bfa97d6d9baa7c6bd609ad4a2975833f7d672dba7464dda86d4b3a8c401ad6a553697e8ce0ccbeb24b3ed15bc7013ac052e0ab98cc15122bea209fe74baca619511137a3a19f3cabd7af249c404a3958f41403b1dd82dfa6930cf976ce1877aa74a2512e932fa855c33064089d3df</span>

<span class="token comment">#扩展欧几里得算法，求得a与b的系数</span>
<span class="token keyword">def</span> <span class="token function">exgcd</span><span class="token punctuation">(</span>a <span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">#当a % b == 0时表示已求得最大公约数和两个系数</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>b <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment">#返回的第一个参数最大公约数，第二个参数a的系数，第三个参数是b的系数</span>
        <span class="token comment">#这里0和任何数的最大公约数是这个数的本身</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token comment">#将函数返回的结果依次赋值给d, x, y</span>
        d<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y <span class="token operator">=</span> exgcd<span class="token punctuation">(</span>b<span class="token punctuation">,</span> a <span class="token operator">%</span> b<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>d<span class="token punctuation">,</span> y<span class="token punctuation">,</span> x <span class="token operator">-</span> <span class="token punctuation">(</span>a <span class="token operator">//</span> b<span class="token punctuation">)</span> <span class="token operator">*</span> y<span class="token punctuation">)</span>

s <span class="token operator">=</span> exgcd<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> e2<span class="token punctuation">)</span>
s1 <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
s2 <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>

<span class="token comment">#当s是负数的时候，一个数的负数次幂，先计算c的模反元素cr，然后求cr的-s次幂。</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>s1 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    s1 <span class="token operator">=</span> <span class="token operator">-</span>s1
    c1 <span class="token operator">=</span> inverse<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> n<span class="token punctuation">)</span>

<span class="token keyword">elif</span> <span class="token punctuation">(</span>s2 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    s2 <span class="token operator">=</span> <span class="token operator">-</span>s2
    c2 <span class="token operator">=</span> inverse<span class="token punctuation">(</span>c2<span class="token punctuation">,</span> n<span class="token punctuation">)</span>

m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span>s1<span class="token punctuation">,</span>n<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c2<span class="token punctuation">,</span>s2<span class="token punctuation">,</span>n<span class="token punctuation">)</span> <span class="token operator">%</span> n
<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h2 id="MRCTF2020-babyRSA"><a href="#MRCTF2020-babyRSA" class="headerlink" title="[MRCTF2020]babyRSA"></a>[MRCTF2020]babyRSA</h2><p>题目如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sympy
<span class="token keyword">import</span> random
<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> gcd<span class="token punctuation">,</span> invert
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime<span class="token punctuation">,</span> isPrime<span class="token punctuation">,</span> getRandomNBitInteger<span class="token punctuation">,</span> bytes_to_long<span class="token punctuation">,</span> long_to_bytes
<span class="token keyword">from</span> z3 <span class="token keyword">import</span> <span class="token operator">*</span>
flag <span class="token operator">=</span> <span class="token string">b"MRCTF&#123;xxxx&#125;"</span>
base <span class="token operator">=</span> <span class="token number">65537</span>


<span class="token keyword">def</span> <span class="token function">GCD</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">:</span>
    B <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        B <span class="token operator">=</span> gcd<span class="token punctuation">(</span>A<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> B


<span class="token keyword">def</span> <span class="token function">gen_p</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    P <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    P<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        P<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> sympy<span class="token punctuation">.</span>nextprime<span class="token punctuation">(</span>P<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"P_p :"</span><span class="token punctuation">,</span> P<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    n <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        n <span class="token operator">*=</span> P<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
    factor <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> base<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"P_factor :"</span><span class="token punctuation">,</span> factor<span class="token punctuation">)</span>
    <span class="token keyword">return</span> sympy<span class="token punctuation">.</span>nextprime<span class="token punctuation">(</span>p<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">gen_q</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    sub_Q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
    Q_1 <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
    Q_2 <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
    Q <span class="token operator">=</span> sub_Q <span class="token operator">**</span> Q_2 <span class="token operator">%</span> Q_1
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Q_1: "</span><span class="token punctuation">,</span> Q_1<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Q_2: "</span><span class="token punctuation">,</span> Q_2<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"sub_Q: "</span><span class="token punctuation">,</span> sub_Q<span class="token punctuation">)</span>
    <span class="token keyword">return</span> sympy<span class="token punctuation">.</span>nextprime<span class="token punctuation">(</span>Q<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    _E <span class="token operator">=</span> base
    _P <span class="token operator">=</span> gen_p<span class="token punctuation">(</span><span class="token punctuation">)</span>
    _Q <span class="token operator">=</span> gen_q<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">assert</span> <span class="token punctuation">(</span>gcd<span class="token punctuation">(</span>_E<span class="token punctuation">,</span> <span class="token punctuation">(</span>_P <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>_Q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
    _M <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
    _C <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>_M<span class="token punctuation">,</span> _E<span class="token punctuation">,</span> _P <span class="token operator">*</span> _Q<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Ciphertext = "</span><span class="token punctuation">,</span> _C<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
P_p : 206027926847308612719677572554991143421
P_factor : 213671742765908980787116579976289600595864704574134469173111790965233629909513884704158446946409910475727584342641848597858942209151114627306286393390259700239698869487469080881267182803062488043469138252786381822646126962323295676431679988602406971858136496624861228526070581338082202663895710929460596143281673761666804565161435963957655012011051936180536581488499059517946308650135300428672486819645279969693519039407892941672784362868653243632727928279698588177694171797254644864554162848696210763681197279758130811723700154618280764123396312330032986093579531909363210692564988076206283296967165522152288770019720928264542910922693728918198338839
Q_1:  103766439849465588084625049495793857634556517064563488433148224524638105971161051763127718438062862548184814747601299494052813662851459740127499557785398714481909461631996020048315790167967699932967974484481209879664173009585231469785141628982021847883945871201430155071257803163523612863113967495969578605521
Q_2:  151010734276916939790591461278981486442548035032350797306496105136358723586953123484087860176438629843688462671681777513652947555325607414858514566053513243083627810686084890261120641161987614435114887565491866120507844566210561620503961205851409386041194326728437073995372322433035153519757017396063066469743
sub_Q:  168992529793593315757895995101430241994953638330919314800130536809801824971112039572562389449584350643924391984800978193707795909956472992631004290479273525116959461856227262232600089176950810729475058260332177626961286009876630340945093629959302803189668904123890991069113826241497783666995751391361028949651
Ciphertext =  1709187240516367141460862187749451047644094885791761673574674330840842792189795049968394122216854491757922647656430908587059997070488674220330847871811836724541907666983042376216411561826640060734307013458794925025684062804589439843027290282034999617915124231838524593607080377300985152179828199569474241678651559771763395596697140206072537688129790126472053987391538280007082203006348029125729650207661362371936196789562658458778312533505938858959644541233578654340925901963957980047639114170033936570060250438906130591377904182111622236567507022711176457301476543461600524993045300728432815672077399879668276471832
'''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这题的巧妙之处在于，P的生成也使用了RSA的加密算法，两重RSA。突破口在P的n是通过与P相邻的17个素数相乘得到，既然n是容易求得的，那么Φ(n)也是容易生成的，因为Φ(n1 * n2) = (n1 - 1) * (n2 - 1)。通过Φ(n)就可以求得base关于Φ(n)的逆元，通过解密可求得P。Q是容易得到的，再把P和Q放到外重RSA，就可以得到flag。脚本如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sqlmap<span class="token punctuation">.</span>thirdparty<span class="token punctuation">.</span>six
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> gmpy2
<span class="token keyword">import</span> sympy

base <span class="token operator">=</span> <span class="token number">65537</span>
P_p <span class="token operator">=</span> <span class="token number">206027926847308612719677572554991143421</span>
P_factor <span class="token operator">=</span> <span class="token number">213671742765908980787116579976289600595864704574134469173111790965233629909513884704158446946409910475727584342641848597858942209151114627306286393390259700239698869487469080881267182803062488043469138252786381822646126962323295676431679988602406971858136496624861228526070581338082202663895710929460596143281673761666804565161435963957655012011051936180536581488499059517946308650135300428672486819645279969693519039407892941672784362868653243632727928279698588177694171797254644864554162848696210763681197279758130811723700154618280764123396312330032986093579531909363210692564988076206283296967165522152288770019720928264542910922693728918198338839</span>
Q_1 <span class="token operator">=</span> <span class="token number">103766439849465588084625049495793857634556517064563488433148224524638105971161051763127718438062862548184814747601299494052813662851459740127499557785398714481909461631996020048315790167967699932967974484481209879664173009585231469785141628982021847883945871201430155071257803163523612863113967495969578605521</span>
Q_2 <span class="token operator">=</span> <span class="token number">151010734276916939790591461278981486442548035032350797306496105136358723586953123484087860176438629843688462671681777513652947555325607414858514566053513243083627810686084890261120641161987614435114887565491866120507844566210561620503961205851409386041194326728437073995372322433035153519757017396063066469743</span>
sub_Q <span class="token operator">=</span> <span class="token number">168992529793593315757895995101430241994953638330919314800130536809801824971112039572562389449584350643924391984800978193707795909956472992631004290479273525116959461856227262232600089176950810729475058260332177626961286009876630340945093629959302803189668904123890991069113826241497783666995751391361028949651</span>
Ciphertext <span class="token operator">=</span> <span class="token number">1709187240516367141460862187749451047644094885791761673574674330840842792189795049968394122216854491757922647656430908587059997070488674220330847871811836724541907666983042376216411561826640060734307013458794925025684062804589439843027290282034999617915124231838524593607080377300985152179828199569474241678651559771763395596697140206072537688129790126472053987391538280007082203006348029125729650207661362371936196789562658458778312533505938858959644541233578654340925901963957980047639114170033936570060250438906130591377904182111622236567507022711176457301476543461600524993045300728432815672077399879668276471832</span>

q <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>next_prime<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>sub_Q<span class="token punctuation">,</span> Q_2<span class="token punctuation">,</span> Q_1<span class="token punctuation">)</span><span class="token punctuation">)</span>

p <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    P_p <span class="token operator">=</span> sympy<span class="token punctuation">.</span>prevprime<span class="token punctuation">(</span>P_p<span class="token punctuation">)</span>
p<span class="token punctuation">.</span>append<span class="token punctuation">(</span>P_p<span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    p<span class="token punctuation">.</span>append<span class="token punctuation">(</span>sympy<span class="token punctuation">.</span>nextprime<span class="token punctuation">(</span>p<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

n <span class="token operator">=</span> <span class="token number">1</span>
phi_n <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    n <span class="token operator">*=</span> p<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    phi_n <span class="token operator">*=</span> <span class="token punctuation">(</span>p<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
based <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>base<span class="token punctuation">,</span> phi_n<span class="token punctuation">)</span>
_p <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>P_factor<span class="token punctuation">,</span> based<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
p <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>next_prime<span class="token punctuation">(</span>_p<span class="token punctuation">)</span>
d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>base<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>Ciphertext<span class="token punctuation">,</span> d<span class="token punctuation">,</span> p <span class="token operator">*</span> q<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h2 id="网鼎杯-2020-青龙组-you-raise-me-up"><a href="#网鼎杯-2020-青龙组-you-raise-me-up" class="headerlink" title="[网鼎杯 2020 青龙组]you_raise_me_up"></a>[网鼎杯 2020 青龙组]you_raise_me_up</h2><p>题目如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> random

n <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token number">512</span>
m <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">1</span>
c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token string">'m = '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token string">'c = '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>

<span class="token comment"># m = 391190709124527428959489662565274039318305952172936859403855079581402770986890308469084735451207885386318986881041563704825943945069343345307381099559075</span>
<span class="token comment"># c = 6665851394203214245856789450723658632520816791621796775909766895233000234023642878786025644953797995373211308485605397024123180085924117610802485972584499</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>看起来不难，直接爆破指数，但是不知道数的范围，而且随着指数的增大运算的复杂度越高，看看大佬的博客里说的啥：</p>
<p><img "" class="lazyload placeholder" data-original="/2021/08/17/BUUCTF-Crypto%E7%B3%BB%E5%88%97-81-96-WP/Post10_image6.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif"></p>
<p>脚本如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> sympy

m <span class="token operator">=</span> <span class="token number">391190709124527428959489662565274039318305952172936859403855079581402770986890308469084735451207885386318986881041563704825943945069343345307381099559075</span>
c <span class="token operator">=</span> <span class="token number">6665851394203214245856789450723658632520816791621796775909766895233000234023642878786025644953797995373211308485605397024123180085924117610802485972584499</span>
n <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token number">512</span>

flag <span class="token operator">=</span> sympy<span class="token punctuation">.</span>discrete_log<span class="token punctuation">(</span>n<span class="token punctuation">,</span> c<span class="token punctuation">,</span> m<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>运行脚本可得flag。</p>
<hr>
<h2 id="BJDCTF2020-Polybius"><a href="#BJDCTF2020-Polybius" class="headerlink" title="[BJDCTF2020]Polybius"></a>[BJDCTF2020]Polybius</h2><p>题目如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">密文：ouauuuoooeeaaiaeauieuooeeiea
hint：VGhlIGxlbmd0aCBvZiB0aGlzIHBsYWludGV4dDogMTQ<span class="token operator">=</span>
flag<span class="token punctuation">:</span>解出明文后，请加上BJD<span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>先看看hint里面说的啥：</p>
<p>The length of this plaintext: 14</p>
<p>看了下题目标题“polybius”，上网查了一下发现是一种古典棋盘密码，利比奥斯方阵密码。</p>
<p>加密原理是先设定五位的编码表，然后将里面的5个字符按照规定的顺序排列，形成5*5的矩阵，其中字符i和j在矩阵同一个位置上。将明文中的字符映射到编码表中，密文就是字符所在的横坐标与纵坐标。</p>
<p>假设明文序列为 <code>attack at once</code>  ，使用一套秘密混杂的字母表填满波利比奥斯方阵，如下</p>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="center">A</th>
<th align="center">D</th>
<th align="center">F</th>
<th align="center">G</th>
<th align="center">X</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><strong>A</strong></td>
<td align="center">b</td>
<td align="center">t</td>
<td align="center">a</td>
<td align="center">l</td>
<td align="center">p</td>
</tr>
<tr>
<td align="center"><strong>D</strong></td>
<td align="center">d</td>
<td align="center">h</td>
<td align="center">o</td>
<td align="center">z</td>
<td align="center">k</td>
</tr>
<tr>
<td align="center"><strong>F</strong></td>
<td align="center">q</td>
<td align="center">f</td>
<td align="center">v</td>
<td align="center">s</td>
<td align="center">n</td>
</tr>
<tr>
<td align="center"><strong>G</strong></td>
<td align="center">g</td>
<td align="center">j</td>
<td align="center">c</td>
<td align="center">u</td>
<td align="center">x</td>
</tr>
<tr>
<td align="center"><strong>X</strong></td>
<td align="center">m</td>
<td align="center">r</td>
<td align="center">e</td>
<td align="center">w</td>
<td align="center">y</td>
</tr>
</tbody></table>
<p>根据上面的Polybius方阵将对应的明文进行加密。其中，A,D,F,G,X也可以用数字1,2,3,4,5来代替，这样密文就成了：</p>
<table>
<thead>
<tr>
<th>明文</th>
<th>A</th>
<th>T</th>
<th>T</th>
<th>A</th>
<th>C</th>
<th>K</th>
<th>A</th>
<th>T</th>
<th>O</th>
<th>N</th>
<th>C</th>
<th>E</th>
</tr>
</thead>
<tbody><tr>
<td>密文</td>
<td>AF</td>
<td>AD</td>
<td>AD</td>
<td>AF</td>
<td>GF</td>
<td>DX</td>
<td>AF</td>
<td>AD</td>
<td>DF</td>
<td>FX</td>
<td>GF</td>
<td>XF</td>
</tr>
<tr>
<td></td>
<td>13</td>
<td>12</td>
<td>12</td>
<td>13</td>
<td>43</td>
<td>25</td>
<td>13</td>
<td>12</td>
<td>23</td>
<td>35</td>
<td>43</td>
<td>53</td>
</tr>
</tbody></table>
<p>解密矩阵：</p>
<p><img "" class="lazyload placeholder" data-original="/2021/08/17/BUUCTF-Crypto%E7%B3%BB%E5%88%97-81-96-WP/Post10_image7.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif"></p>
<p>脚本如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> itertools

cipher <span class="token operator">=</span> <span class="token string">"ouauuuoooeeaaiaeauieuooeeiea"</span>
base <span class="token operator">=</span> <span class="token string">"aeoiu"</span>
baselist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
sumlist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> itertools<span class="token punctuation">.</span>permutations<span class="token punctuation">(</span>base<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    baselist<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> baselist<span class="token punctuation">:</span>
    tmp <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> cipher<span class="token punctuation">:</span>
        tmp <span class="token operator">+=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">.</span>index<span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
    sumlist<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tmp<span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> sumlist<span class="token punctuation">:</span>
    re <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        ans <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>i<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">5</span> <span class="token operator">+</span> <span class="token builtin">int</span><span class="token punctuation">(</span>i<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">96</span>  <span class="token comment">#对应到解密表，表示在解密表中的第几个字符</span>
        <span class="token keyword">if</span> ans <span class="token operator">></span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'i'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            ans <span class="token operator">+=</span> <span class="token number">1</span>
        re <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>re<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>运行脚本对结果中的字符串进行筛选就可以得到flag。</p>
<hr>
<h2 id="WUSTCTF2020-情书"><a href="#WUSTCTF2020-情书" class="headerlink" title="[WUSTCTF2020]情书"></a>[WUSTCTF2020]情书</h2><p>题目如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">Premise<span class="token punctuation">:</span> Enumerate the alphabet by <span class="token number">0</span>、<span class="token number">1</span>、<span class="token number">2</span>、<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>  、<span class="token number">25</span>
Using the RSA system 
Encryption<span class="token punctuation">:</span><span class="token number">0156</span> <span class="token number">0821</span> <span class="token number">1616</span> <span class="token number">0041</span> <span class="token number">0140</span> <span class="token number">2130</span> <span class="token number">1616</span> <span class="token number">0793</span>
Public Key<span class="token punctuation">:</span><span class="token number">2537</span> <span class="token keyword">and</span> <span class="token number">13</span>
Private Key<span class="token punctuation">:</span><span class="token number">2537</span> <span class="token keyword">and</span> <span class="token number">937</span>

flag<span class="token punctuation">:</span> wctf2020<span class="token punctuation">&#123;</span>Decryption<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>前提中的26个数字很容易想到26个字母，题目也给出了公钥和私钥，用RSA基本的解密方程解密后得到的数字再映射到26字母表中就可以得到flag。脚本如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gmpy2
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>

base <span class="token operator">=</span> <span class="token string">"abcdefghijklmnopqrstuvwxyz"</span>
c <span class="token operator">=</span> <span class="token string">"0156 0821 1616 0041 0140 2130 1616 0793"</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span>
d <span class="token operator">=</span> <span class="token number">937</span>
e <span class="token operator">=</span> <span class="token number">13</span>
n <span class="token operator">=</span> <span class="token number">2537</span>

flag <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> c<span class="token punctuation">:</span>
    flag <span class="token operator">+=</span> base<span class="token punctuation">[</span><span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h2 id="UTCTF2020-basic-crypto"><a href="#UTCTF2020-basic-crypto" class="headerlink" title="[UTCTF2020]basic-crypto"></a>[UTCTF2020]basic-crypto</h2><p>题目如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">01010101</span> <span class="token number">01101000</span> <span class="token number">00101101</span> <span class="token number">01101111</span> <span class="token number">01101000</span> <span class="token number">00101100</span> <span class="token number">00100000</span> <span class="token number">01101100</span> <span class="token number">01101111</span> <span class="token number">01101111</span> <span class="token number">01101011</span> <span class="token number">01110011</span> <span class="token number">00100000</span> <span class="token number">01101100</span> <span class="token number">01101001</span> <span class="token number">01101011</span> <span class="token number">01100101</span> <span class="token number">00100000</span> <span class="token number">01110111</span> <span class="token number">01100101</span> <span class="token number">00100000</span> <span class="token number">01101000</span> <span class="token number">01100001</span> <span class="token number">01110110</span> <span class="token number">01100101</span> <span class="token number">00100000</span> <span class="token number">01100001</span> <span class="token number">01101110</span> <span class="token number">01101111</span> <span class="token number">01110100</span> <span class="token number">01101000</span> <span class="token number">01100101</span> <span class="token number">01110010</span> <span class="token number">00100000</span> <span class="token number">01100010</span> <span class="token number">01101100</span> <span class="token number">01101111</span> <span class="token number">01100011</span> <span class="token number">01101011</span> <span class="token number">00100000</span> <span class="token number">01101111</span> <span class="token number">01100110</span> <span class="token number">00100000</span> <span class="token number">01110100</span> <span class="token number">01100101</span> <span class="token number">01111000</span> <span class="token number">01110100</span> <span class="token number">00101100</span> <span class="token number">00100000</span> <span class="token number">01110111</span> <span class="token number">01101001</span> <span class="token number">01110100</span> <span class="token number">01101000</span> <span class="token number">00100000</span> <span class="token number">01110011</span> <span class="token number">01101111</span> <span class="token number">01101101</span> <span class="token number">01100101</span> <span class="token number">00100000</span> <span class="token number">01110011</span> <span class="token number">01101111</span> <span class="token number">01110010</span> <span class="token number">01110100</span> <span class="token number">00100000</span> <span class="token number">01101111</span> <span class="token number">01100110</span> <span class="token number">00100000</span> <span class="token number">01110011</span> <span class="token number">01110000</span> <span class="token number">01100101</span> <span class="token number">01100011</span> <span class="token number">01101001</span> <span class="token number">01100001</span> <span class="token number">01101100</span> <span class="token number">00100000</span> <span class="token number">01100101</span> <span class="token number">01101110</span> <span class="token number">01100011</span> <span class="token number">01101111</span> <span class="token number">01100100</span> <span class="token number">01101001</span> <span class="token number">01101110</span> <span class="token number">01100111</span> <span class="token number">00101110</span> <span class="token number">00100000</span> <span class="token number">01000011</span> <span class="token number">01100001</span> <span class="token number">01101110</span> <span class="token number">00100000</span> <span class="token number">01111001</span> <span class="token number">01101111</span> <span class="token number">01110101</span> <span class="token number">00100000</span> <span class="token number">01100110</span> <span class="token number">01101001</span> <span class="token number">01100111</span> <span class="token number">01110101</span> <span class="token number">01110010</span> <span class="token number">01100101</span> <span class="token number">00100000</span> <span class="token number">01101111</span> <span class="token number">01110101</span> <span class="token number">01110100</span> <span class="token number">00100000</span> <span class="token number">01110111</span> <span class="token number">01101000</span> <span class="token number">01100001</span> <span class="token number">01110100</span> <span class="token number">00100000</span> <span class="token number">01110100</span> <span class="token number">01101000</span> <span class="token number">01101001</span> <span class="token number">01110011</span> <span class="token number">00100000</span> <span class="token number">01100101</span> <span class="token number">01101110</span> <span class="token number">01100011</span> <span class="token number">01101111</span> <span class="token number">01100100</span> <span class="token number">01101001</span> <span class="token number">01101110</span> <span class="token number">01100111</span> <span class="token number">00100000</span> <span class="token number">01101001</span> <span class="token number">01110011</span> <span class="token number">00111111</span> <span class="token number">00100000</span> <span class="token number">00101000</span> <span class="token number">01101000</span> <span class="token number">01101001</span> <span class="token number">01101110</span> <span class="token number">01110100</span> <span class="token number">00111010</span> <span class="token number">00100000</span> <span class="token number">01101001</span> <span class="token number">01100110</span> <span class="token number">00100000</span> <span class="token number">01111001</span> <span class="token number">01101111</span> <span class="token number">01110101</span> <span class="token number">00100000</span> <span class="token number">01101100</span> <span class="token number">01101111</span> <span class="token number">01101111</span> <span class="token number">01101011</span> <span class="token number">00100000</span> <span class="token number">01100011</span> <span class="token number">01100001</span> <span class="token number">01110010</span> <span class="token number">01100101</span> <span class="token number">01100110</span> <span class="token number">01110101</span> <span class="token number">01101100</span> <span class="token number">01101100</span> <span class="token number">01111001</span> <span class="token number">00101100</span> <span class="token number">00100000</span> <span class="token number">01111001</span> <span class="token number">01101111</span> <span class="token number">01110101</span> <span class="token number">00100111</span> <span class="token number">01101100</span> <span class="token number">01101100</span> <span class="token number">00100000</span> <span class="token number">01101110</span> <span class="token number">01101111</span> <span class="token number">01110100</span> <span class="token number">01101001</span> <span class="token number">01100011</span> <span class="token number">01100101</span> <span class="token number">00100000</span> <span class="token number">01110100</span> <span class="token number">01101000</span> <span class="token number">01100001</span> <span class="token number">01110100</span> <span class="token number">00100000</span> <span class="token number">01110100</span> <span class="token number">01101000</span> <span class="token number">01100101</span> <span class="token number">01110010</span> <span class="token number">01100101</span> <span class="token number">00100000</span> <span class="token number">01101111</span> <span class="token number">01101110</span> <span class="token number">01101100</span> <span class="token number">01111001</span> <span class="token number">00100000</span> <span class="token number">01100011</span> <span class="token number">01101000</span> <span class="token number">01100001</span> <span class="token number">01110010</span> <span class="token number">01100001</span> <span class="token number">01100011</span> <span class="token number">01110100</span> <span class="token number">01100101</span> <span class="token number">01110010</span> <span class="token number">01110011</span> <span class="token number">00100000</span> <span class="token number">01110000</span> <span class="token number">01110010</span> <span class="token number">01100101</span> <span class="token number">01110011</span> <span class="token number">01100101</span> <span class="token number">01101110</span> <span class="token number">01110100</span> <span class="token number">00100000</span> <span class="token number">01100001</span> <span class="token number">01110010</span> <span class="token number">01100101</span> <span class="token number">00100000</span> <span class="token number">01000001</span> <span class="token number">00101101</span> <span class="token number">01011010</span> <span class="token number">00101100</span> <span class="token number">00100000</span> <span class="token number">01100001</span> <span class="token number">00101101</span> <span class="token number">01111010</span> <span class="token number">00101100</span> <span class="token number">00100000</span> <span class="token number">00110000</span> <span class="token number">00101101</span> <span class="token number">00111001</span> <span class="token number">00101100</span> <span class="token number">00100000</span> <span class="token number">01100001</span> <span class="token number">01101110</span> <span class="token number">01100100</span> <span class="token number">00100000</span> <span class="token number">01110011</span> <span class="token number">01101111</span> <span class="token number">01101101</span> <span class="token number">01100101</span> <span class="token number">01110100</span> <span class="token number">01101001</span> <span class="token number">01101101</span> <span class="token number">01100101</span> <span class="token number">01110011</span> <span class="token number">00100000</span> <span class="token number">00101111</span> <span class="token number">00100000</span> <span class="token number">01100001</span> <span class="token number">01101110</span> <span class="token number">01100100</span> <span class="token number">00100000</span> <span class="token number">00101011</span> <span class="token number">00101110</span> <span class="token number">00100000</span> <span class="token number">01010011</span> <span class="token number">01100101</span> <span class="token number">01100101</span> <span class="token number">00100000</span> <span class="token number">01101001</span> <span class="token number">01100110</span> <span class="token number">00100000</span> <span class="token number">01111001</span> <span class="token number">01101111</span> <span class="token number">01110101</span> <span class="token number">00100000</span> <span class="token number">01100011</span> <span class="token number">01100001</span> <span class="token number">01101110</span> <span class="token number">00100000</span> <span class="token number">01100110</span> <span class="token number">01101001</span> <span class="token number">01101110</span> <span class="token number">01100100</span> <span class="token number">00100000</span> <span class="token number">01100001</span> <span class="token number">01101110</span> <span class="token number">00100000</span> <span class="token number">01100101</span> <span class="token number">01101110</span> <span class="token number">01100011</span> <span class="token number">01101111</span> <span class="token number">01100100</span> <span class="token number">01101001</span> <span class="token number">01101110</span> <span class="token number">01100111</span> <span class="token number">00100000</span> <span class="token number">01110100</span> <span class="token number">01101000</span> <span class="token number">01100001</span> <span class="token number">01110100</span> <span class="token number">00100000</span> <span class="token number">01101100</span> <span class="token number">01101111</span> <span class="token number">01101111</span> <span class="token number">01101011</span> <span class="token number">01110011</span> <span class="token number">00100000</span> <span class="token number">01101100</span> <span class="token number">01101001</span> <span class="token number">01101011</span> <span class="token number">01100101</span> <span class="token number">00100000</span> <span class="token number">01110100</span> <span class="token number">01101000</span> <span class="token number">01101001</span> <span class="token number">01110011</span> <span class="token number">00100000</span> <span class="token number">01101111</span> <span class="token number">01101110</span> <span class="token number">01100101</span> <span class="token number">00101110</span> <span class="token number">00101001</span> <span class="token number">00001010</span> <span class="token number">01010100</span> <span class="token number">01101101</span> <span class="token number">01010110</span> <span class="token number">00110011</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01001110</span> <span class="token number">01101111</span> <span class="token number">01011001</span> <span class="token number">01010111</span> <span class="token number">01111000</span> <span class="token number">01110011</span> <span class="token number">01011010</span> <span class="token number">01010111</span> <span class="token number">00110101</span> <span class="token number">01101110</span> <span class="token number">01011010</span> <span class="token number">01010011</span> <span class="token number">01000101</span> <span class="token number">01100111</span> <span class="token number">01010001</span> <span class="token number">00110010</span> <span class="token number">01000110</span> <span class="token number">01110101</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01101100</span> <span class="token number">01110110</span> <span class="token number">01100100</span> <span class="token number">01010011</span> <span class="token number">01000010</span> <span class="token number">01101101</span> <span class="token number">01100001</span> <span class="token number">01010111</span> <span class="token number">01100100</span> <span class="token number">00110001</span> <span class="token number">01100011</span> <span class="token number">01101101</span> <span class="token number">01010101</span> <span class="token number">01100111</span> <span class="token number">01100010</span> <span class="token number">00110011</span> <span class="token number">01010110</span> <span class="token number">00110000</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01100100</span> <span class="token number">01101111</span> <span class="token number">01011001</span> <span class="token number">01011000</span> <span class="token number">01010001</span> <span class="token number">01101110</span> <span class="token number">01100011</span> <span class="token number">01111001</span> <span class="token number">01000010</span> <span class="token number">01101110</span> <span class="token number">01100010</span> <span class="token number">00110010</span> <span class="token number">01101100</span> <span class="token number">01110101</span> <span class="token number">01011010</span> <span class="token number">01111001</span> <span class="token number">01000010</span> <span class="token number">01110110</span> <span class="token number">01100010</span> <span class="token number">01101001</span> <span class="token number">01000010</span> <span class="token number">01101111</span> <span class="token number">01011010</span> <span class="token number">01011000</span> <span class="token number">01001010</span> <span class="token number">01101100</span> <span class="token number">01010000</span> <span class="token number">01111001</span> <span class="token number">01000010</span> <span class="token number">01001010</span> <span class="token number">01100100</span> <span class="token number">01000011</span> <span class="token number">01000010</span> <span class="token number">01110011</span> <span class="token number">01100010</span> <span class="token number">00110010</span> <span class="token number">00111001</span> <span class="token number">01110010</span> <span class="token number">01100011</span> <span class="token number">01111001</span> <span class="token number">01000010</span> <span class="token number">01110011</span> <span class="token number">01100001</span> <span class="token number">01010111</span> <span class="token number">01110100</span> <span class="token number">01101100</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01010010</span> <span class="token number">01101111</span> <span class="token number">01011010</span> <span class="token number">01010011</span> <span class="token number">01000010</span> <span class="token number">01110011</span> <span class="token number">01011010</span> <span class="token number">01011000</span> <span class="token number">01010010</span> <span class="token number">00110000</span> <span class="token number">01011010</span> <span class="token number">01011000</span> <span class="token number">01001010</span> <span class="token number">01111010</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01000110</span> <span class="token number">01111001</span> <span class="token number">01011010</span> <span class="token number">01010011</span> <span class="token number">01000010</span> <span class="token number">01111010</span> <span class="token number">01100001</span> <span class="token number">01000111</span> <span class="token number">01101100</span> <span class="token number">01101101</span> <span class="token number">01100100</span> <span class="token number">01000111</span> <span class="token number">01010110</span> <span class="token number">01101011</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01001010</span> <span class="token number">00110101</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01001110</span> <span class="token number">01110110</span> <span class="token number">01100010</span> <span class="token number">01010111</span> <span class="token number">01010101</span> <span class="token number">01100111</span> <span class="token number">01011001</span> <span class="token number">00110010</span> <span class="token number">00111001</span> <span class="token number">01110101</span> <span class="token number">01100011</span> <span class="token number">00110011</span> <span class="token number">01010010</span> <span class="token number">01101000</span> <span class="token number">01100010</span> <span class="token number">01101110</span> <span class="token number">01010001</span> <span class="token number">01110101</span> <span class="token number">01001001</span> <span class="token number">01000011</span> <span class="token number">01101000</span> <span class="token number">01101111</span> <span class="token number">01100001</span> <span class="token number">01010111</span> <span class="token number">00110101</span> <span class="token number">00110000</span> <span class="token number">01001111</span> <span class="token number">01101001</span> <span class="token number">01000010</span> <span class="token number">00110101</span> <span class="token number">01100010</span> <span class="token number">00110011</span> <span class="token number">01010101</span> <span class="token number">01100111</span> <span class="token number">01100010</span> <span class="token number">01010111</span> <span class="token number">01101100</span> <span class="token number">01101110</span> <span class="token number">01100001</span> <span class="token number">01001000</span> <span class="token number">01010001</span> <span class="token number">01100111</span> <span class="token number">01100100</span> <span class="token number">00110010</span> <span class="token number">01000110</span> <span class="token number">01110101</span> <span class="token number">01100100</span> <span class="token number">01000011</span> <span class="token number">01000010</span> <span class="token number">00110000</span> <span class="token number">01100010</span> <span class="token number">01111001</span> <span class="token number">01000010</span> <span class="token number">01111010</span> <span class="token number">01100100</span> <span class="token number">01000111</span> <span class="token number">01000110</span> <span class="token number">01111001</span> <span class="token number">01100100</span> <span class="token number">01000011</span> <span class="token number">01000010</span> <span class="token number">01110011</span> <span class="token number">01100010</span> <span class="token number">00110010</span> <span class="token number">00111001</span> <span class="token number">01110010</span> <span class="token number">01100001</span> <span class="token number">01010111</span> <span class="token number">00110101</span> <span class="token number">01101110</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01010110</span> <span class="token number">01110111</span> <span class="token number">01001001</span> <span class="token number">01000110</span> <span class="token number">01001010</span> <span class="token number">01110110</span> <span class="token number">01100010</span> <span class="token number">01010111</span> <span class="token number">01000110</span> <span class="token number">01110101</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01000010</span> <span class="token number">01101100</span> <span class="token number">01100010</span> <span class="token number">00110011</span> <span class="token number">01000010</span> <span class="token number">01110011</span> <span class="token number">01011010</span> <span class="token number">01010011</span> <span class="token number">01101011</span> <span class="token number">01110101</span> <span class="token number">01000011</span> <span class="token number">01101101</span> <span class="token number">01110100</span> <span class="token number">00110010</span> <span class="token number">01011001</span> <span class="token number">01101110</span> <span class="token number">01001110</span> <span class="token number">01111000</span> <span class="token number">01100011</span> <span class="token number">01101101</span> <span class="token number">01010001</span> <span class="token number">01110011</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01101100</span> <span class="token number">00110101</span> <span class="token number">01011010</span> <span class="token number">01010011</span> <span class="token number">01100100</span> <span class="token number">01101001</span> <span class="token number">01100010</span> <span class="token number">01111001</span> <span class="token number">01000010</span> <span class="token number">01110010</span> <span class="token number">01100100</span> <span class="token number">01101110</span> <span class="token number">01100100</span> <span class="token number">00110101</span> <span class="token number">01011001</span> <span class="token number">00110010</span> <span class="token number">01010001</span> <span class="token number">01100111</span> <span class="token number">01011010</span> <span class="token number">01001000</span> <span class="token number">01001010</span> <span class="token number">01110110</span> <span class="token number">01011001</span> <span class="token number">01101101</span> <span class="token number">00111000</span> <span class="token number">01101000</span> <span class="token number">01001001</span> <span class="token number">01000110</span> <span class="token number">01101000</span> <span class="token number">00110101</span> <span class="token number">01011010</span> <span class="token number">01111001</span> <span class="token number">01000010</span> <span class="token number">01110111</span> <span class="token number">01100101</span> <span class="token number">01010111</span> <span class="token number">01001001</span> <span class="token number">01100111</span> <span class="token number">01011010</span> <span class="token number">01001000</span> <span class="token number">01001010</span> <span class="token number">01110110</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01000010</span> <span class="token number">01111010</span> <span class="token number">01100101</span> <span class="token number">01000111</span> <span class="token number">01110100</span> <span class="token number">00110010</span> <span class="token number">01001001</span> <span class="token number">01000011</span> <span class="token number">01101000</span> <span class="token number">01110010</span> <span class="token number">01100101</span> <span class="token number">01000111</span> <span class="token number">00110100</span> <span class="token number">01100111</span> <span class="token number">01100100</span> <span class="token number">00110010</span> <span class="token number">01110100</span> <span class="token number">01110000</span> <span class="token number">01100010</span> <span class="token number">01000111</span> <span class="token number">00111000</span> <span class="token number">01100111</span> <span class="token number">01011010</span> <span class="token number">01001000</span> <span class="token number">01001010</span> <span class="token number">01110110</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01001010</span> <span class="token number">01110010</span> <span class="token number">01011001</span> <span class="token number">01101101</span> <span class="token number">00110101</span> <span class="token number">01110110</span> <span class="token number">01011001</span> <span class="token number">00110010</span> <span class="token number">01010001</span> <span class="token number">01110101</span> <span class="token number">01001100</span> <span class="token number">01101001</span> <span class="token number">00110100</span> <span class="token number">01110000</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01110000</span> <span class="token number">01110010</span> <span class="token number">01011001</span> <span class="token number">01101101</span> <span class="token number">01010001</span> <span class="token number">00110110</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01110011</span> <span class="token number">01100111</span> <span class="token number">01011001</span> <span class="token number">00110010</span> <span class="token number">01010110</span> <span class="token number">01110011</span> <span class="token number">01011001</span> <span class="token number">00110010</span> <span class="token number">01010010</span> <span class="token number">01111010</span> <span class="token number">01011010</span> <span class="token number">01000111</span> <span class="token number">01010110</span> <span class="token number">01101011</span> <span class="token number">01100011</span> <span class="token number">00110011</span> <span class="token number">01101100</span> <span class="token number">00110100</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">00110001</span> <span class="token number">01111010</span> <span class="token number">01100101</span> <span class="token number">01101110</span> <span class="token number">01001010</span> <span class="token number">01110110</span> <span class="token number">01011001</span> <span class="token number">01101001</span> <span class="token number">00110100</span> <span class="token number">01100111</span> <span class="token number">01010101</span> <span class="token number">00110011</span> <span class="token number">01100111</span> <span class="token number">01100111</span> <span class="token number">01011010</span> <span class="token number">01001000</span> <span class="token number">01001010</span> <span class="token number">01110110</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01000010</span> <span class="token number">00110101</span> <span class="token number">01100100</span> <span class="token number">01101110</span> <span class="token number">01011010</span> <span class="token number">00110101</span> <span class="token number">01011010</span> <span class="token number">00110011</span> <span class="token number">01001110</span> <span class="token number">00110100</span> <span class="token number">01100011</span> <span class="token number">01010011</span> <span class="token number">01000010</span> <span class="token number">01101011</span> <span class="token number">01100010</span> <span class="token number">00110010</span> <span class="token number">01101000</span> <span class="token number">01101011</span> <span class="token number">01001100</span> <span class="token number">01000011</span> <span class="token number">01000010</span> <span class="token number">01010100</span> <span class="token number">01001010</span> <span class="token number">00110010</span> <span class="token number">01011010</span> <span class="token number">01110110</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01010010</span> <span class="token number">01110010</span> <span class="token number">01100100</span> <span class="token number">01010111</span> <span class="token number">00111001</span> <span class="token number">00110100</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01100100</span> <span class="token number">01110000</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01100100</span> <span class="token number">01110110</span> <span class="token number">01011001</span> <span class="token number">00110010</span> <span class="token number">01001110</span> <span class="token number">01110010</span> <span class="token number">01100011</span> <span class="token number">01010111</span> <span class="token number">00111000</span> <span class="token number">01100111</span> <span class="token number">01100001</span> <span class="token number">00110011</span> <span class="token number">01101000</span> <span class="token number">01110101</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01001010</span> <span class="token number">01110110</span> <span class="token number">01100101</span> <span class="token number">01101110</span> <span class="token number">01011010</span> <span class="token number">01110010</span> <span class="token number">01100010</span> <span class="token number">01010111</span> <span class="token number">00111001</span> <span class="token number">01110101</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">00111001</span> <span class="token number">01101101</span> <span class="token number">01100010</span> <span class="token number">00110010</span> <span class="token number">01001010</span> <span class="token number">01110000</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01110100</span> <span class="token number">00110010</span> <span class="token number">01100101</span> <span class="token number">01101110</span> <span class="token number">01001010</span> <span class="token number">01110010</span> <span class="token number">01100010</span> <span class="token number">01000111</span> <span class="token number">00111001</span> <span class="token number">01101011</span> <span class="token number">01100011</span> <span class="token number">00110010</span> <span class="token number">00110000</span> <span class="token number">01100111</span> <span class="token number">01100010</span> <span class="token number">01011000</span> <span class="token number">01001010</span> <span class="token number">01110010</span> <span class="token number">01011001</span> <span class="token number">01101101</span> <span class="token number">01110100</span> <span class="token number">01110100</span> <span class="token number">01011010</span> <span class="token number">01000111</span> <span class="token number">00111001</span> <span class="token number">01101001</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01100100</span> <span class="token number">01111010</span> <span class="token number">01011010</span> <span class="token number">01001000</span> <span class="token number">01001001</span> <span class="token number">01100111</span> <span class="token number">01100001</span> <span class="token number">01111001</span> <span class="token number">01000010</span> <span class="token number">01110100</span> <span class="token number">01100101</span> <span class="token number">01010111</span> <span class="token number">01001010</span> <span class="token number">01101001</span> <span class="token number">01100010</span> <span class="token number">00110010</span> <span class="token number">01001110</span> <span class="token number">00110110</span> <span class="token number">01100101</span> <span class="token number">01011000</span> <span class="token number">01101000</span> <span class="token number">01110101</span> <span class="token number">01100010</span> <span class="token number">00110011</span> <span class="token number">01101000</span> <span class="token number">01110100</span> <span class="token number">01100010</span> <span class="token number">01111001</span> <span class="token number">01000010</span> <span class="token number">01101011</span> <span class="token number">01100101</span> <span class="token number">01010011</span> <span class="token number">01000010</span> <span class="token number">01110010</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">00110101</span> <span class="token number">01111010</span> <span class="token number">01100011</span> <span class="token number">01001000</span> <span class="token number">01000010</span> <span class="token number">01110110</span> <span class="token number">01011001</span> <span class="token number">01101101</span> <span class="token number">00111001</span> <span class="token number">00110100</span> <span class="token number">01011010</span> <span class="token number">01000011</span> <span class="token number">01000010</span> <span class="token number">01110100</span> <span class="token number">01100011</span> <span class="token number">01101101</span> <span class="token number">01110100</span> <span class="token number">01101001</span> <span class="token number">01100001</span> <span class="token number">00110010</span> <span class="token number">00110001</span> <span class="token number">01101011</span> <span class="token number">01100010</span> <span class="token number">00110010</span> <span class="token number">01001001</span> <span class="token number">01100111</span> <span class="token number">01001100</span> <span class="token number">01010011</span> <span class="token number">01000010</span> <span class="token number">00110001</span> <span class="token number">01100101</span> <span class="token number">01001000</span> <span class="token number">01101100</span> <span class="token number">01101110</span> <span class="token number">01100101</span> <span class="token number">01000011</span> <span class="token number">01000010</span> <span class="token number">01110010</span> <span class="token number">01011001</span> <span class="token number">01111001</span> <span class="token number">01000010</span> <span class="token number">01110010</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01001110</span> <span class="token number">01101100</span> <span class="token number">01100010</span> <span class="token number">01000111</span> <span class="token number">01001110</span> <span class="token number">01101011</span> <span class="token number">01100011</span> <span class="token number">00110010</span> <span class="token number">01010010</span> <span class="token number">01101100</span> <span class="token number">01011010</span> <span class="token number">01001000</span> <span class="token number">01001110</span> <span class="token number">00110101</span> <span class="token number">01100101</span> <span class="token number">01000011</span> <span class="token number">01000010</span> <span class="token number">01110100</span> <span class="token number">01100011</span> <span class="token number">00110011</span> <span class="token number">01110000</span> <span class="token number">01111001</span> <span class="token number">01100010</span> <span class="token number">00110010</span> <span class="token number">01001001</span> <span class="token number">01110101</span> <span class="token number">01001001</span> <span class="token number">01000101</span> <span class="token number">00110001</span> <span class="token number">01110010</span> <span class="token number">01100101</span> <span class="token number">01000011</span> <span class="token number">01000010</span> <span class="token number">01110000</span> <span class="token number">01100101</span> <span class="token number">01010111</span> <span class="token number">01010101</span> <span class="token number">01100111</span> <span class="token number">01100011</span> <span class="token number">01001000</span> <span class="token number">01001110</span> <span class="token number">00110100</span> <span class="token number">01100010</span> <span class="token number">01101001</span> <span class="token number">01000010</span> <span class="token number">01101011</span> <span class="token number">01100011</span> <span class="token number">01101101</span> <span class="token number">00111000</span> <span class="token number">01100111</span> <span class="token number">01100011</span> <span class="token number">01001000</span> <span class="token number">01001110</span> <span class="token number">00110100</span> <span class="token number">01100001</span> <span class="token number">00110011</span> <span class="token number">01011001</span> <span class="token number">01100111</span> <span class="token number">01100011</span> <span class="token number">01001000</span> <span class="token number">01011010</span> <span class="token number">01110010</span> <span class="token number">01100011</span> <span class="token number">01010100</span> <span class="token number">00111000</span> <span class="token number">01100111</span> <span class="token number">01100011</span> <span class="token number">01101110</span> <span class="token number">01001110</span> <span class="token number">00110100</span> <span class="token number">01011010</span> <span class="token number">01000100</span> <span class="token number">01101111</span> <span class="token number">01100111</span> <span class="token number">01010010</span> <span class="token number">00110010</span> <span class="token number">00111000</span> <span class="token number">01100111</span> <span class="token number">01100100</span> <span class="token number">01011000</span> <span class="token number">01101000</span> <span class="token number">00110101</span> <span class="token number">01011010</span> <span class="token number">01111001</span> <span class="token number">01000010</span> <span class="token number">01101011</span> <span class="token number">01100011</span> <span class="token number">01101101</span> <span class="token number">01110100</span> <span class="token number">01101011</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01010010</span> <span class="token number">01111001</span> <span class="token number">01100010</span> <span class="token number">01111001</span> <span class="token number">01000010</span> <span class="token number">01110111</span> <span class="token number">01100100</span> <span class="token number">01101101</span> <span class="token number">01110100</span> <span class="token number">01111000</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01001110</span> <span class="token number">01101010</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01000110</span> <span class="token number">00110101</span> <span class="token number">01100011</span> <span class="token number">00110011</span> <span class="token number">01101000</span> <span class="token number">01111000</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01010010</span> <span class="token number">00110101</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01111000</span> <span class="token number">01110110</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01101100</span> <span class="token number">01110111</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01010010</span> <span class="token number">01111001</span> <span class="token number">01100010</span> <span class="token number">01111001</span> <span class="token number">01000010</span> <span class="token number">01110111</span> <span class="token number">01100101</span> <span class="token number">01010111</span> <span class="token number">01001010</span> <span class="token number">00110011</span> <span class="token number">01100001</span> <span class="token number">00110010</span> <span class="token number">01010001</span> <span class="token number">01100111</span> <span class="token number">01011010</span> <span class="token number">01010111</span> <span class="token number">01010010</span> <span class="token number">01110111</span> <span class="token number">01100100</span> <span class="token number">01101101</span> <span class="token number">01110100</span> <span class="token number">01111000</span> <span class="token number">01100101</span> <span class="token number">01111001</span> <span class="token number">00110100</span> <span class="token number">01110101</span> <span class="token number">01001100</span> <span class="token number">01101110</span> <span class="token number">00110000</span> <span class="token number">01100111</span> <span class="token number">01001100</span> <span class="token number">01010011</span> <span class="token number">01000010</span> <span class="token number">01101110</span> <span class="token number">01100011</span> <span class="token number">01101110</span> <span class="token number">01001110</span> <span class="token number">01110100</span> <span class="token number">01100011</span> <span class="token number">01101001</span> <span class="token number">01000010</span> <span class="token number">00110011</span> <span class="token number">01100010</span> <span class="token number">00110010</span> <span class="token number">01110100</span> <span class="token number">00110100</span> <span class="token number">01011001</span> <span class="token number">01111001</span> <span class="token number">01000010</span> <span class="token number">01101011</span> <span class="token number">01100011</span> <span class="token number">01101101</span> <span class="token number">01110100</span> <span class="token number">01101011</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01001110</span> <span class="token number">01110111</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01101100</span> <span class="token number">00110101</span> <span class="token number">01011010</span> <span class="token number">01010011</span> <span class="token number">01000010</span> <span class="token number">01101010</span> <span class="token number">01100010</span> <span class="token number">00110010</span> <span class="token number">00111000</span> <span class="token number">01100111</span> <span class="token number">01011010</span> <span class="token number">01001000</span> <span class="token number">01001010</span> <span class="token number">01110010</span> <span class="token number">01011010</span> <span class="token number">01000011</span> <span class="token number">01000010</span> <span class="token number">00110110</span> <span class="token number">01100001</span> <span class="token number">00110010</span> <span class="token number">01010010</span> <span class="token number">01101011</span> <span class="token number">01100010</span> <span class="token number">00110010</span> <span class="token number">01001010</span> <span class="token number">00110100</span> <span class="token number">01001100</span> <span class="token number">01000011</span> <span class="token number">01000010</span> <span class="token number">01110000</span> <span class="token number">01100101</span> <span class="token number">01010111</span> <span class="token number">01010101</span> <span class="token number">01100111</span> <span class="token number">01100100</span> <span class="token number">01011000</span> <span class="token number">01101000</span> <span class="token number">00110101</span> <span class="token number">01011010</span> <span class="token number">01111001</span> <span class="token number">01000010</span> <span class="token number">01101110</span> <span class="token number">01100011</span> <span class="token number">01101101</span> <span class="token number">01110100</span> <span class="token number">01101011</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01010010</span> <span class="token number">01111001</span> <span class="token number">01100010</span> <span class="token number">01111001</span> <span class="token number">01000010</span> <span class="token number">01110100</span> <span class="token number">01100101</span> <span class="token number">01010111</span> <span class="token number">01001010</span> <span class="token number">01101001</span> <span class="token number">01100010</span> <span class="token number">00110010</span> <span class="token number">01001110</span> <span class="token number">00110110</span> <span class="token number">01100101</span> <span class="token number">01011000</span> <span class="token number">01101000</span> <span class="token number">01110101</span> <span class="token number">01100010</span> <span class="token number">00110011</span> <span class="token number">01101000</span> <span class="token number">01110100</span> <span class="token number">01100010</span> <span class="token number">00110010</span> <span class="token number">01001101</span> <span class="token number">01100111</span> <span class="token number">01100011</span> <span class="token number">01001000</span> <span class="token number">01101100</span> <span class="token number">01101001</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01010101</span> <span class="token number">01110011</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01010001</span> <span class="token number">01110011</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01000001</span> <span class="token number">01110011</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01011001</span> <span class="token number">01100111</span> <span class="token number">01100001</span> <span class="token number">01111001</span> <span class="token number">01110111</span> <span class="token number">01100111</span> <span class="token number">01100001</span> <span class="token number">00110011</span> <span class="token number">01101000</span> <span class="token number">01110101</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01000101</span> <span class="token number">01100111</span> <span class="token number">01100001</span> <span class="token number">00110010</span> <span class="token number">01001010</span> <span class="token number">01110110</span> <span class="token number">01001100</span> <span class="token number">01101001</span> <span class="token number">01000010</span> <span class="token number">01001010</span> <span class="token number">01100101</span> <span class="token number">01010111</span> <span class="token number">01010101</span> <span class="token number">01100111</span> <span class="token number">01100010</span> <span class="token number">01010111</span> <span class="token number">01110100</span> <span class="token number">00110100</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01110000</span> <span class="token number">01101001</span> <span class="token number">01100101</span> <span class="token number">01010111</span> <span class="token number">01111000</span> <span class="token number">01110010</span> <span class="token number">01100010</span> <span class="token number">01001000</span> <span class="token number">01011010</span> <span class="token number">01110000</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01100100</span> <span class="token number">00110101</span> <span class="token number">01011001</span> <span class="token number">01101110</span> <span class="token number">01010101</span> <span class="token number">01100111</span> <span class="token number">01100101</span> <span class="token number">01010111</span> <span class="token number">01010110</span> <span class="token number">01101011</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01010010</span> <span class="token number">01111001</span> <span class="token number">01100010</span> <span class="token number">01111001</span> <span class="token number">01000010</span> <span class="token number">01101001</span> <span class="token number">01100010</span> <span class="token number">00110011</span> <span class="token number">01100100</span> <span class="token number">01110010</span> <span class="token number">01100011</span> <span class="token number">00110011</span> <span class="token number">01101000</span> <span class="token number">01111010</span> <span class="token number">01100101</span> <span class="token number">01001000</span> <span class="token number">01000101</span> <span class="token number">01100111</span> <span class="token number">01100010</span> <span class="token number">01011000</span> <span class="token number">01001010</span> <span class="token number">01110010</span> <span class="token number">01011001</span> <span class="token number">01101101</span> <span class="token number">01110100</span> <span class="token number">01110100</span> <span class="token number">01011010</span> <span class="token number">01000111</span> <span class="token number">00111001</span> <span class="token number">01101001</span> <span class="token number">01011001</span> <span class="token number">01111001</span> <span class="token number">01000010</span> <span class="token number">01110011</span> <span class="token number">01100001</span> <span class="token number">01010011</span> <span class="token number">01000010</span> <span class="token number">01101001</span> <span class="token number">01100010</span> <span class="token number">00110011</span> <span class="token number">01110000</span> <span class="token number">00110010</span> <span class="token number">01100001</span> <span class="token number">00110010</span> <span class="token number">00110001</span> <span class="token number">01111010</span> <span class="token number">01100101</span> <span class="token number">01001000</span> <span class="token number">01000101</span> <span class="token number">01100111</span> <span class="token number">01011010</span> <span class="token number">01001000</span> <span class="token number">01001010</span> <span class="token number">01110110</span> <span class="token number">01100100</span> <span class="token number">01111001</span> <span class="token number">01000010</span> <span class="token number">01110010</span> <span class="token number">01100101</span> <span class="token number">01000111</span> <span class="token number">00110100</span> <span class="token number">01100111</span> <span class="token number">01100011</span> <span class="token number">00110011</span> <span class="token number">01101000</span> <span class="token number">01110111</span> <span class="token number">01100010</span> <span class="token number">00110010</span> <span class="token number">01001010</span> <span class="token number">01101001</span> <span class="token number">01100011</span> <span class="token number">00110011</span> <span class="token number">01101000</span> <span class="token number">01111000</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">00110001</span> <span class="token number">00110101</span> <span class="token number">01100100</span> <span class="token number">00110011</span> <span class="token number">01100100</span> <span class="token number">00110101</span> <span class="token number">01100101</span> <span class="token number">01000011</span> <span class="token number">01000010</span> <span class="token number">01101110</span> <span class="token number">01100101</span> <span class="token number">01010111</span> <span class="token number">01001010</span> <span class="token number">01110101</span> <span class="token number">01011001</span> <span class="token number">01111001</span> <span class="token number">01000010</span> <span class="token number">01111010</span> <span class="token number">01100101</span> <span class="token number">01000011</span> <span class="token number">01000010</span> <span class="token number">01101011</span> <span class="token number">01100011</span> <span class="token number">01101101</span> <span class="token number">00111000</span> <span class="token number">01100111</span> <span class="token number">01010100</span> <span class="token number">00110011</span> <span class="token number">01101000</span> <span class="token number">01111000</span> <span class="token number">01100100</span> <span class="token number">01101110</span> <span class="token number">01001110</span> <span class="token number">01101010</span> <span class="token number">01100011</span> <span class="token number">01101001</span> <span class="token number">01000010</span> <span class="token number">00110010</span> <span class="token number">01100001</span> <span class="token number">00110011</span> <span class="token number">01101000</span> <span class="token number">01111000</span> <span class="token number">01011010</span> <span class="token number">01010111</span> <span class="token number">01110100</span> <span class="token number">01111000</span> <span class="token number">01100010</span> <span class="token number">01111001</span> <span class="token number">00110100</span> <span class="token number">01100111</span> <span class="token number">01010011</span> <span class="token number">00110011</span> <span class="token number">01101000</span> <span class="token number">00110101</span> <span class="token number">01011010</span> <span class="token number">01001000</span> <span class="token number">01001010</span> <span class="token number">01110110</span> <span class="token number">01011001</span> <span class="token number">01101001</span> <span class="token number">01000010</span> <span class="token number">01111000</span> <span class="token number">01011001</span> <span class="token number">01101101</span> <span class="token number">00111001</span> <span class="token number">01110010</span> <span class="token number">01011010</span> <span class="token number">01000011</span> <span class="token number">01000010</span> <span class="token number">00110011</span> <span class="token number">01100010</span> <span class="token number">00110010</span> <span class="token number">01010010</span> <span class="token number">01111001</span> <span class="token number">01100101</span> <span class="token number">01010111</span> <span class="token number">00110100</span> <span class="token number">01100111</span> <span class="token number">01100011</span> <span class="token number">00110010</span> <span class="token number">01001101</span> <span class="token number">01100111</span> <span class="token number">01011010</span> <span class="token number">01001000</span> <span class="token number">01101011</span> <span class="token number">01100111</span> <span class="token number">01011010</span> <span class="token number">01010111</span> <span class="token number">01001110</span> <span class="token number">01110110</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01000010</span> <span class="token number">01101001</span> <span class="token number">01100010</span> <span class="token number">00110010</span> <span class="token number">01000110</span> <span class="token number">01101100</span> <span class="token number">01100010</span> <span class="token number">00110011</span> <span class="token number">01101000</span> <span class="token number">01110100</span> <span class="token number">01100001</span> <span class="token number">01010011</span> <span class="token number">01000010</span> <span class="token number">01110010</span> <span class="token number">01100101</span> <span class="token number">01000111</span> <span class="token number">01110100</span> <span class="token number">00110010</span> <span class="token number">01100001</span> <span class="token number">01010111</span> <span class="token number">01001110</span> <span class="token number">01111010</span> <span class="token number">01011001</span> <span class="token number">01111010</span> <span class="token number">01101111</span> <span class="token number">01100111</span> <span class="token number">01011010</span> <span class="token number">00110010</span> <span class="token number">00111000</span> <span class="token number">01100111</span> <span class="token number">01100100</span> <span class="token number">01011000</span> <span class="token number">01101000</span> <span class="token number">00110101</span> <span class="token number">01011010</span> <span class="token number">01111001</span> <span class="token number">01000010</span> <span class="token number">01101011</span> <span class="token number">01100011</span> <span class="token number">01101101</span> <span class="token number">01110100</span> <span class="token number">01101011</span> <span class="token number">01001001</span> <span class="token number">01000011</span> <span class="token number">01100100</span> <span class="token number">01110110</span> <span class="token number">01001010</span> <span class="token number">01111001</span> <span class="token number">01000010</span> <span class="token number">01101010</span> <span class="token number">01100011</span> <span class="token number">01101110</span> <span class="token number">01101100</span> <span class="token number">01101110</span> <span class="token number">01011001</span> <span class="token number">01111001</span> <span class="token number">01000010</span> <span class="token number">01101100</span> <span class="token number">01100101</span> <span class="token number">01101001</span> <span class="token number">01000010</span> <span class="token number">00110011</span> <span class="token number">01100101</span> <span class="token number">01010111</span> <span class="token number">01001110</span> <span class="token number">01101011</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01101100</span> <span class="token number">01110111</span> <span class="token number">01011010</span> <span class="token number">01000111</span> <span class="token number">00111001</span> <span class="token number">00110100</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01001110</span> <span class="token number">00110100</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01010010</span> <span class="token number">01111001</span> <span class="token number">01100010</span> <span class="token number">01111001</span> <span class="token number">01000010</span> <span class="token number">01110010</span> <span class="token number">01100100</span> <span class="token number">01101110</span> <span class="token number">01110000</span> <span class="token number">01111001</span> <span class="token number">01100001</span> <span class="token number">00110010</span> <span class="token number">01111000</span> <span class="token number">01110110</span> <span class="token number">01011010</span> <span class="token number">01000011</span> <span class="token number">01110111</span> <span class="token number">01100111</span> <span class="token number">01011001</span> <span class="token number">00110011</span> <span class="token number">01101011</span> <span class="token number">01100111</span> <span class="token number">01011010</span> <span class="token number">01001000</span> <span class="token number">01001010</span> <span class="token number">01110010</span> <span class="token number">01011010</span> <span class="token number">01000011</span> <span class="token number">01100100</span> <span class="token number">01101010</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01110000</span> <span class="token number">01101001</span> <span class="token number">01100101</span> <span class="token number">01010111</span> <span class="token number">01111000</span> <span class="token number">01110010</span> <span class="token number">01100010</span> <span class="token number">01001000</span> <span class="token number">01011010</span> <span class="token number">01110000</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01010010</span> <span class="token number">01111001</span> <span class="token number">01100010</span> <span class="token number">01111001</span> <span class="token number">01000010</span> <span class="token number">00110011</span> <span class="token number">01100101</span> <span class="token number">01010111</span> <span class="token number">01001110</span> <span class="token number">01101011</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">00110001</span> <span class="token number">00110101</span> <span class="token number">01100100</span> <span class="token number">00110011</span> <span class="token number">01100100</span> <span class="token number">00110101</span> <span class="token number">01100101</span> <span class="token number">01000011</span> <span class="token number">01000010</span> <span class="token number">01110100</span> <span class="token number">01100011</span> <span class="token number">01101101</span> <span class="token number">01110100</span> <span class="token number">01101001</span> <span class="token number">01100001</span> <span class="token number">00110010</span> <span class="token number">00110001</span> <span class="token number">01101011</span> <span class="token number">01100010</span> <span class="token number">00110010</span> <span class="token number">01001001</span> <span class="token number">01100111</span> <span class="token number">01100011</span> <span class="token number">00110011</span> <span class="token number">01100111</span> <span class="token number">01100111</span> <span class="token number">01011010</span> <span class="token number">01001000</span> <span class="token number">01001010</span> <span class="token number">01110110</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01010010</span> <span class="token number">01110110</span> <span class="token number">01100001</span> <span class="token number">01000111</span> <span class="token number">01010001</span> <span class="token number">01110011</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01000010</span> <span class="token number">00110101</span> <span class="token number">01100100</span> <span class="token number">01101110</span> <span class="token number">01011010</span> <span class="token number">00110101</span> <span class="token number">01011010</span> <span class="token number">00110010</span> <span class="token number">00111001</span> <span class="token number">01110101</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01111000</span> <span class="token number">01110000</span> <span class="token number">01001001</span> <span class="token number">01000011</span> <span class="token number">01100100</span> <span class="token number">01101011</span> <span class="token number">01001010</span> <span class="token number">01111001</span> <span class="token number">01110111</span> <span class="token number">01100111</span> <span class="token number">01100001</span> <span class="token number">00110011</span> <span class="token number">01101000</span> <span class="token number">01110101</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01001110</span> <span class="token number">00110101</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01101100</span> <span class="token number">00110100</span> <span class="token number">01001100</span> <span class="token number">01101001</span> <span class="token number">01000010</span> <span class="token number">01011010</span> <span class="token number">01100101</span> <span class="token number">01000111</span> <span class="token number">00110001</span> <span class="token number">01110110</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01101100</span> <span class="token number">00110101</span> <span class="token number">01011010</span> <span class="token number">01010011</span> <span class="token number">01000010</span> <span class="token number">00110001</span> <span class="token number">01100101</span> <span class="token number">01001000</span> <span class="token number">01101100</span> <span class="token number">01101110</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01110011</span> <span class="token number">01100111</span> <span class="token number">01100011</span> <span class="token number">01000111</span> <span class="token number">00111001</span> <span class="token number">01101110</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">00110001</span> <span class="token number">01111001</span> <span class="token number">01100001</span> <span class="token number">00110010</span> <span class="token number">01001010</span> <span class="token number">01110010</span> <span class="token number">01100010</span> <span class="token number">01010111</span> <span class="token number">01010010</span> <span class="token number">01110110</span> <span class="token number">01011001</span> <span class="token number">01101101</span> <span class="token number">01001101</span> <span class="token number">01110011</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01101100</span> <span class="token number">00110101</span> <span class="token number">01011010</span> <span class="token number">01010011</span> <span class="token number">01000010</span> <span class="token number">01110100</span> <span class="token number">01100001</span> <span class="token number">00110011</span> <span class="token number">01100111</span> <span class="token number">01100111</span> <span class="token number">01100011</span> <span class="token number">00110011</span> <span class="token number">01101000</span> <span class="token number">01110111</span> <span class="token number">01100010</span> <span class="token number">00110010</span> <span class="token number">01001001</span> <span class="token number">01100111</span> <span class="token number">01011010</span> <span class="token number">01001000</span> <span class="token number">01001010</span> <span class="token number">01110110</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01001010</span> <span class="token number">01110110</span> <span class="token number">01011001</span> <span class="token number">00110010</span> <span class="token number">01010001</span> <span class="token number">01100111</span> <span class="token number">01100101</span> <span class="token number">01011000</span> <span class="token number">01000001</span> <span class="token number">01100111</span> <span class="token number">01011010</span> <span class="token number">01001000</span> <span class="token number">01001010</span> <span class="token number">01110110</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01100100</span> <span class="token number">00110101</span> <span class="token number">01011001</span> <span class="token number">01101101</span> <span class="token number">00110101</span> <span class="token number">01101010</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01111000</span> <span class="token number">01110010</span> <span class="token number">01011001</span> <span class="token number">00110010</span> <span class="token number">00111001</span> <span class="token number">01110101</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01101100</span> <span class="token number">00110100</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">00110001</span> <span class="token number">00110101</span> <span class="token number">01100100</span> <span class="token number">00110011</span> <span class="token number">01100100</span> <span class="token number">00110101</span> <span class="token number">01100101</span> <span class="token number">01000011</span> <span class="token number">01000010</span> <span class="token number">01101110</span> <span class="token number">01100101</span> <span class="token number">01010111</span> <span class="token number">01001010</span> <span class="token number">01110101</span> <span class="token number">01011001</span> <span class="token number">01111001</span> <span class="token number">01000010</span> <span class="token number">01101011</span> <span class="token number">01100011</span> <span class="token number">01101101</span> <span class="token number">01110100</span> <span class="token number">01101011</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01001110</span> <span class="token number">01111001</span> <span class="token number">01100101</span> <span class="token number">01010111</span> <span class="token number">01100011</span> <span class="token number">01100111</span> <span class="token number">01011010</span> <span class="token number">01011000</span> <span class="token number">01101111</span> <span class="token number">01100111</span> <span class="token number">01100011</span> <span class="token number">00110011</span> <span class="token number">01100111</span> <span class="token number">01100111</span> <span class="token number">01011010</span> <span class="token number">01001000</span> <span class="token number">01001010</span> <span class="token number">01110110</span> <span class="token number">01001001</span> <span class="token number">01000101</span> <span class="token number">00111001</span> <span class="token number">00110100</span> <span class="token number">01100011</span> <span class="token number">01011000</span> <span class="token number">01011010</span> <span class="token number">01111010</span> <span class="token number">01011001</span> <span class="token number">00110011</span> <span class="token number">01001001</span> <span class="token number">01100111</span> <span class="token number">01100100</span> <span class="token number">01101101</span> <span class="token number">01110100</span> <span class="token number">00110100</span> <span class="token number">01100011</span> <span class="token number">01010111</span> <span class="token number">01010110</span> <span class="token number">01110010</span> <span class="token number">01100011</span> <span class="token number">01010111</span> <span class="token number">00111000</span> <span class="token number">01110101</span> <span class="token number">01000011</span> <span class="token number">01101110</span> <span class="token number">01001010</span> <span class="token number">01101110</span> <span class="token number">01100001</span> <span class="token number">01000111</span> <span class="token number">00110101</span> <span class="token number">00110100</span> <span class="token number">01100011</span> <span class="token number">00110010</span> <span class="token number">01010010</span> <span class="token number">01101101</span> <span class="token number">01100101</span> <span class="token number">01011000</span> <span class="token number">01001110</span> <span class="token number">01101011</span> <span class="token number">01100100</span> <span class="token number">01000111</span> <span class="token number">01100100</span> <span class="token number">01101111</span> <span class="token number">01100100</span> <span class="token number">01010011</span> <span class="token number">01000101</span> <span class="token number">01100111</span> <span class="token number">01100011</span> <span class="token number">01010111</span> <span class="token number">01100100</span> <span class="token number">01101101</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01101100</span> <span class="token number">01111010</span> <span class="token number">01011001</span> <span class="token number">01010111</span> <span class="token number">01110011</span> <span class="token number">01100111</span> <span class="token number">01011001</span> <span class="token number">00110011</span> <span class="token number">01010010</span> <span class="token number">01101111</span> <span class="token number">01100100</span> <span class="token number">01001000</span> <span class="token number">01010110</span> <span class="token number">01110000</span> <span class="token number">01100001</span> <span class="token number">00110010</span> <span class="token number">01010101</span> <span class="token number">01100111</span> <span class="token number">01011010</span> <span class="token number">01000111</span> <span class="token number">01101100</span> <span class="token number">01110010</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01110000</span> <span class="token number">01110010</span> <span class="token number">01100010</span> <span class="token number">01101110</span> <span class="token number">01010010</span> <span class="token number">01101111</span> <span class="token number">01100001</span> <span class="token number">01000111</span> <span class="token number">01110100</span> <span class="token number">00110100</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01001010</span> <span class="token number">00110100</span> <span class="token number">01100011</span> <span class="token number">01010111</span> <span class="token number">01111000</span> <span class="token number">01101011</span> <span class="token number">01011010</span> <span class="token number">00110010</span> <span class="token number">00110101</span> <span class="token number">00110100</span> <span class="token number">01100011</span> <span class="token number">00110010</span> <span class="token number">01111000</span> <span class="token number">01110000</span> <span class="token number">01100011</span> <span class="token number">01010011</span> <span class="token number">01000010</span> <span class="token number">01111001</span> <span class="token number">01100001</span> <span class="token number">01011000</span> <span class="token number">01001110</span> <span class="token number">00110101</span> <span class="token number">01100101</span> <span class="token number">01010111</span> <span class="token number">01110100</span> <span class="token number">01101111</span> <span class="token number">01100010</span> <span class="token number">01101101</span> <span class="token number">01110011</span> <span class="token number">01110101</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01101100</span> <span class="token number">01110010</span> <span class="token number">01100101</span> <span class="token number">01000111</span> <span class="token number">01110011</span> <span class="token number">01100111</span> <span class="token number">01100100</span> <span class="token number">01001000</span> <span class="token number">01010101</span> <span class="token number">01100111</span> <span class="token number">01100011</span> <span class="token number">01111001</span> <span class="token number">01000010</span> <span class="token number">01101010</span> <span class="token number">01100101</span> <span class="token number">01011000</span> <span class="token number">01001110</span> <span class="token number">01110101</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01001110</span> <span class="token number">01101110</span> <span class="token number">01100101</span> <span class="token number">01000011</span> <span class="token number">01000010</span> <span class="token number">01111010</span> <span class="token number">01100101</span> <span class="token number">01011000</span> <span class="token number">01101011</span> <span class="token number">01100111</span> <span class="token number">01100011</span> <span class="token number">01010111</span> <span class="token number">01100100</span> <span class="token number">01101101</span> <span class="token number">01100101</span> <span class="token number">01000011</span> <span class="token number">01000010</span> <span class="token number">01110000</span> <span class="token number">01100011</span> <span class="token number">00110011</span> <span class="token number">01101000</span> <span class="token number">01101100</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01110100</span> <span class="token number">01101010</span> <span class="token number">01011001</span> <span class="token number">00110010</span> <span class="token number">01100100</span> <span class="token number">00110100</span> <span class="token number">01011010</span> <span class="token number">01001000</span> <span class="token number">01010101</span> <span class="token number">00110110</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01011010</span> <span class="token number">01101011</span> <span class="token number">01011001</span> <span class="token number">00110011</span> <span class="token number">01101100</span> <span class="token number">01111010</span> <span class="token number">01100010</span> <span class="token number">01101110</span> <span class="token number">01110100</span> <span class="token number">01101111</span> <span class="token number">01001101</span> <span class="token number">01001000</span> <span class="token number">01011010</span> <span class="token number">01100110</span> <span class="token number">01011010</span> <span class="token number">01000111</span> <span class="token number">01101011</span> <span class="token number">00110000</span> <span class="token number">01011010</span> <span class="token number">01001000</span> <span class="token number">01010110</span> <span class="token number">01100110</span> <span class="token number">01100100</span> <span class="token number">01101101</span> <span class="token number">01101011</span> <span class="token number">00110000</span> <span class="token number">01011010</span> <span class="token number">01000110</span> <span class="token number">00111001</span> <span class="token number">00110000</span> <span class="token number">01011000</span> <span class="token number">00110011</span> <span class="token number">01001001</span> <span class="token number">00110000</span> <span class="token number">01100101</span> <span class="token number">01011000</span> <span class="token number">01101100</span> <span class="token number">01100110</span> <span class="token number">01100011</span> <span class="token number">01101110</span> <span class="token number">01101000</span> <span class="token number">01111000</span> <span class="token number">01100010</span> <span class="token number">01000111</span> <span class="token number">01010001</span> <span class="token number">01110111</span> <span class="token number">01100110</span> <span class="token number">01010011</span> <span class="token number">00110100</span> <span class="token number">01100111</span> <span class="token number">01100011</span> <span class="token number">01010111</span> <span class="token number">01100100</span> <span class="token number">01101101</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01011010</span> <span class="token number">00110000</span> <span class="token number">01100101</span> <span class="token number">01011000</span> <span class="token number">01101011</span> <span class="token number">01100111</span> <span class="token number">01011001</span> <span class="token number">00110011</span> <span class="token number">01010010</span> <span class="token number">01101111</span> <span class="token number">01011010</span> <span class="token number">01010011</span> <span class="token number">01000010</span> <span class="token number">01101011</span> <span class="token number">01100001</span> <span class="token number">01011000</span> <span class="token number">01001110</span> <span class="token number">01101011</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01001101</span> <span class="token number">01100111</span> <span class="token number">01100101</span> <span class="token number">01010111</span> <span class="token number">01100100</span> <span class="token number">01101011</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01100100</span> <span class="token number">01101010</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01001010</span> <span class="token number">00110100</span> <span class="token number">01100011</span> <span class="token number">01010111</span> <span class="token number">01111000</span> <span class="token number">01101011</span> <span class="token number">01011010</span> <span class="token number">00110010</span> <span class="token number">00110101</span> <span class="token number">00110100</span> <span class="token number">01100011</span> <span class="token number">00110010</span> <span class="token number">01111000</span> <span class="token number">01110000</span> <span class="token number">01100011</span> <span class="token number">01010011</span> <span class="token number">01000010</span> <span class="token number">00110000</span> <span class="token number">01100100</span> <span class="token number">01010011</span> <span class="token number">01000010</span> <span class="token number">01110111</span> <span class="token number">01011010</span> <span class="token number">01101110</span> <span class="token number">01010110</span> <span class="token number">01101011</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01110000</span> <span class="token number">01101101</span> <span class="token number">01100100</span> <span class="token number">01001000</span> <span class="token number">01101100</span> <span class="token number">01101100</span> <span class="token number">01100100</span> <span class="token number">01000111</span> <span class="token number">01101000</span> <span class="token number">01110101</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01100100</span> <span class="token number">01101010</span> <span class="token number">01011001</span> <span class="token number">01111001</span> <span class="token number">01000010</span> <span class="token number">01101011</span> <span class="token number">01100001</span> <span class="token number">01011000</span> <span class="token number">01010010</span> <span class="token number">00110001</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01010110</span> <span class="token number">01101110</span> <span class="token number">01100101</span> <span class="token number">01000111</span> <span class="token number">01010001</span> <span class="token number">01100111</span> <span class="token number">01011010</span> <span class="token number">00110010</span> <span class="token number">01001101</span> <span class="token number">01100111</span> <span class="token number">01100101</span> <span class="token number">01101110</span> <span class="token number">01001110</span> <span class="token number">00110001</span> <span class="token number">01100100</span> <span class="token number">01001000</span> <span class="token number">01001001</span> <span class="token number">01100111</span> <span class="token number">01011001</span> <span class="token number">01101101</span> <span class="token number">01101000</span> <span class="token number">01101110</span> <span class="token number">01100100</span> <span class="token number">01101110</span> <span class="token number">01101100</span> <span class="token number">01110010</span> <span class="token number">01011010</span> <span class="token number">01010111</span> <span class="token number">00110101</span> <span class="token number">01110010</span> <span class="token number">01001100</span> <span class="token number">01000011</span> <span class="token number">01000010</span> <span class="token number">01111010</span> <span class="token number">01100001</span> <span class="token number">01000111</span> <span class="token number">01010101</span> <span class="token number">01100111</span> <span class="token number">01100100</span> <span class="token number">01000111</span> <span class="token number">01010001</span> <span class="token number">01100111</span> <span class="token number">01100101</span> <span class="token number">01000111</span> <span class="token number">01110100</span> <span class="token number">01111010</span> <span class="token number">01100101</span> <span class="token number">01011000</span> <span class="token number">01101100</span> <span class="token number">01111000</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01010010</span> <span class="token number">00110001</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01101000</span> <span class="token number">01101110</span> <span class="token number">01011010</span> <span class="token number">01000011</span> <span class="token number">01000010</span> <span class="token number">00110001</span> <span class="token number">01011010</span> <span class="token number">01111001</span> <span class="token number">01000010</span> <span class="token number">00110110</span> <span class="token number">01100011</span> <span class="token number">00110010</span> <span class="token number">01010101</span> <span class="token number">01100111</span> <span class="token number">01100011</span> <span class="token number">00110010</span> <span class="token number">01001110</span> <span class="token number">01101011</span> <span class="token number">01100001</span> <span class="token number">00110011</span> <span class="token number">01100111</span> <span class="token number">01100111</span> <span class="token number">01100011</span> <span class="token number">00110011</span> <span class="token number">01101100</span> <span class="token number">00110101</span> <span class="token number">01001100</span> <span class="token number">01101001</span> <span class="token number">01000010</span> <span class="token number">01110000</span> <span class="token number">01011010</span> <span class="token number">00110010</span> <span class="token number">01111000</span> <span class="token number">01110010</span> <span class="token number">01001001</span> <span class="token number">01001000</span> <span class="token number">01000110</span> <span class="token number">01101110</span> <span class="token number">01011010</span> <span class="token number">01101001</span> <span class="token number">01000010</span> <span class="token number">01110010</span> <span class="token number">01100001</span> <span class="token number">01001000</span> <span class="token number">01000010</span> <span class="token number">01101110</span> <span class="token number">01100011</span> <span class="token number">01010111</span> <span class="token number">01110100</span> <span class="token number">01101100</span> <span class="token number">01001001</span> <span class="token number">01000111</span> <span class="token number">01010010</span> <span class="token number">01110000</span> <span class="token number">01100001</span> <span class="token number">01111001</span> <span class="token number">01000010</span> <span class="token number">01111001</span> <span class="token number">01100001</span> <span class="token number">01011000</span> <span class="token number">01001110</span> <span class="token number">00110101</span> <span class="token number">01100101</span> <span class="token number">01010111</span> <span class="token number">01110100</span> <span class="token number">01101111</span> <span class="token number">01100010</span> <span class="token number">01101101</span> <span class="token number">01110011</span> <span class="token number">01101000</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>可以发现里面的2进制数转10进制后都不超过128，可以断定是ASCII码，看看里面说的啥：</p>
<pre class="line-numbers language-none"><code class="language-none">U h - o h ,   l o o k s   l i k e   w e   h a v e   a n o t h e r   b l o c k   o f   t e x t ,   w i t h   s o m e   s o r t   o f   s p e c i a l   e n c o d i n g .   C a n   y o u   f i g u r e   o u t   w h a t   t h i s   e n c o d i n g   i s ?   ( h i n t :   i f   y o u   l o o k   c a r e f u l l y ,   y o u &#39; l l   n o t i c e   t h a t   t h e r e   o n l y   c h a r a c t e r s   p r e s e n t   a r e   A - Z ,   a - z ,   0 - 9 ,   a n d   s o m e t i m e s   &#x2F;   a n d   + .   S e e   i f   y o u   c a n   f i n d   a n   e n c o d i n g   t h a t   l o o k s   l i k e   t h i s   o n e . ) 
 T m V 3 I G N o Y W x s Z W 5 n Z S E g Q 2 F u I H l v d S B m a W d 1 c m U g b 3 V 0 I H d o Y X Q n c y B n b 2 l u Z y B v b i B o Z X J l P y B J d C B s b 2 9 r c y B s a W t l I H R o Z S B s Z X R 0 Z X J z I G F y Z S B z a G l m d G V k I G J 5 I H N v b W U g Y 2 9 u c 3 R h b n Q u I C h o a W 5 0 O i B 5 b 3 U g b W l n a H Q g d 2 F u d C B 0 b y B z d G F y d C B s b 2 9 r a W 5 n I H V w I F J v b W F u I H B l b 3 B s Z S k u C m t 2 Y n N x c m Q s I G l 5 Z S d i b y B r d n d 5 Y 2 Q g Z H J v Y m 8 h I F h 5 Z y B w e W I g Z H J v I H B z e G t 2 I C h r e G 4 g d 2 t p b G 8 g Z H J v I H J r Y m 5 v Y 2 Q u L i 4 p I H p r Y m Q 6 I G s g Y 2 V s Y 2 R z Z G V k c 3 l 4 I G 1 z e n J v Y i 4 g U 3 g g Z H J v I H B 5 d n Z 5 Z 3 N 4 c S B k b 2 h k L C B T J 2 Z v I G R r d W 9 4 I H d p I H d v Y 2 N r c W 8 g a 3 h u I G J v e n Z r b W 9 u I G 9 m b 2 J p I G t 2 e n J r b G 9 k c 2 0 g b X J r Y m t t Z G 9 i I G d z Z H I g a y B t e W J i b 2 N 6 e X h u b 3 h t b y B k e S B r I G 5 z c H B v Y m 9 4 Z C B t c m t i a 2 1 k b 2 I g L S B 1 e H l n e C B r Y y B r I G N l b G N k c 2 R l Z H N 5 e C B t c 3 p y b 2 I u I E 1 r e C B p e W U g c H N 4 b i B k c m 8 g c H N 4 a 3 Y g c H Z r c T 8 g c n N 4 Z D o g R 2 8 g d X h 5 Z y B k c m t k I G R y b y B w d m t x I H N j I H F 5 c 3 h x I G R 5 I G x v I H l w I G R y b y B w e W J 3 a 2 Q g Z W R w d m t x e y 4 u L n 0 g L S B n c n N t c i B 3 b 2 t 4 Y y B k c m t k I H N w I G l 5 Z S B j b 2 8 g Z H J r Z C B 6 a 2 R k b 2 J 4 L C B p e W U g d X h 5 Z y B n c m t k I G R y b y B t e W J i b 2 N 6 e X h u b 3 h t b 2 M g c H l i I G U s I G Q s I H A s I H Y g a y w g a 3 h u I H E g a 2 J v L i B J e W U g b W t 4 I H p i e W x r b H Z p I G d 5 Y n U g e W V k I G R y b y B i b 3 d r c 3 h z e H E g b X J r Y m t t Z G 9 i Y y B s a S B i b 3 p 2 a 2 1 z e H E g Z H J v d y B r e G 4 g c 3 h w b 2 J i c 3 h x I G 1 5 d 3 d 5 e C B n e W J u Y y B z e C B k c m 8 g T 3 h x d n N j c i B 2 a 3 h x Z W t x b y 4 g S 3 h 5 Z H J v Y i B x Y m 9 r Z C B 3 b 2 R y e W 4 g c 2 M g Z H k g Z W N v I H B i b 2 F l b 3 h t a S B r e G t 2 a W N z Y z o g Z 2 8 g d X h 5 Z y B k c m t k I C d v J y B j c n l n Y y B l e i B 3 e W N k I H l w Z G 9 4 I H N 4 I G R y b y B r d n p y a 2 x v Z C w g Y 3 k g Z H J r Z C d j I H p i e W x r b H Z p I G R y b y B 3 e W N k I G 1 5 d 3 d 5 e C B t c m t i a 2 1 k b 2 I g c 3 g g Z H J v I G R v a G Q s I H B 5 d n Z 5 Z 2 9 u I G x p I C d k J y w g a 3 h u I G N 5 I H l 4 L i B Z e G 1 v I G l 5 Z S B 1 e H l n I G s g c G 9 n I G 1 y a 2 J r b W R v Y m M s I G l 5 Z S B t a 3 g g c 3 h w b 2 I g Z H J v I G J v Y 2 Q g e X A g Z H J v I G d 5 Y m 5 j I G x r Y 2 9 u I H l 4 I G 1 5 d 3 d 5 e C B n e W J u Y y B k c m t k I G N y e W c g Z X o g c 3 g g Z H J v I E 9 4 c X Z z Y 3 I g d m t 4 c W V r c W 8 u C n J n a G 5 4 c 2 R m e X N k d G d o d S E g c W d m I G l z Y W s g Y 3 R o d H V p a 2 U g Z G l r I H p r b n R o a G t 4 I H J 4 c W x k Z 2 5 4 c 2 x p c S B y a X N 5 e W t o b m s u I G l r e G s g d H U g c y B j e X N u I G N n e C B z e X k g c W d m e C B p c 3 h l I G t j Y 2 d 4 Z H U 6 I G Z k Y 3 l z b n t o M H Z f Z G k 0 Z H V f d m k 0 Z F 9 0 X 3 I 0 e X l f c n h x b G Q w f S 4 g c W d m I H Z 0 e X k g Y 3 R o Z S B k a X N k I H M g e W d k I G d j I H J 4 c W x k Z 2 5 4 c 2 x p c S B 0 d S B w Z n V k I H p m d H l l d G h u I G d j Y y B k a X R 1 I H V n e G Q g Z 2 M g e n N 1 d H I g Y m h n d n l r Z W 5 r L C B z a G U g d G Q g e G t z e X l x I H R 1 I G h n Z C B 1 Z y B 6 c 2 U g c 2 N k a 3 g g c 3 l 5 L i B p Z 2 x r I H F n Z i B r a H B n c W t l I G R p a y B y a X N 5 e W t o b m s h <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>根据hint里面所说的密文特点，正是base64，我们解码看看：</p>
<pre class="line-numbers language-none"><code class="language-none">New challenge! Can you figure out what&#39;s going on here? It looks like the letters are shifted by some constant. (hint: you might want to start looking up Roman people).
kvbsqrd, iye&#39;bo kvwycd drobo! Xyg pyb dro psxkv (kxn wkilo dro rkbnocd...) zkbd: k celcdsdedsyx mszrob. Sx dro pyvvygsxq dohd, S&#39;fo dkuox wi wocckqo kxn bozvkmon ofobi kvzrklodsm mrkbkmdob gsdr k mybboczyxnoxmo dy k nsppoboxd mrkbkmdob - uxygx kc k celcdsdedsyx mszrob. Mkx iye psxn dro psxkv pvkq? rsxd: Go uxyg drkd dro pvkq sc qysxq dy lo yp dro pybwkd edpvkq&#123;...&#125; - grsmr wokxc drkd sp iye coo drkd zkddobx, iye uxyg grkd dro mybboczyxnoxmoc pyb e, d, p, v k, kxn q kbo. Iye mkx zbylklvi gybu yed dro bowksxsxq mrkbkmdobc li bozvkmsxq drow kxn sxpobbsxq mywwyx gybnc sx dro Oxqvscr vkxqekqo. Kxydrob qbokd wodryn sc dy eco pboaeoxmi kxkvicsc: go uxyg drkd &#39;o&#39; crygc ez wycd ypdox sx dro kvzrklod, cy drkd&#39;c zbylklvi dro wycd mywwyx mrkbkmdob sx dro dohd, pyvvygon li &#39;d&#39;, kxn cy yx. Yxmo iye uxyg k pog mrkbkmdobc, iye mkx sxpob dro bocd yp dro gybnc lkcon yx mywwyx gybnc drkd cryg ez sx dro Oxqvscr vkxqekqo.
rghnxsdfysdtghu! qgf isak cthtuike dik zknthhkx rxqldgnxsliq risyykhnk. ikxk tu s cysn cgx syy qgfx isxe kccgxdu: fdcysn&#123;h0v_di4du_vi4d_t_r4yy_rxqld0&#125;. qgf vtyy cthe disd s ygd gc rxqldgnxsliq tu pfud zftyethn gcc ditu ugxd gc zsutr bhgvykenk, she td xksyyq tu hgd ug zse scdkx syy. iglk qgf khpgqke dik risyykhnk!<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>Roman people。说的是Caesar大帝吧，最后发现位移10位可得到明文：</p>
<pre class="line-numbers language-none"><code class="language-none">alright, you&#39;re almost there! Now for the final (and maybe the hardest...) part: a substitution cipher. In the following text, I&#39;ve taken my message and replaced every alphabetic character with a correspondence to a different character - known as a substitution cipher. Can you find the final flag? hint: We know that the flag is going to be of the format utflag&#123;...&#125; - which means that if you see that pattern, you know what the correspondences for u, t, f, l a, and g are. You can probably work out the remaining characters by replacing them and inferring common words in the English language. Another great method is to use frequency analysis: we know that &#39;e&#39; shows up most often in the alphabet, so that&#39;s probably the most common character in the text, followed by &#39;t&#39;, and so on. Once you know a few characters, you can infer the rest of the words based on common words that show up in the English language.
hwxdnitvoitjwxk! gwv yiqa sjxjkyau tya padjxxan hngbtwdnibyg hyiooaxda. yana jk i soid swn ioo gwvn yinu asswntk: vtsoid&#123;x0l_ty4tk_ly4t_j_h4oo_hngbt0&#125;. gwv ljoo sjxu tyit i owt ws hngbtwdnibyg jk fvkt pvjoujxd wss tyjk kwnt ws pikjh rxwloauda, ixu jt naioog jk xwt kw piu istan ioo. ywba gwv axfwgau tya hyiooaxda!<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>再根据里面的提示：词频分析，就可以得到flag：</p>
<p><img "" class="lazyload placeholder" data-original="/2021/08/17/BUUCTF-Crypto%E7%B3%BB%E5%88%97-81-96-WP/Post10_image8.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif"></p>
<hr>
<h2 id="WUSTCTF2020-dp-leaking-1s-very-d-angerous"><a href="#WUSTCTF2020-dp-leaking-1s-very-d-angerous" class="headerlink" title="[WUSTCTF2020]dp_leaking_1s_very_d@angerous"></a>[WUSTCTF2020]dp_leaking_1s_very_d@angerous</h2><p>题目说的是dp泄露，看看附件里面是什么：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">e <span class="token operator">=</span> <span class="token number">65537</span>
n <span class="token operator">=</span> <span class="token number">156808343598578774957375696815188980682166740609302831099696492068246337198792510898818496239166339015207305102101431634283168544492984586566799996471150252382144148257236707247267506165670877506370253127695314163987084076462560095456635833650720606337852199362362120808707925913897956527780930423574343287847</span>
c <span class="token operator">=</span> <span class="token number">108542078809057774666748066235473292495343753790443966020636060807418393737258696352569345621488958094856305865603100885838672591764072157183336139243588435583104423268921439473113244493821692560960443688048994557463526099985303667243623711454841573922233051289561865599722004107134302070301237345400354257869</span>
dp <span class="token operator">=</span> <span class="token number">734763139918837027274765680404546851353356952885439663987181004382601658386317353877499122276686150509151221546249750373865024485652349719427182780275825</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>直接搬运前面做过的dp泄露的脚本：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> inverse
<span class="token keyword">import</span> libnum

e <span class="token operator">=</span> <span class="token number">65537</span>
n <span class="token operator">=</span> <span class="token number">156808343598578774957375696815188980682166740609302831099696492068246337198792510898818496239166339015207305102101431634283168544492984586566799996471150252382144148257236707247267506165670877506370253127695314163987084076462560095456635833650720606337852199362362120808707925913897956527780930423574343287847</span>
c <span class="token operator">=</span> <span class="token number">108542078809057774666748066235473292495343753790443966020636060807418393737258696352569345621488958094856305865603100885838672591764072157183336139243588435583104423268921439473113244493821692560960443688048994557463526099985303667243623711454841573922233051289561865599722004107134302070301237345400354257869</span>
dp <span class="token operator">=</span> <span class="token number">734763139918837027274765680404546851353356952885439663987181004382601658386317353877499122276686150509151221546249750373865024485652349719427182780275825</span>

y <span class="token operator">=</span> dp <span class="token operator">*</span> e
<span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>y <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> x <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        p <span class="token operator">=</span> <span class="token punctuation">(</span>y <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> x <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">%</span> p <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            q <span class="token operator">=</span> n <span class="token operator">//</span> p
            phin <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
            d <span class="token operator">=</span> inverse<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phin<span class="token punctuation">)</span>
            m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>libnum<span class="token punctuation">.</span>n2s<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>运行脚本可得flag。</p>
<hr>
<h2 id="BJDCTF2020-编码与调制"><a href="#BJDCTF2020-编码与调制" class="headerlink" title="[BJDCTF2020]编码与调制"></a>[BJDCTF2020]编码与调制</h2><p>题目如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">密文：<span class="token number">2559659965656A9A65656996696965A6695669A9695A699569666A5A6A6569666A59695A69AA696569666AA6</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img "" class="lazyload placeholder" data-original="/2021/08/17/BUUCTF-Crypto%E7%B3%BB%E5%88%97-81-96-WP/Post10_image9.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif"></p>
<p>脚本如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>

c <span class="token operator">=</span> <span class="token number">0x2559659965656A9A65656996696965A6695669A9695A699569666A5A6A6569666A59695A69AA696569666AA6</span>
c_bin <span class="token operator">=</span> <span class="token builtin">bin</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span>

paliner1 <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>c_bin<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>c_bin<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"0"</span> <span class="token keyword">and</span> c_bin<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        paliner1 <span class="token operator">+=</span> <span class="token string">"0"</span>
    <span class="token keyword">elif</span> <span class="token punctuation">(</span>c_bin<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"1"</span> <span class="token keyword">and</span> c_bin<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        paliner1 <span class="token operator">+=</span> <span class="token string">"1"</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>paliner1<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

paliner2 <span class="token operator">=</span> <span class="token string">"1"</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>c_bin<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>c_bin<span class="token punctuation">[</span>i <span class="token punctuation">:</span> i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"11"</span> <span class="token keyword">or</span> c_bin<span class="token punctuation">[</span>i <span class="token punctuation">:</span> i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"00"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        paliner2 <span class="token operator">+=</span> <span class="token string">"1"</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        paliner2 <span class="token operator">+=</span> <span class="token string">"0"</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>paliner2<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>运行脚本可知是曼彻斯特编码。</p>
<hr>
<h2 id="ACTF新生赛2020-crypto-classic1"><a href="#ACTF新生赛2020-crypto-classic1" class="headerlink" title="[ACTF新生赛2020]crypto-classic1"></a>[ACTF新生赛2020]crypto-classic1</h2><p>题目如下：</p>
<pre class="line-numbers language-none"><code class="language-none">hint.txt
哇，这里有压缩包的密码哦，于是我低下了头，看向了我的双手，试图从中找到某些规律
xdfv ujko98 edft54 xdfv pok,.; wsdr43<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>这里面是关于压缩包的密文。很有意思，其中的密文字符是在键盘字符串所围的字符，那么明文就是：circle。</p>
<p>维吉尼亚密码：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">SRLU<span class="token punctuation">&#123;</span>LZPL_S_UASHKXUPD_NXYTFTJT<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>可知SRLU对应的是ACTF，这样可以解得key=’SP’，最后flag为：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">ACTF<span class="token punctuation">&#123;</span>WHAT_A_CLASSICAL_VIGENERE<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<hr>
<h2 id="NPUCTF2020-Classical-Cipher"><a href="#NPUCTF2020-Classical-Cipher" class="headerlink" title="[NPUCTF2020]Classical Cipher"></a>[NPUCTF2020]Classical Cipher</h2><p>题目如下：</p>
<pre class="line-numbers language-none"><code class="language-none">一个压缩包，获取内容需要密码。
key.txt:
解密后的flag请用flag&#123;&#125;包裹

压缩包密码：gsv_pvb_rh_zgyzhs

对应明文：   ***_key_**_******<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>发现里面的对应关系是字符在字母表中的序号相加等于27，这样就可以得到明文：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">the_key_is_atbash<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>得到一张图片：</p>
<p><img "" class="lazyload placeholder" data-original="/2021/08/17/BUUCTF-Crypto%E7%B3%BB%E5%88%97-81-96-WP/Post10_image10.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif"></p>
<p>看到了熟悉的猪圈密码，另外一种密码网上搜搜看，第一次碰见。看了大佬博客，是古埃及象形密码，抄下编码表：</p>
<p><img "" class="lazyload placeholder" data-original="/2021/08/17/BUUCTF-Crypto%E7%B3%BB%E5%88%97-81-96-WP/Post10_image11.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif"></p>
<p>得到flag为：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">classicalcode<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<hr>
<h2 id="NPUCTF2020-EzRSA"><a href="#NPUCTF2020-EzRSA" class="headerlink" title="[NPUCTF2020]EzRSA"></a>[NPUCTF2020]EzRSA</h2><p>题目如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> lcm <span class="token punctuation">,</span> powmod <span class="token punctuation">,</span> invert <span class="token punctuation">,</span> gcd <span class="token punctuation">,</span> mpz
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime
<span class="token keyword">from</span> sympy <span class="token keyword">import</span> nextprime
<span class="token keyword">from</span> random <span class="token keyword">import</span> randint
p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
n <span class="token operator">=</span> p <span class="token operator">*</span> q
gift <span class="token operator">=</span> lcm<span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span> <span class="token punctuation">,</span> q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
e <span class="token operator">=</span> <span class="token number">54722</span>
flag <span class="token operator">=</span> <span class="token string">b'NPUCTF&#123;******************&#125;'</span>
m <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>flag <span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span>
c <span class="token operator">=</span> powmod<span class="token punctuation">(</span>m <span class="token punctuation">,</span> e <span class="token punctuation">,</span> n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'n: '</span> <span class="token punctuation">,</span> n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'gift: '</span> <span class="token punctuation">,</span> gift<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'c: '</span> <span class="token punctuation">,</span> c<span class="token punctuation">)</span>

<span class="token comment">#n:  17083941230213489700426636484487738282426471494607098847295335339638177583685457921198569105417734668692072727759139358207667248703952436680183153327606147421932365889983347282046439156176685765143620637107347870401946946501620531665573668068349080410807996582297505889946205052879002028936125315312256470583622913646319779125559691270916064588684997382451412747432722966919513413709987353038375477178385125453567111965259721484997156799355617642131569095810304077131053588483057244340742751804935494087687363416921314041547093118565767609667033859583125275322077617576783247853718516166743858265291135353895239981121</span>
<span class="token comment">#gift:  2135492653776686212553329560560967285303308936825887355911916917454772197960682240149821138177216833586509090969892419775958406087994054585022894165950768427741545736247918410255804894522085720642952579638418483800243368312702566458196708508543635051350999572787188236243275631609875253617015664414032058822919469443284453403064076232765024248435543326597418851751586308514540124571309152787559712950209357825576896132278045112177910266019741013995106579484868768251084453338417115483515132869594712162052362083414163954681306259137057581036657441897428432575924018950961141822554251369262248368899977337886190114104</span>
<span class="token comment">#c:  3738960639194737957667684143565005503596276451617922474669745529299929395507971435311181578387223323429323286927370576955078618335757508161263585164126047545413028829873269342924092339298957635079736446851837414357757312525158356579607212496060244403765822636515347192211817658170822313646743520831977673861869637519843133863288550058359429455052676323196728280408508614527953057214779165450356577820378810467527006377296194102671360302059901897977339728292345132827184227155061326328585640019916328847372295754472832318258636054663091475801235050657401857262960415898483713074139212596685365780269667500271108538319</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这题从gift入手，首先gift是(p - 1) 和 (q - 1)的最小公倍数，要找到突破口Φ(n)。最小公倍数*最小公因数=两数的乘积，这样就变成找(p - 1)和(q - 1)的最小公因数。(p - 1) * (q - 1)的二进制为2048位，gift的位数为2045位，这样它们的最小公因数就是3bit，遍历[4,8]，求出Φ(n)后，就是正常的RSA解密操作，不过提米里面还有一个坑：e不是素数，要将其先转化为素数的乘积(2 * 27361)也就c = (m^2)^(e // 2) mod n，最后m要开方。脚本如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gmpy2
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>

e <span class="token operator">=</span> <span class="token number">54722</span>
gift <span class="token operator">=</span> <span class="token number">2135492653776686212553329560560967285303308936825887355911916917454772197960682240149821138177216833586509090969892419775958406087994054585022894165950768427741545736247918410255804894522085720642952579638418483800243368312702566458196708508543635051350999572787188236243275631609875253617015664414032058822919469443284453403064076232765024248435543326597418851751586308514540124571309152787559712950209357825576896132278045112177910266019741013995106579484868768251084453338417115483515132869594712162052362083414163954681306259137057581036657441897428432575924018950961141822554251369262248368899977337886190114104</span>
n <span class="token operator">=</span> <span class="token number">17083941230213489700426636484487738282426471494607098847295335339638177583685457921198569105417734668692072727759139358207667248703952436680183153327606147421932365889983347282046439156176685765143620637107347870401946946501620531665573668068349080410807996582297505889946205052879002028936125315312256470583622913646319779125559691270916064588684997382451412747432722966919513413709987353038375477178385125453567111965259721484997156799355617642131569095810304077131053588483057244340742751804935494087687363416921314041547093118565767609667033859583125275322077617576783247853718516166743858265291135353895239981121</span>
c <span class="token operator">=</span> <span class="token number">3738960639194737957667684143565005503596276451617922474669745529299929395507971435311181578387223323429323286927370576955078618335757508161263585164126047545413028829873269342924092339298957635079736446851837414357757312525158356579607212496060244403765822636515347192211817658170822313646743520831977673861869637519843133863288550058359429455052676323196728280408508614527953057214779165450356577820378810467527006377296194102671360302059901897977339728292345132827184227155061326328585640019916328847372295754472832318258636054663091475801235050657401857262960415898483713074139212596685365780269667500271108538319</span>

<span class="token keyword">for</span> gcd_p_1_q_1 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    phin <span class="token operator">=</span> gcd_p_1_q_1 <span class="token operator">*</span> gift
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">,</span> phin<span class="token punctuation">)</span>
        m_2 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>
        flag <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>gmpy2<span class="token punctuation">.</span>isqrt<span class="token punctuation">(</span>m_2<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
    <span class="token keyword">except</span> ZeroDivisionError<span class="token punctuation">:</span>
        <span class="token keyword">continue</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h2 id="EasyProgram"><a href="#EasyProgram" class="headerlink" title="EasyProgram"></a>EasyProgram</h2><p>题目如下：</p>
<p>附件：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">get buf unsign s<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span>
get buf t<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span>
we have key<span class="token punctuation">:</span>whoami
we have flag<span class="token punctuation">:</span>????????????????????????????????

<span class="token keyword">for</span> i<span class="token punctuation">:</span><span class="token number">0</span> to <span class="token number">256</span>
    <span class="token builtin">set</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>i

<span class="token keyword">for</span> i<span class="token punctuation">:</span><span class="token number">0</span> to <span class="token number">256</span>
    <span class="token builtin">set</span> t<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>key<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>mod<span class="token punctuation">(</span>key<span class="token punctuation">.</span>lenth<span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> i<span class="token punctuation">:</span><span class="token number">0</span> to <span class="token number">256</span>
    <span class="token builtin">set</span> j<span class="token punctuation">:</span><span class="token punctuation">(</span>j<span class="token operator">+</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span>t<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>mod<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span>
        swap<span class="token punctuation">:</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>s<span class="token punctuation">[</span>j<span class="token punctuation">]</span>

<span class="token keyword">for</span> m<span class="token punctuation">:</span><span class="token number">0</span> to <span class="token number">38</span>
    <span class="token builtin">set</span> i<span class="token punctuation">:</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>mod<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span>
    <span class="token builtin">set</span> j<span class="token punctuation">:</span><span class="token punctuation">(</span>j <span class="token operator">+</span> S<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>mod<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span>
    swap<span class="token punctuation">:</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>s<span class="token punctuation">[</span>j<span class="token punctuation">]</span>
    <span class="token builtin">set</span> x<span class="token punctuation">:</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span>j<span class="token punctuation">]</span>mod<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">)</span>mod<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token builtin">set</span> flag<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">:</span>flag<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token operator">^</span>s<span class="token punctuation">[</span>x<span class="token punctuation">]</span>

fprint flagx to <span class="token builtin">file</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>file.txt:</p>
<pre class="line-numbers language-none"><code class="language-none">簭+&quot;烸?K?镝?灸註? z?Q碉&#x3D;??<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>file文件是一个16进制文件，使用winhex打开：</p>
<p><img "" class="lazyload placeholder" data-original="/2021/08/17/BUUCTF-Crypto%E7%B3%BB%E5%88%97-81-96-WP/Post10_image12.png" src="https://img10.360buyimg.com/ddimg/jfs/t1/157667/29/9156/134350/603c6445Ebbc9cabe/41219c5d36d45072.gif"></p>
<p>数了一下刚好是38字节，解密就是对附件里的加密过程的逆。脚本如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gmpy2

flagx<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0xBA</span><span class="token punctuation">,</span><span class="token number">0x8F</span><span class="token punctuation">,</span><span class="token number">0x11</span><span class="token punctuation">,</span><span class="token number">0x2B</span><span class="token punctuation">,</span><span class="token number">0x22</span><span class="token punctuation">,</span><span class="token number">0x9F</span><span class="token punctuation">,</span><span class="token number">0x51</span><span class="token punctuation">,</span><span class="token number">0xA1</span><span class="token punctuation">,</span><span class="token number">0x2F</span><span class="token punctuation">,</span><span class="token number">0xAB</span><span class="token punctuation">,</span><span class="token number">0xB7</span><span class="token punctuation">,</span><span class="token number">0x4B</span><span class="token punctuation">,</span><span class="token number">0xD7</span><span class="token punctuation">,</span><span class="token number">0x3F</span><span class="token punctuation">,</span><span class="token number">0xEF</span><span class="token punctuation">,</span><span class="token number">0xE1</span><span class="token punctuation">,</span><span class="token number">0xB5</span><span class="token punctuation">,</span><span class="token number">0x13</span><span class="token punctuation">,</span><span class="token number">0xBE</span><span class="token punctuation">,</span><span class="token number">0xC4</span><span class="token punctuation">,</span><span class="token number">0xD4</span><span class="token punctuation">,</span><span class="token number">0x5D</span><span class="token punctuation">,</span><span class="token number">0x03</span><span class="token punctuation">,</span><span class="token number">0xD9</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x7A</span><span class="token punctuation">,</span><span class="token number">0xCA</span><span class="token punctuation">,</span><span class="token number">0x1D</span><span class="token punctuation">,</span><span class="token number">0x51</span><span class="token punctuation">,</span><span class="token number">0xA4</span><span class="token punctuation">,</span><span class="token number">0x73</span><span class="token punctuation">,</span><span class="token number">0xB5</span><span class="token punctuation">,</span><span class="token number">0xEF</span><span class="token punctuation">,</span><span class="token number">0x3D</span><span class="token punctuation">,</span><span class="token number">0x9B</span><span class="token punctuation">,</span><span class="token number">0x31</span><span class="token punctuation">,</span><span class="token number">0xB3</span><span class="token punctuation">]</span>
key <span class="token operator">=</span> <span class="token string">"whoami"</span>
s <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
t <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    s<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    t<span class="token punctuation">.</span>append<span class="token punctuation">(</span>key<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

j<span class="token operator">=</span><span class="token number">0</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    j<span class="token operator">=</span><span class="token punctuation">(</span>j<span class="token operator">+</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token builtin">ord</span><span class="token punctuation">(</span>t<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">256</span>
    s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>s<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>s<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span>

i <span class="token operator">=</span> <span class="token number">0</span>
j <span class="token operator">=</span> <span class="token number">0</span>
flag <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">for</span> m <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    i <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span>
    j <span class="token operator">=</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span>
    s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    x <span class="token operator">=</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span>
    flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>flagx<span class="token punctuation">[</span>m<span class="token punctuation">]</span> <span class="token operator">^</span> s<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>运行脚本可得flag。</p>
<hr>
<h2 id="AFCTF2018-BASE"><a href="#AFCTF2018-BASE" class="headerlink" title="[AFCTF2018]BASE"></a>[AFCTF2018]BASE</h2><p>题目如下：</p>
<p>是一个非常大的字符文件，放在这里回炸掉。</p>
<p>base的嵌套，搬运大佬的脚本吧：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> base64

<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">r'flag_encode.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    <span class="token keyword">for</span> a <span class="token keyword">in</span> f<span class="token punctuation">:</span>
        <span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                a <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span>
            <span class="token keyword">except</span><span class="token punctuation">:</span>
                <span class="token keyword">pass</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                a <span class="token operator">=</span> base64<span class="token punctuation">.</span>b32decode<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span>
            <span class="token keyword">except</span><span class="token punctuation">:</span>
                <span class="token keyword">pass</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                a <span class="token operator">=</span> base64<span class="token punctuation">.</span>b16decode<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
            <span class="token keyword">except</span><span class="token punctuation">:</span>
                <span class="token keyword">pass</span>

            <span class="token keyword">if</span> <span class="token string">"&#123;"</span> <span class="token keyword">in</span> a<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
                
                <span class="token keyword">break</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>运行脚本可得flag。</p>
<hr>

      </div>
      <div class="post-tags-categories">
        
        <div class="tags">
          
            <a href="/tags/%E5%8D%9A%E5%AE%A2/" class="">
              博客
            </a>
          
        </div>
        
      </div>
      
        <div class="copyright">
  <ul class="post-copyright">
    <li class="post-copyright-author">
    <strong>author:  </strong>sinanya</a>
    </li>
    <li class="post-copyright-link">
    <strong>link:  </strong>
    <a href="/2021/08/17/BUUCTF-Crypto系列-81-96-WP/" target="_blank" title="BUUCTF-Crypto系列[81-96]WP">https://sinanya.github.io/2021/08/17/BUUCTF-Crypto系列-81-96-WP/</a>
    </li>
    <li class="post-copyright-license">
      <strong>Copyright notice:   </strong>
      All articles on this website, unless otherwise stated, adopt <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">CC BY-NC-ND 4.0</a>
      reprint policy. If reproduced, please indicate source!
    </li>
  </ul>
<div>
      
    </article>
    <!-- 上一篇文章和下一篇文章 -->
    
      <!-- 文章详情页的上一页和下一页 -->
<div class="post-nav">



  
  <div class="post-nav-prev post-nav-item">
    <div class="post-nav-img lazyload" data-original="/medias/8.jpg" style="background-size: cover; 
      background-position: center center;">
    </div>
    <a href="/2021/08/26/CTFSHOW-%E5%90%83%E7%93%9C%E6%9D%AF-Crypto%E7%B3%BB%E5%88%97/" class="post-nav-link">
      <div class="title">
        <i class="fa fa-angle-left"></i> Prev:
        <div class="title-text">CTFSHOW-吃瓜杯-Crypto系列</div>
      </div>
      
      <!-- <div class="content">
        闪电五连鞭·一鞭题目如下：
1bian.sage:
from Crypto.Util.number import *


      </div> -->
    </a>
  </div>



  
  <div class="post-nav-next post-nav-item">
    <div class="post-nav-img lazyload" data-original="/medias/6.jpg" style="background-size: cover; 
      background-position: center center;">
    </div>
    <a href="/2021/08/07/BUUCTF-Crypto%E7%B3%BB%E5%88%97-65-80-WP/" class="post-nav-link">
      <div class="title">
        Next: <i class="fa fa-angle-right"></i>
        <div class="title-text">BUUCTF-Crypto系列[65-80]WP</div>
      </div>
      <!-- <div class="content">
        浪里淘沙题目如下：

tonightsuccessnoticenoticewewesuccesstonightweexa
      </div> -->
    </a>
  </div>

</div>

    
    

    <!-- 打赏 -->
    

    <!-- 分享 -->
    
      <!-- https://github.com/overtrue/share.js -->
<!-- 文章详情页的分享 -->
<div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>

<script src="/js/shareJs/social-share.min.js"></script>
</script>

<style>
  .social-share {
    margin: 20px 0;
  }
</style>


    
    
    <!-- 评论 -->
    <!-- 评论 -->

  <div id="myComment">
    
      
<section id="comments" style="padding: 1em; margin: 15px auto;"
	class="animated bounceInUp">
	<div id="vcomment" class="comment"></div>
</section>
<style>
	#comments {
		background: rgba(255,255,255,0.9);
	}
	#veditor {
		background-image: url('https://img.zcool.cn/community/01a253594c71cfa8012193a329a77f.gif');
		background-size: contain;
		background-repeat: no-repeat;
		background-position: right;
		background-color: rgba(255, 255, 255, 0);
		resize: vertical;
	}
	#veditor:focus{
		background-position-y: 200px;
		transition: all 0.2s ease-in-out 0s;
	}
	#vcomment .vcards .vcard .vh .vhead .vtag.vvisitor {
		background-color: #42b983;
	}
	.v[data-class=v] .vbtn:active, .v[data-class=v] .vbtn:hover {
		color: #42b983;
		border-color: #42b983;
	}
	#vcomment .vcards .vcard .vhead .vsys i {
		display: none;
	}
	/* 底部valine链接 */
	#vcomment .vpower {
		display: none;
	}
	
	/* 底下注释是修改 名称和邮箱和网址输入框的样式 */
	/* #vcomment .vheader {
		display: flex;
		justify-content: space-around;
	}
	
	#vcomment .vheader .vnick {
		width: 31%;
		border: 2px solid #dedede;
		padding-left: 10px;
		padding-right: 10px;
		border-radius: 5px
	}

	#vcomment .vheader .vmail {
		width: 31%;
		border: 2px solid #dedede;
		padding-left: 10px;
		padding-right: 10px;
		border-radius: 5px
	}

	#vcomment .vheader .vlink {
		width: 31%;
		border: 2px solid #dedede;
		padding-left: 10px;
		padding-right: 10px;
		border-radius: 5px
	} */

	img.vimg {
		transition: all 1s;
		/* 头像旋转时间为 1s */
	}

	img.vimg:hover {
		transform: rotate(360deg);
		-webkit-transform: rotate(360deg);
		-moz-transform: rotate(360deg);
		-o-transform: rotate(360deg);
		-ms-transform: rotate(360deg);
	}

	#vcomment .vcards .vcard {
		padding: 15px 20px 0 20px;
		border-radius: 10px;
		margin-bottom: 15px;
		box-shadow: 0 0 4px 1px rgba(0, 0, 0, .12);
		transition: all .3s
	}

	#vcomment .vcards .vcard:hover {
		box-shadow: 0 0 8px 3px rgba(0, 0, 0, .12)
	}

	#vcomment .vcards .vcard .vh .vcard {
		border: none;
		box-shadow: none;
	}
</style>
    
  </div>


  </div>

  <!-- 目录 -->
  <!-- 文章详情页右侧目录 -->

  <div class="toc-aside">
    <div class="toc-main">
      <div class="toc-aside-title">
        <i class="fa fa-list-ul" aria-hidden="true"></i><span>catalog</span>
        
          <div class="toc-open-close">catalog</div>
        
      </div>
      <div class="toc-content">
        <div class="toc"></div>
      </div>
    </div>
  </div>
  <!-- js在scripts目录下的的toc.ejs里面 -->
  

  <script>
    function openBtnClickFn () {
      let openOrCloseBtn = $('.toc-aside .toc-aside-title .toc-open-close');
      let open = eval('' || 'true');
      openOrCloseBtn.click(function() {
        if (open === true) {
          $(".toc-aside").css({'width': 0, 'padding': 0});
          $(".toc-content").css({'width': 0});
          $(".toc-aside-title span, .toc-aside-title i").css({'display': 'none'});
          $(".main-content").css({'width': '75%', 'margin': '10px auto'});
          open = false;
        } else {
          $(".toc-aside").css({'width': '300px', 'padding': '0 10px'});
          $(".toc-content").css({'width': '300px'});
          $(".toc-aside-title span, .toc-aside-title i").css({'display': 'inline-block'});
          $(".main-content").css({'width': '65%', 'margin-right': '10px', 'margin-left': 'calc(35% - 350px)'});
          open = true;
        }
      });
    };
    openBtnClickFn();
    document.addEventListener('pjax:complete', function () {
      openBtnClickFn();
    })
  </script>


  

  <!-- 图片放大 Wrap images with fancybox support -->
  <script src="/js/wrapImage.js"></script>
</div>

<!-- 文章详情页背景图 -->
<div id="appBgSwiper" style="position: fixed;left: 0;top: 0;width: 100%;height: 100%;z-index: -2;" :style="{'background-color': bgColor ? bgColor : 'transparent'}">
    <transition-group tag="ul" :name="names">
        <li v-for='(image,index) in img' :key='index' v-show="index === mark" class="bg-swiper-box">
            <img :src="image" class="bg-swiper-img">
        </li>
    </transition-group>
</div>
<script>
    var vm = new Vue({
        el: '#appBgSwiper',
        data: {
            names: '' || 'fade' || 'fade', // translate-fade fade
            mark: 0,
            img: [],
            bgColor: '',
            time: null
        },
        methods: {   //添加方法
            change(i, m) {
                if (i > m) {
                    // this.names = 'fade';
                } else if (i < m) {
                    // this.names = 'fade';
                } else {
                    return;
                }
                this.mark = i;
            },
            prev() {
                // this.names = 'fade';
                this.mark--;
                if (this.mark === -1) {
                    this.mark = 3;
                    return
                }
            },
            next() {
                // this.names = 'fade';
                this.mark++;
                if (this.mark === this.img.length) {
                    this.mark = 0;
                    return
                }
            },
            autoPlay() {
                // this.names = 'fade';
                this.mark++;
                if (this.mark === this.img.length) {
                    this.mark = 0;
                    return
                }
            },
            play() {
                let bgImgDelay = '' || '180000'
                let delay = parseInt(bgImgDelay) || 180000;
                this.time = setInterval(this.autoPlay, delay);
            },
            enter() {
                clearInterval(this.time);
            },
            leave() {
                this.play();
            }
        },
        created() {
            this.play()
        },
        beforeDestroy() {
            clearInterval(this.time);
        },
        mounted() {
            let prop = ''|| '';
            let isImg = prop.includes('.bmp') || prop.includes('.jpg') || prop.includes('.png') || prop.includes('.tif') || prop.includes('.gif') || prop.includes('.pcx') || prop.includes('.tga') || prop.includes('.exif') || prop.includes('.fpx') || prop.includes('.psd') || prop.includes('.cdr') || prop.includes('.pcd') || prop.includes('.dxf') || prop.includes('.ufo') || prop.includes('.eps') || prop.includes('.ai') || prop.includes('.raw') || prop.includes('.WMF') || prop.includes('.webp') || prop.includes('.jpeg') || prop.includes('http://') || prop.includes('https://') 
            if (isImg) {
                let img = prop.split(',');
                let configRoot = '/'
                let arrImg = [];
                img.forEach(el => {
                    var Expression=/http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- .\/?%&=]*)?/;
			        var objExp = new RegExp(Expression);

                    if(objExp.test(el)) {
                        // http or https
                        arrImg.push(el);
                    } else {
                        // 非http or https开头
                        // 本地文件
                        let firstStr = el.charAt(0);
                        if (firstStr == '/') {
                            el = el.substr(1); // 删除第一个字符 '/',因为 configRoot最后一个字符为 /
                        }
                        el = configRoot + el;
                        arrImg.push(el);
                    }
                })
                this.img = arrImg;
            } else {
                this.bgColor = prop;
            }
        }
    })
</script>

<style>
    .bg-swiper-box {
        position: absolute;
        display: block;
        width: 100%;
        height: 100%;
    }
    .bg-swiper-img {
        object-fit: cover;
        width: 100%;
        height: 100%;
    }
</style>

    </main>

    <!-- 页脚 -->
    <div class="footer bg-color">
  <div class="footer-main">
    <div class="link">
      
    </div>
    <div class="footer-copyright">
      <p>Copyright © 2019 - 2020 <a target="_blank" rel="noopener" href="https://github.com/yuang01">yuang01</a> | Powered by <a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/docs/">Hexo</a> | Theme <a target="_blank" rel="noopener" href="https://github.com/yuang01/theme">Bamboo</a> </p>

    </div>
    <div class="footer-custom">
      
    </div>
    <!-- 不蒜子统计 -->
    
      
  <!-- 不蒜子统计 -->
  <span id="busuanzi_container_site_pv">
        <i class="fa fa-eye" aria-hidden="true"></i>Total visits：<span id="busuanzi_value_site_pv"></span> times
  </span>
  <span class="post-meta-divider">|</span>
  <span id="busuanzi_container_site_uv" style='display:none'>
        <i class="fa fa-users" aria-hidden="true"></i>Number of visitors：<span id="busuanzi_value_site_uv"></span> people
  </span>
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" data-pjax></script>

    
  </div>
</div>


    <!-- 渲染暗黑按钮 -->
    
      <div class="dark">
  <div class="dark-content">
    <i class="fa fa-moon-o" aria-hidden="true"></i>
    <!-- <span>关灯</span> -->
  </div>
  
</div>

<script>
  $(function() {
    let isDark = JSON.parse(localStorage.getItem('dark'))  || JSON.parse('false');
    if (isDark) {
      $(".dark-content").replaceWith(
          `
          <div class='dark-content'>
            <i class="fa fa-lightbulb-o" aria-hidden="true"></i>
          </div>
          `
        );
    }
    $('.dark').click(function() {
      if ($(document.body).is('.darkModel')) {
        $(document.body).removeClass('darkModel');
        localStorage.setItem('dark', false);
        $(".dark-content").replaceWith(
          `
          <div class='dark-content'>
            <i class="fa fa-moon-o" aria-hidden="true"></i>
          </div>
          `
        );
      } else {
        $(document.body).addClass('darkModel');
        localStorage.setItem('dark', true);
        $(".dark-content").replaceWith(
          `
          <div class='dark-content'>
            <i class="fa fa-lightbulb-o" aria-hidden="true"></i>
          </div>
          `
        );
      }
    })
  })
</script>
    
    <!-- 渲染回到顶部按钮 -->
    
      <div class="goTop top-btn-color" pointer>
  <i class="fa fa-arrow-up" aria-hidden="true"></i>
</div>
<script src="/js/goTop.js"></script>
    
    <!-- 渲染左下角音乐播放器 -->
    

    <!-- 图片放大 -->
    
      <script src="/js/fancybox/jquery.fancybox.min.js"></script>
    

    <!-- 百度解析 -->
    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <!-- 背景彩带 -->
    
    
    <script src="/js/app.js" data-pjax></script>
    
    <!-- 文章目录所需js -->
<link href="/js/tocbot/tocbot.css" rel="stylesheet">
<script src="/js/tocbot/tocbot.min.js"></script>

<script>
  var headerEl = 'h2, h3, h4',  //headers 
      content = '.post-detail',//文章容器
      idArr = {};  //标题数组以确定是否增加索引id
      //add #id
  var option = {
    // Where to render the table of contents.
    tocSelector: '.toc',
    // Where to grab the headings to build the table of contents.
    contentSelector: content,
    // Which headings to grab inside of the contentSelector element.
    headingSelector: headerEl,
    scrollSmooth: true,
    scrollSmoothOffset: -80,
    headingsOffset: -($(window).height() * 0.4 - 45),
    positionFixedSelector: '.toc-main',
    positionFixedClass: 'is-position-fixed',
    fixedSidebarOffset: 'auto',
  }
  if ($('.toc').length > 0) {

    $(content).children(headerEl).each(function () {
      //去除空格以及多余标点
      var headerId = $(this).text().replace(/[\s|\~|`|\!|\@|\#|\$|\%|\^|\&|\*|\(|\)|\_|\+|\=|\||\|\[|\]|\{|\}|\;|\:|\"|\'|\,|\<|\.|\>|\/|\?|\：|\，|\。]/g, '');

      headerId = headerId.toLowerCase();
      if (idArr[headerId]) {
        //id已经存在
        $(this).attr('id', headerId + '-' + idArr[headerId]);
        idArr[headerId]++;
      }
      else {
        //id未存在
        idArr[headerId] = 1;
        $(this).attr('id', headerId);
      }
    });

    tocbot.init(option);
    
  }


  document.addEventListener('pjax:send', function () {
    if ($('.toc').length) {
      tocbot.destroy();
    }
  });

  document.addEventListener('pjax:complete', function () {
    if ($('.toc').length) {
      tocbot.init(option);
    }
  });

  
</script>

<style>
.is-position-fixed {
  position:sticky !important;
  top: 74px;
}
.toc-main ul {
  counter-reset: show-list;
}
.toc-main ul li::before {
  content: counter(item)".";
  display: block;
  position: absolute;
  left: 12px;
  top:0;
}
/* .toc > .toc-list {
  padding-left: 35px;
}
.toc>.toc-list li {
  list-style: decimal;
}
.toc-list {
  padding-left: 25px;
} */
</style> 

<!-- 渲染issues标签里的内容 -->
<script>
  function loadIssuesJS() {
    if ($(".post-detail").find(".issues-api").length == 0) {
      return;
    } 
    loadScript('/js/issues/index.js');
  };
  $(function () {
    loadIssuesJS();
  });
  document.addEventListener('pjax:complete', function () {
    if (typeof IssuesAPI == "undefined") {
      loadIssuesJS();
    }
  })
</script>

<!-- div滚动到显示区域的动画 -->

  <script src="/js/aos/aos.js"></script>
  <script>
    // https://github.com/michalsnik/aos
    var themeOffset = parseInt('120') || 120;
    var themeDelay = parseInt('0') || 0;
    var themeDuration = parseInt('400') || 400;
    var themeEasing = 'ease' || 'ease';
    var themeOnce = eval('true') || false;
    var themeMirror = eval('false') || false;
    var themeAnchorPlacement = 'top-bottom' || 'top-bottom';
    AOS.init({
      // Global settings:
      disable: false, // accepts following values: 'phone', 'tablet', 'mobile', boolean, expression or function
      startEvent: 'DOMContentLoaded', // name of the event dispatched on the document, that AOS should initialize on
      initClassName: 'aos-init', // class applied after initialization
      animatedClassName: 'aos-animate', // class applied on animation
      useClassNames: false, // if true, will add content of `data-aos` as classes on scroll
      disableMutationObserver: false, // disables automatic mutations' detections (advanced)
      debounceDelay: 50, // the delay on debounce used while resizing window (advanced)
      throttleDelay: 99, // the delay on throttle used while scrolling the page (advanced)

      // Settings that can be overridden on per-element basis, by `data-aos-*` attributes:
      offset: themeOffset, // offset (in px) from the original trigger point
      delay: themeDelay, // values from 0 to 3000, with step 50ms
      duration: themeDuration, // values from 0 to 3000, with step 50ms
      easing: themeEasing, // default easing for AOS animations
      once: themeOnce, // whether animation should happen only once - while scrolling down
      mirror: themeMirror, // whether elements should animate out while scrolling past them
      anchorPlacement: themeAnchorPlacement, // defines which position of the element regarding to window should trigger the animation

    });

    document.addEventListener('pjax:complete', function () {
      AOS.refresh();
    })
  </script>


<!-- 输入框打字特效 -->
<!-- 输入框打字特效 -->

  <script src="/js/activate-power-mode.js"></script>
  <script>
    POWERMODE.colorful = true;  // 打开随机颜色特效
    POWERMODE.shake = false;    // 关闭输入框抖动
    document.body.addEventListener('input', POWERMODE);//监听打字事件
  </script>


<!-- markdown代码一键复制功能 -->

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/v-plugs-ayu/lib/ayu.css">
  <script src="https://cdn.jsdelivr.net/npm/v-plugs-ayu/lib/ayu.umd.min.js"></script>
  <script src="/js/clipboard/clipboard.min.js"></script>
  <div id="appCopy">
  </div>
  <script data-pjax>
    var vm = new Vue({
      el: '#appCopy',
      data: {
      },
      computed: {
      },
      mounted() {
        const that = this;
        var copy = 'copy';
        /* code */
        var initCopyCode = function () {
          var copyHtml = '';
          copyHtml += '<button class="btn-copy" data-clipboard-snippet="" style="position:absolute;top:0;right:0;z-index:1;">';
          copyHtml += '<i class="fa fa-copy"></i><span>' + copy + '</span>';
          copyHtml += '</button>';
          $(".post-detail pre").not('.gutter pre').wrap("<div class='codeBox' style='position:relative;width:100%;'></div>")
          $(".post-detail pre").not('.gutter pre').before(copyHtml);
          new ClipboardJS('.btn-copy', {
            target: function (trigger) {
              return trigger.nextElementSibling;
            }
          });
        }
        initCopyCode();
        $('.btn-copy').unbind('click').bind('click', function () {
          doSomething();
        })
        $(document).unbind('keypress').bind('keypress', function (e) {
          if (e.ctrlKey && e.keyCode == 67) {
            doSomething();
            // 返回false, 防止重复触发copy事件  
            // return false;
          }
        })
        //  监听 ctrl + c事件  
        // $(document).unbind('keypress').bind('keypress', function (e) {
        //   if (e.ctrlKey && e.keyCode == 67) {
        //     doSomething();
        //     // 返回false, 防止重复触发copy事件  
        //     return false;
        //   }
        // })

        // // 鼠标右键的复制事件  
        // $(document).unbind('copy').bind('copy', function (e) {
        //   doSomething();
        // });

        function doSomething() {
          that.$notify({
            title: "成功",
            content: "代码已复制，请遵守相关授权协议。",
            type: 'success'
          })
        }
      },
      methods: {
      },
      created() { }
    })
  </script>


<!-- 图片懒加载 -->
<script src="/js/lazyload/lazyload@1.9.1.js"></script>
<script data-pjax>
  $(function () {
    $("div.lazyload, img.lazyload, a.lazyload").lazyload(
      {
        effect: "show",
        placeholder: "https://img10.360buyimg.com/ddimg/jfs/t1/159345/8/2271/222193/5ff7b36fEe49f5663/a95287c20385127f.gif"    //图片未加载出来时显示的占位图
      }
    );
  });
</script>

<!-- 评论所需js -->

    
        <!-- 弹幕所需的css和js -->
        
<!-- 具体js，请前往valine/script.ejs查看 -->

        <script>
  var requiredFields = '';
  requiredFields = requiredFields.split(',');
  comment_el = '.comment';
  let looperValine = null;
  load_valine = function () {
    if ($(comment_el).length) {
      var valine = new Valine({
        el: '#vcomment',
        path: window.location.pathname,
        notify: false,
        verify: false,
        app_id: "",
        app_key: "",
        placeholder: "客官，说点什么吧",
        avatar: "",
        master: "",   //博主邮箱md5
        tagMeta: ["博主","小伙伴","访客"],     //标识字段名
        friends: "",
        metaPlaceholder: { "nick": "昵称/QQ号", "mail": "邮箱" },
        requiredFields: requiredFields,
        enableQQ: true,
      });
      function debounce(fn) {
        var timerID = null
        return function () {
          var arg = arguments[0]   //获取事件
          if (timerID) {
            clearTimeout(timerID)
          }
          timerID = setTimeout(function () {
            fn(arg)              //事件传入函数
          }, 200)
        }
      }
      //查询评论 valine.Q('*').limit(7) -- 查询所有，限制7条, 下面的的代码是查询当前页面
      var themeDanmu = eval('false');
      var themeLoop = eval('false');
      var themeLooperTime = '5000' || 5000;
      var speed = '40' || 20;
      var isBarrager = true;
      if (themeDanmu == true) {
        do_barrager();
        if ($('.danmuBox').length <= 0) {
          $('.navbar').append('<div class="danmuBox"><div class="danmuBtn open"><span class="danmuCircle"></span><span class="danmuText">弹幕</span></div></div>');
        }
        $('.danmuBtn').on('click', debounce(
          function () {
            if ($('.danmuBtn').hasClass('open')) {
              $('.danmuBtn').removeClass('open')
              clearInterval(looperValine);
              $.fn.barrager.removeAll();
            } else {
              $('.danmuBtn').addClass("open");
              do_barrager();
            }
          }
        ))
      }
      function do_barrager() {
        isBarrager && valine.Q(window.location.pathname).find().then(function (comments) {
          // var num = 0; // 可以记录条数，循环调用的时候只取最新的评论放入弹幕中
          var run_once = true;
          var looper_time = themeLooperTime;
          var total = comments.length;
          // var looper = null;
          var index = 0;
          if (total > 0) {
            barrager();
          } else {
            // 当评论数为0的时候，自动关闭弹幕
            // $('.danmuBtn').removeClass('open');
          }
          function barrager() {
            if (run_once) {
              //如果是首次执行,则设置一个定时器,并且把首次执行置为false
              looperValine = setInterval(barrager, looper_time);
              run_once = false;
            }
            var content = comments[index]._serverData.comment;
            var email = comments[index]._serverData.mail;
            var link = comments[index]._serverData.link;
            var newcontent = content.substring(0, 50).replace(/<[^>]+>/g, "");
            //发布一个弹幕
            const item = {
              img: `https://q1.qlogo.cn/g?b=qq&nk=${email}&s=640`, //图片 
              info: newcontent, //文字 
              href: link, //链接 
              close: true, //显示关闭按钮 
              speed: speed, //延迟,单位秒,默认6 
              color: '#fff', //颜色,默认白色 
              old_ie_color: '#000000', //ie低版兼容色,不能与网页背景相同,默认黑色
            }
            $('body').barrager(item);
            //索引自增
            index++;
            //所有弹幕发布完毕，清除计时器。
            if (index == total) {
              clearInterval(looperValine);
              if (themeLoop === true) {
                setTimeout(function () {
                  do_barrager();
                }, 5000);
              } else {
                $('.danmuBtn').removeClass('open');
              }
              return false;
            }

          }
        })
      }
    }
  };
  $(document).ready(load_valine);
  document.addEventListener('pjax:send', function (e) {
    
  })
  document.addEventListener('pjax:complete', function () {
    load_valine();
  });
</script>
    


<!-- 鼠标点击特效 -->
<!-- 爱心点击 -->




    <!-- pjax -->
    

<!-- pjax -->


  <script src="/js/pjax@0.2.8/index.js"></script>
  
    <!-- 样式位于：source/css/_third-party/pjaxanimate.styl -->

<div class="pjax-animate">
  
    <div class="loading-circle"><div id="loader-circle"></div></div>
    <script>
      window.ShowLoading = function() {
        $(".loading-circle").css("display", "block");
      };
      window.HideLoading = function() {
        $(".loading-circle").css("display", "none");
      }
    </script>
  
	<script>
    document.addEventListener('pjax:complete', function () {
      window.HideLoading();
    })
    document.addEventListener('pjax:send', function () {
      window.ShowLoading();
    })
    document.addEventListener('pjax:error', function () {
      window.HideLoading();
    })
	</script>
</div>

  

  <script>
    var pjax = new Pjax({
      elements: 'a[href]:not([href^="#"]):not([href="javascript:void(0)"])',   // 拦截正常带链接的 a 标签
      selectors: ["#pjax-container","title"],                                   // 根据实际需要确认重载区域
      cacheBust: false,   // url 地址追加时间戳，用以避免浏览器缓存
      timeout: 5000
    });

    document.addEventListener('pjax:send', function (e) {

      try {
        var currentUrl = window.location.pathname;
        var targetUrl = e.triggerElement.href;
        var banUrl = [""];
        if (banUrl[0] != "") {
          banUrl.forEach(item => {
            if(currentUrl.indexOf(item) != -1 || targetUrl.indexOf(item) != -1) {
              window.location.href = targetUrl;
            }
          });
        }
      } catch (error) {}

      $(window).unbind('resize');
      $(window).unbind('scroll');
      $(document).unbind('scroll');
      $(document).unbind('click');
      $('body').unbind('click');

    })
    
    document.addEventListener('pjax:complete', function () {
      $('script[data-pjax], .pjax-reload script').each(function () {
        $(this).parent().append($(this).remove());
      });
    });

    document.addEventListener('pjax:error', function (e) {
      window.location.href = e.triggerElement.href;
    })
  </script>



  </body>
</html>