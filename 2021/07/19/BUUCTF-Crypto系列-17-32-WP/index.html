<!DOCTYPE html>
<html lang="zh-Hans">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
    
    <meta name="referrer" content="no-referrer-when-downgrade">
    
    <meta name="renderer" content="webkit"/>
    <meta name="force-rendering" content="webkit"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <script>if (/*@cc_on!@*/false || (!!window.MSInputMethodContext && !!document.documentMode)) window.location.href="https://support.dmeng.net/upgrade-your-browser.html?referrer="+encodeURIComponent(window.location.href); </script>
    
    
        <link rel="preload" crossorigin="crossorigin" href="/fonts/roboto/Roboto-Regular.woff2" as="font">
        <link rel="preload" crossorigin="crossorigin" href="/fonts/roboto/Roboto-Bold.woff2" as="font">
    
    
    
        <link rel="shortcut icon" href="/icons/favicon.ico">
    

    
    
        
<link rel="stylesheet" href="/css/mdui.min.v1.0.0.css">

    
    
<link rel="stylesheet" href="/css/main.css">
<link rel="stylesheet" href="/css/iconfont.css">


    
    

    
        <script data-ad-client="ca-" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    












          


    
    
    <title>
        
            BUUCTF-Crypto系列[17-32]WP | 司南的博客
        
    </title>
    
    
<meta name="generator" content="Hexo 5.4.0"></head>
<body class="mdui-drawer-body-left mdui-appbar-with-toolbar mdui-theme-primary-teal mdui-theme-accent-blue">
  
  <header class="mdui-appbar mdui-appbar-fixed">
  <div id="toolbar" class="mdui-toolbar mdui-color-theme">
    <button class="mdui-btn mdui-btn-icon" mdui-drawer="{target: '#sidebar', swipe: true}"><i class="iconfont icon-menu"></i></button>
    <a href="/" class="mdui-typo-headline">司南的博客</a>
    <a href="/" class="header-subtitle mdui-typo-headline"></a>
    <div class="mdui-toolbar-spacer"></div>
    <button class="mdui-btn mdui-btn-icon" mdui-dialog="{target: '#search'}" mdui-tooltip="{content: 'search'}"><i class="iconfont icon-search"></i></button>
  </div>
</header>

<div class="mdui-dialog" id="search">
  
    <div class="search-form">
      <input type="search" class="search-form-input" placeholder="请输入关键字" onfocus="listenSearchFunc()">
    </div>
    <div class="search-result" data-resource="/search.xml"></div>
  
</div>

  <aside id="sidebar" class="mdui-drawer">
    <div class="mdui-tab" mdui-tab>
        <a href="#sidebar-tab1" id="sidebartab" class="mdui-ripple mdui-tab-active">站点概览</a>
        <a href="#sidebar-tab2" id="sidebartab" class="mdui-ripple">关于</a>
    </div>

    
    <div id="sidebar-tab1" class="mdui-p-a-1">
        <div class="mdui-list">
            
                
                <a href="/" class="mdui-list-item mdui-ripple">
                    <div class="mdui-list-item-icon">
                        <i class="iconfont icon-home"></i>
                    </div>
                    <div class="mdui-list-item-content">主页</div>
                </a>
            
                
                <a href="/tags/" class="mdui-list-item mdui-ripple">
                    <div class="mdui-list-item-icon">
                        <i class="iconfont icon-bookmark"></i>
                    </div>
                    <div class="mdui-list-item-content">标签</div>
                </a>
            
                
                <a href="/categories/" class="mdui-list-item mdui-ripple">
                    <div class="mdui-list-item-icon">
                        <i class="iconfont icon-folder"></i>
                    </div>
                    <div class="mdui-list-item-content">分类</div>
                </a>
            
                
                <a href="/archives/" class="mdui-list-item mdui-ripple">
                    <div class="mdui-list-item-icon">
                        <i class="iconfont icon-archive"></i>
                    </div>
                    <div class="mdui-list-item-content">归档</div>
                </a>
            
                
                <a href="/tools/" class="mdui-list-item mdui-ripple">
                    <div class="mdui-list-item-icon">
                        <i class="iconfont icon-tools"></i>
                    </div>
                    <div class="mdui-list-item-content">工具箱</div>
                </a>
            
                
                <a href="/about/" class="mdui-list-item mdui-ripple">
                    <div class="mdui-list-item-icon">
                        <i class="iconfont icon-user"></i>
                    </div>
                    <div class="mdui-list-item-content">关于</div>
                </a>
            
            <div class="mdui-list-item mdui-ripple">
                <div class="mdui-list-item-icon">
                    <i class="iconfont icon-moon"></i>
                </div>
                <div class="mdui-list-item-content">夜间模式</div>
                <label class="mdui-switch" id="darkmode">
                  <input type="checkbox" id="nightmode_switch"/>
                  <i class="mdui-switch-icon"></i>
                </label>
            </div>           
        </div>
    </div>

    
    <div id="sidebar-tab2" class="mdui-p-a-1">
        <div class="sidebar-overview">
            <div class="sidebar-avatar">
                
                    <img src="/icons/avatar.gif"/>
                
            </div>
            <div class="sidebar-author-name">sinanya</div>
            <div class="sidebar-description"></div>
        </div>
        <div class="sidebar-links">
            
                
                <div class="mdui-chip">
                    <span class="mdui-chip-icon"><i class="iconfont icon-mail"></i></span>
                    <a href="/1019186955@qq.com" class="mdui-chip-title">E-Mail</a>
                </div>
            
                
                <div class="mdui-chip">
                    <span class="mdui-chip-icon"><i class="iconfont icon-github"></i></span>
                    <a target="_blank" rel="noopener" href="https://github.com/sinanya/sinanya.github.io" class="mdui-chip-title">GitHub</a>
                </div>
            
                
                <div class="mdui-chip">
                    <span class="mdui-chip-icon"><i class="iconfont icon-steam"></i></span>
                    <a target="_blank" rel="noopener" href="https://your.url" class="mdui-chip-title">Steam</a>
                </div>
            
                
                <div class="mdui-chip">
                    <span class="mdui-chip-icon"><i class="iconfont icon-weibo"></i></span>
                    <a target="_blank" rel="noopener" href="https://weibo.com/7195254426/profile?topnav=1&wvr=6&is_all=1" class="mdui-chip-title">Weibo</a>
                </div>
            
        </div>
        <ul class="mdui-list" mdui-collapse="{accordion: true}">
            <li class="mdui-collapse-item">
                <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
                    <div class="mdui-list-item-icon">
                        <i class="iconfont icon-link"></i>
                    </div>
                    <div class="mdui-list-item-content">友情链接</div>
                    <div class="mdui-collapse-item-arrow">
                        <i class="mdui-list-item-icon iconfont icon-angle-down"></i>
                    </div>
                </div>
                <ul id="linksList" class="mdui-collapse-item-body mdui-list mdui-list-dense">
                    
                        <a target="_blank" rel="noopener" href="https://garybear.cn/hexo-theme-meadow/" class="mdui-list-item mdui-ripple">
                            Meadow说明文档
                        </a>
                    
                        <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_51761376?spm=1000.2115.3001.5343/" class="mdui-list-item mdui-ripple">
                            CSDN博客
                        </a>
                    
                </ul>
            </li>
        </ul>
    </div>

    <div class="mdui-divider"></div>
    
    
</aside>
  
  <main id="main-contain" class="mdui-container mdui-m-t-5">
    <article id="article" class="mdui-card mdui-p-b-2 mdui-m-b-5">
  <header class="mdui-card-media">
    
    
      <div class="post-header"> 
  <a class="post-header-title" href="/2021/07/19/BUUCTF-Crypto%E7%B3%BB%E5%88%97-17-32-WP/">BUUCTF-Crypto系列[17-32]WP</a>
  <div class="post-header-meta">
    <span>
      <span class="iconfont icon-calendar"></span>
      发布于:&nbsp;2021-07-19
    </span>
    <span>
      <span class="iconfont icon-calendar-check"></span>
      更新于:&nbsp;2021-07-29
    </span>
    <span>
      <span class="iconfont icon-folder"></span>
      分类于:&nbsp;<a class="category-link" href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/">密码学</a> > <a class="category-link" href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/BUUCTF/">BUUCTF</a>
    </span>
    
      <span>
        <span class="iconfont icon-eye"></span>
        阅读次数:&nbsp;
        <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv"></span></span>
      </span>
    
  </div>
</div>   
    



    
    
    <div class="mdui-card-menu">
    
      <button class="mdui-btn mdui-btn-icon mdui-text-color-teal" mdui-menu="{target: '#share_menu', align: 'right'}"><i class="iconfont icon-share"></i></button>
      <ul class="mdui-menu" id="share_menu">
        <li class="mdui-menu-item">
          <a href="http://service.weibo.com/share/share.php?appkey=&title=BUUCTF-Crypto系列[17-32]WP&url=https://sinanya.github.io/2021/07/19/BUUCTF-Crypto%E7%B3%BB%E5%88%97-17-32-WP/&pic=https://sinanya.github.io/null&searchPic=false&style=simple" target="_blank" class="mdui-ripple">分享到 Weibo</a>
        </li>
        <li class="mdui-menu-item">
          <a href="https://twitter.com/intent/tweet?text=BUUCTF-Crypto系列[17-32]WP&url=https://sinanya.github.io/2021/07/19/BUUCTF-Crypto%E7%B3%BB%E5%88%97-17-32-WP/&via=sinanya" target="_blank" class="mdui-ripple">分享到 Twitter</a>
        </li>
        <li class="mdui-menu-item">
          <a href="https://www.facebook.com/sharer/sharer.php?u=https://sinanya.github.io/2021/07/19/BUUCTF-Crypto%E7%B3%BB%E5%88%97-17-32-WP/" target="_blank" class="mdui-ripple">分享到 Facebook</a>
        </li>
        <li class="mdui-menu-item">
          <a href="https://plus.google.com/share?url=https://sinanya.github.io/2021/07/19/BUUCTF-Crypto%E7%B3%BB%E5%88%97-17-32-WP/" target="_blank" class="mdui-ripple">分享到 Google+</a>
        </li>
        <li class="mdui-menu-item">
          <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://sinanya.github.io/2021/07/19/BUUCTF-Crypto%E7%B3%BB%E5%88%97-17-32-WP/&title=BUUCTF-Crypto系列[17-32]WP" target="_blank" class="mdui-ripple">分享到 LinkedIn</a>
        </li>
        <li class="mdui-menu-item">
          <a href="http://connect.qq.com/widget/shareqq/index.html?site=司南的博客&title=BUUCTF-Crypto系列[17-32]WP&summary=&pics=https://sinanya.github.io/null&url=https://sinanya.github.io/2021/07/19/BUUCTF-Crypto%E7%B3%BB%E5%88%97-17-32-WP/" target="_blank" class="mdui-ripple">分享到 QQ</a>
        </li>
        <li class="mdui-menu-item">
          <a href="https://telegram.me/share/url?url=https://sinanya.github.io/2021/07/19/BUUCTF-Crypto%E7%B3%BB%E5%88%97-17-32-WP/&text=BUUCTF-Crypto系列[17-32]WP" target="_blank" class="mdui-ripple">分享到 Telegram</a>
        </li>
      </ul>
    
  </div>
  </header>
  
  
  
  
  <div class="post-tags">
    
      <i class="iconfont icon-tag">
        <a rel="tag" href = /tags/%E5%8D%9A%E5%AE%A2/ >博客</a>
      </i>
    
  </div>

  
  <div class="mdui-card-content mdui-typo mdui-p-x-4">
    <h2 id="信息化时代的步伐"><a href="#信息化时代的步伐" class="headerlink" title="信息化时代的步伐"></a>信息化时代的步伐</h2><p>点开附件，密文如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">606046152623600817831216121621196386</span></span><br></pre></td></tr></table></figure>

<p>一看到密文，我的第一想法是诺基亚键盘密码，但是诺基亚键盘上的”0”并没有字母，所以这不是诺基亚键盘密码。搜索发现这是<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E4%B8%AD%E6%96%87%E7%94%B5%E7%A0%81/2667759?fr=aladdin">中文电码</a>（又学到新知识了），和摩斯电码类似。由于字典的元素过多，且映射的原理和摩斯密码类似，就不再搞脚本了。</p>
<p>通过<a target="_blank" rel="noopener" href="http://code.mcdvisa.com/">在线解密工具</a>，明文如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">6060：计</span><br><span class="line">4615：算</span><br><span class="line">2623：机</span><br><span class="line">6008：要</span><br><span class="line">1783：从</span><br><span class="line">1216：娃</span><br><span class="line">1216：娃</span><br><span class="line">2119：抓</span><br><span class="line">6386：起</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="传统知识-古典密码"><a href="#传统知识-古典密码" class="headerlink" title="传统知识 + 古典密码"></a>传统知识 + 古典密码</h2><p>点开附件，题目如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">小明某一天收到一封密信，信中写了几个不同的年份</span><br><span class="line">          辛卯，癸巳，丙戌，辛未，庚辰，癸酉，己卯，癸巳。</span><br><span class="line">          信的背面还写有“+甲子”，请解出这段密文。</span><br><span class="line"></span><br><span class="line">key值：CTF&#123;XXX&#125;</span><br></pre></td></tr></table></figure>

<p>找到甲子表，八个不同的年份对应的数字分别是28 30 23 8 17 10 16 30。根据“ + 甲子”这个线索（一甲子 = 60），八个数字变为 88 90 83 68 77 70 76 90。再利用古典密码：Caesar密码进行解密，解得密文为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHUANGYU</span><br></pre></td></tr></table></figure>

<p>按照题目格式提交即可。</p>
<hr>
<h2 id="凯撒？替换？呵呵！"><a href="#凯撒？替换？呵呵！" class="headerlink" title="凯撒？替换？呵呵！"></a>凯撒？替换？呵呵！</h2><p>题目如下：</p>
<p><img src="/2021/07/19/BUUCTF-Crypto%E7%B3%BB%E5%88%97-17-32-WP/Post5_image1.png"></p>
<p>前四个字母与flag没有传统凯撒密码的替换规律，使用了<a target="_blank" rel="noopener" href="https://quipqiup.com/">线上暴力破解工具</a>。</p>
<p><img src="/2021/07/19/BUUCTF-Crypto%E7%B3%BB%E5%88%97-17-32-WP/Post5_image2.png"></p>
<p>圈出的部分就是flag。</p>
<hr>
<h2 id="RSA1"><a href="#RSA1" class="headerlink" title="RSA1"></a>RSA1</h2><p>点开附件，题目如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229</span> </span><br><span class="line">q = <span class="number">12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469</span> </span><br><span class="line">dp = <span class="number">6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929</span> </span><br><span class="line">dq = <span class="number">783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041</span> </span><br><span class="line">c = <span class="number">24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852</span></span><br></pre></td></tr></table></figure>

<p>要求得m，这里的话需要进行公式推导：</p>
<p>m ≡ c ^ d mod n，n = p * q</p>
<p>m = c ^ d + k * p * q</p>
<p>两边同除以q，令m1 = m / q，得：</p>
<p>m1 = c ^ d + k * p </p>
<p>m1 ≡ c ^ d mod p ——————-①</p>
<p>同理，两边同除以p，得：</p>
<p>m2 = c ^ d + k * q </p>
<p>m2 ≡ c ^ d mod q ——————-②</p>
<p>由①得：c ^ d = k * p + m1 ——————-③</p>
<p>③式代入②式得：</p>
<p>m2 ≡ (k*p + m1) mod q</p>
<p>m2 - m1 ≡ kp mod q</p>
<p>因为gcd(p, q) = 1</p>
<p>所以(m2 - m1) * invp ≡ k mod q （其中invp是p关于q的乘法逆元）</p>
<p>k ≡ ((m2 - m1) * invp) mod q —————–④</p>
<p>把④式代入③式得：</p>
<p>c  ^ d = (((m2 - m1) * invp) mod q) * p + m1</p>
<p>现在问题变为如何得到m1和m2，还有一个条件没用上，那就是dp ≡ d mod (p - 1)、dq ≡ d mod (q - 1)：</p>
<p>d ≡  dp mod (p - 1) —————-⑤</p>
<p>把⑤式代入①式得：</p>
<p>m1 ≡ c ^ (dp mod (p - 1)) mod p</p>
<p>m1 ≡ c ^ (dp + k*(p - 1)) mod p</p>
<p>m1 ≡ c ^ dp mod p + c ^ k * (p - 1) mod p —————–⑥</p>
<p>由费马小定理可知，存在质数p，如果有gcd(k,p) = 1，则k ^ (p - 1) ≡ 1 mod dp。</p>
<p>所以⑥式可以简化为 m1 ≡ c ^ dp mod p，同理m2 ≡ c ^ dq mod q。这样可求得c ^ d，进步可求得m。</p>
<p>脚本部分：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229</span></span><br><span class="line">q = <span class="number">12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469</span></span><br><span class="line">dp = <span class="number">6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929</span></span><br><span class="line">dq = <span class="number">783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041</span></span><br><span class="line">c = <span class="number">24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852</span></span><br><span class="line"></span><br><span class="line">m1 = <span class="built_in">pow</span>(c,dp,p)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c,dq,q)</span><br><span class="line">n = p * q</span><br><span class="line">d = gmpy2.invert(dp, (p - <span class="number">1</span>))</span><br><span class="line">invp = gmpy2.invert(p,q)</span><br><span class="line">m = ((((m2 - m1) * invp)%q) * p + m1)%n</span><br><span class="line"><span class="comment">#把数字对应的字节转换为字符</span></span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;flag&#123;&#125;&quot;</span>.<span class="built_in">format</span>(flag))</span><br></pre></td></tr></table></figure>

<p>即可得到flag。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;W31c0m3_70_Ch1n470wn&#125;</span><br></pre></td></tr></table></figure>



<hr>
<h2 id="萌萌哒的八戒"><a href="#萌萌哒的八戒" class="headerlink" title="萌萌哒的八戒"></a>萌萌哒的八戒</h2><p>题目如下：</p>
<p><img src="/2021/07/19/BUUCTF-Crypto%E7%B3%BB%E5%88%97-17-32-WP/bajie.jpg"></p>
<p>这是一道猪圈密码，猪圈密码的编码规则如下：</p>
<p><img src="/2021/07/19/BUUCTF-Crypto%E7%B3%BB%E5%88%97-17-32-WP/Post5_image3.png"></p>
<p>将图片中的图形与编码规则一一对应就是flag：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;whenthepigwanttoeat&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="old-fashion"><a href="#old-fashion" class="headerlink" title="old-fashion"></a>old-fashion</h2><p>点开附件，题目如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Os drnuzearyuwn, y jtkjzoztzoes douwlr oj y ilzwex eq lsdexosa kn pwodw tsozj eq ufyoszlbz yrl rlufydlx pozw douwlrzlbz, ydderxosa ze y rlatfyr jnjzli; mjy gfbmw vla xy wbfnsy symmyew (mjy vrwm qrvvrf), hlbew rd symmyew, mebhsymw rd symmyew, vbomgeyw rd mjy lxrzy, lfk wr dremj. Mjy eyqybzye kyqbhjyew mjy myom xa hyedrevbfn lf bfzyewy wgxwmbmgmbrf. Wr mjy dsln bw f1_2jyf-k3_jg1-vb-vl_l</span><br></pre></td></tr></table></figure>

<p>这是一道英文字符频率分析题，线上工具直接破解吧：</p>
<p><img src="/2021/07/19/BUUCTF-Crypto%E7%B3%BB%E5%88%97-17-32-WP/Post5_image4.png"></p>
<p>答案就是框出来的部分。</p>
<hr>
<h2 id="权限获得的第一步"><a href="#权限获得的第一步" class="headerlink" title="权限获得的第一步"></a>权限获得的第一步</h2><p>点开附件，题目如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Administrator:<span class="number">500</span>:806EDC27AA52E314AAD3B435B51404EE:F4AD50F57683D4260DFD48AA351A17A8:::</span><br></pre></td></tr></table></figure>

<p>这题和上篇博客中的Windows密码是一样的，用在线工具解决吧：</p>
<p><img src="/2021/07/19/BUUCTF-Crypto%E7%B3%BB%E5%88%97-17-32-WP/Post5_image5.png"></p>
<p>flag就是查询结果。</p>
<hr>
<h2 id="世上无难事"><a href="#世上无难事" class="headerlink" title="世上无难事"></a>世上无难事</h2><p>点开附件，题目如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">VIZZB IFIUOJBWO NVXAP OBC XZZ UKHVN IFIUOJBWO HB XVIXW XAW VXFI X QIXN VBD KQ IFIUOJBWO WBKAH NBWXO VBD XJBCN NKG QLKEIU DI XUI VIUI DKNV QNCWIANQ XN DXPIMKIZW VKHV QEVBBZ KA XUZKAHNBA FKUHKAKX XAW DI VXFI HBN QNCWIANQ NCAKAH KA MUBG XZZ XEUBQQ XGIUKEX MUBG PKAWIUHXUNIA NVUBCHV 12NV HUXWI XAW DI XUI SCQN QB HZXW NVXN XZZ EBCZW SBKA CQ NBWXO XAW DI DXAN NB NVXAP DXPIMKIZW MBU JIKAH QCEV XA BCNQNXAWKAH VBQN HKFI OBCUQIZFIQ X JKH UBCAW BM XLLZXCQI XAW NVI PIO KQ 640I11012805M211J0XJ24MM02X1IW09</span><br></pre></td></tr></table></figure>

<p>这题考察的还是替换密码，暴力破解，根据题目提示，可以将”PIO”替换为”key”：</p>
<p><img src="/2021/07/19/BUUCTF-Crypto%E7%B3%BB%E5%88%97-17-32-WP/Post5_image6.png"></p>
<p>框出来的部分就是flag。</p>
<hr>
<h2 id="RSA3"><a href="#RSA3" class="headerlink" title="RSA3"></a>RSA3</h2><p>题目给的信息如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">c1=<span class="number">22322035275663237041646893770451933509324701913484303338076210603542612758956262869640822486470121149424485571361007421293675516338822195280313794991136048140918842471219840263536338886250492682739436410013436651161720725855484866690084788721349555662019879081501113222996123305533009325964377798892703161521852805956811219563883312896330156298621674684353919547558127920925706842808914762199011054955816534977675267395009575347820387073483928425066536361482774892370969520740304287456555508933372782327506569010772537497541764311429052216291198932092617792645253901478910801592878203564861118912045464959832566051361</span></span><br><span class="line"></span><br><span class="line">n=<span class="number">22708078815885011462462049064339185898712439277226831073457888403129378547350292420267016551819052430779004755846649044001024141485283286483130702616057274698473611149508798869706347501931583117632710700787228016480127677393649929530416598686027354216422565934459015161927613607902831542857977859612596282353679327773303727004407262197231586324599181983572622404590354084541788062262164510140605868122410388090174420147752408554129789760902300898046273909007852818474030770699647647363015102118956737673941354217692696044969695308506436573142565573487583507037356944848039864382339216266670673567488871508925311154801</span></span><br><span class="line"></span><br><span class="line">e1=<span class="number">11187289</span></span><br><span class="line"></span><br><span class="line">c2=<span class="number">18702010045187015556548691642394982835669262147230212731309938675226458555210425972429418449273410535387985931036711854265623905066805665751803269106880746769003478900791099590239513925449748814075904017471585572848473556490565450062664706449128415834787961947266259789785962922238701134079720414228414066193071495304612341052987455615930023536823801499269773357186087452747500840640419365011554421183037505653461286732740983702740822671148045619497667184586123657285604061875653909567822328914065337797733444640351518775487649819978262363617265797982843179630888729407238496650987720428708217115257989007867331698397</span></span><br><span class="line"></span><br><span class="line">e2=<span class="number">9647291</span></span><br></pre></td></tr></table></figure>

<p>这题考察的是RSA共模攻击，什么是RSA共模攻击呢？这里引用了大佬博客中的一个例子：</p>
<p>假设有一家公司COMPANY，在员工通信系统中用RSA加密消息。COMPANY首先生成了两个大质数P,Q，取得PQ乘积N。并且以N为模数，生成多对不同的公钥及其相应的私钥。COMPANY将所有公钥公开。而不同的员工获得自己的私钥，比如，员工A获得了私钥d1，员工B获得了私钥d2。现在，COMPANY将一条相同的消息，同时经过所有公钥加密，发送给所有员工。此时，就可能出现共模攻击。<br> 共模攻击<br> 也称同模攻击，英文原名是 Common Modulus Attack 。<br> 同模攻击利用的大前提就是，RSA体系在生成密钥的过程中使用了相同的模数n。假设COMPANY用所有的公钥加密了明文，即：</p>
<p>c1= m ^ e1 mod n，c2 = m ^ e2 mod n。那么员工A和员工B就可以分别通过私钥d1和d2来获取明文了。如果，此时有一个攻击者，同时监听了A和B接收到的密文c1,c2，因为模数不变，以及所有公钥都是公开的，那么利用同模攻击，他就可以在不知道d1，d2的情况下解密得到消息m。why？以下是推导过程：</p>
<p>首先引入一个定理——<strong>裴蜀定理</strong></p>
<p>裴蜀定理：裴蜀定理或贝祖定理得名于法国数学家艾蒂安·裴蜀，说明了对任何整数a、b和它们的最大公约数d，关于未知数x和y的线性不定方程（称为裴蜀等式）：若a,b是整数,且gcd(a,b)=d，那么对于任意的整数x,y,ax+by（①）都一定是d的倍数，特别地，一定存在整数x,y，使ax+by=d成立。它的一个重要推论是：a,b互质的充分必要条件是存在整数x,y使ax+by=1。</p>
<p>这边做一个小小的推导：</p>
<p>因为a和b分别是它们最大公约数d的倍数，记a = k * d, b = j * d，代入①式得 k * x * d + j * y * d，其中x和y是任意的整数，所以k * x* d是d的倍数同理j * y * d也是d的倍数，得证。</p>
<p>现在我们假设e1和e2互质，即gcd(e1,e2) = 1，此时引用裴蜀定理有e1 * s1  + e2 * s2 = 1。</p>
<p>接着引入<strong>扩展的欧几里得算法</strong>：扩展欧几里得算法是欧几里得算法（又叫辗转相除法）的扩展。除了计算a、b两个整数的最大公约数，此算法还能找到整数x、y（其中一个很可能是负数）。通常谈到最大公因子时, 我们都会提到一个非常基本的事实: 给予二整数 a 与 b, 必存在有整数 x 与 y 使得ax + by = gcd(a,b)。有两个数a,b，对它们进行辗转相除法，可得它们的最大公约数——这是众所周知的。然后，收集辗转相除法中产生的式子，倒回去，可以得到ax+by=gcd(a,b)的整数解。</p>
<p>然后我们就可以通过扩展的欧几里得算法求得一组解[s1,s2]。</p>
<p>c1 = m^e1 mod n，c2 = m ^ e2 mod n</p>
<p>c1 ^ s1 * c2 ^ s2 = m ^ (e1 * s1) mod n * m ^ (e2 * s2) mod n</p>
<p>c1 ^ s1 * c2 ^ s2 = m ^ (e1 * s1 + e2 * s2) mod n</p>
<p>因为e1 * s1 + e2 * s2 = 1，所以上式变为 c1 ^ s1 * c2 ^ s2 = m ^ (1) mod n = m mod n = m。</p>
<p>推导系数：</p>
<p><img src="/2021/07/19/BUUCTF-Crypto%E7%B3%BB%E5%88%97-17-32-WP/Post5_image8.png"></p>
<p>有一点要说明，s1 和 s2其中有一个是负数。数论模运算中，要求一个数的负数次幂，先计算c的模反元素cr，然后求cr的-s次幂。</p>
<p>推到完毕，代码部分：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line"><span class="comment">#扩展欧几里得算法，求得a与b的系数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exgcd</span>(<span class="params">a , b</span>):</span></span><br><span class="line">    <span class="comment">#当a % b == 0时表示已求得最大公约数和两个系数</span></span><br><span class="line">    <span class="keyword">if</span> (b == <span class="number">0</span>):</span><br><span class="line">        <span class="comment">#返回的第一个参数最大公约数，第二个参数a的系数，第三个参数是b的系数</span></span><br><span class="line">        <span class="comment">#这里0和任何数的最大公约数是这个数的本身</span></span><br><span class="line">        <span class="keyword">return</span> (b, <span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment">#将函数返回的结果依次赋值给d, x, y</span></span><br><span class="line">        d, x, y = exgcd(b, a % b)</span><br><span class="line">        <span class="keyword">return</span> (d, y, x - (a // b) * y)</span><br><span class="line"></span><br><span class="line">c1=<span class="number">22322035275663237041646893770451933509324701913484303338076210603542612758956262869640822486470121149424485571361007421293675516338822195280313794991136048140918842471219840263536338886250492682739436410013436651161720725855484866690084788721349555662019879081501113222996123305533009325964377798892703161521852805956811219563883312896330156298621674684353919547558127920925706842808914762199011054955816534977675267395009575347820387073483928425066536361482774892370969520740304287456555508933372782327506569010772537497541764311429052216291198932092617792645253901478910801592878203564861118912045464959832566051361</span></span><br><span class="line">n=<span class="number">22708078815885011462462049064339185898712439277226831073457888403129378547350292420267016551819052430779004755846649044001024141485283286483130702616057274698473611149508798869706347501931583117632710700787228016480127677393649929530416598686027354216422565934459015161927613607902831542857977859612596282353679327773303727004407262197231586324599181983572622404590354084541788062262164510140605868122410388090174420147752408554129789760902300898046273909007852818474030770699647647363015102118956737673941354217692696044969695308506436573142565573487583507037356944848039864382339216266670673567488871508925311154801</span></span><br><span class="line">e1=<span class="number">11187289</span></span><br><span class="line">c2=<span class="number">18702010045187015556548691642394982835669262147230212731309938675226458555210425972429418449273410535387985931036711854265623905066805665751803269106880746769003478900791099590239513925449748814075904017471585572848473556490565450062664706449128415834787961947266259789785962922238701134079720414228414066193071495304612341052987455615930023536823801499269773357186087452747500840640419365011554421183037505653461286732740983702740822671148045619497667184586123657285604061875653909567822328914065337797733444640351518775487649819978262363617265797982843179630888729407238496650987720428708217115257989007867331698397</span></span><br><span class="line">e2=<span class="number">9647291</span></span><br><span class="line"></span><br><span class="line">s = exgcd(e1, e2)</span><br><span class="line">s1 = s[<span class="number">1</span>]</span><br><span class="line">s2 = s[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#当s是负数的时候，一个数的负数次幂，先计算c的模反元素cr，然后求cr的-s次幂。</span></span><br><span class="line"><span class="keyword">if</span> (s1 &lt; <span class="number">0</span>):</span><br><span class="line">    s1 = -s1</span><br><span class="line">    c1 = inverse(c1, n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">elif</span> (s2 &lt; <span class="number">0</span>):</span><br><span class="line">    s2 = -s2</span><br><span class="line">    c2 = inverse(c2, n)</span><br><span class="line"></span><br><span class="line">m = <span class="built_in">pow</span>(c1,s1,n) * <span class="built_in">pow</span>(c2,s2,n) % n</span><br><span class="line"><span class="comment">#数字转字符串</span></span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m))</span><br></pre></td></tr></table></figure>

<p>解得flag为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;49d91077a1abcb14f1a9d546c80be9ef&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="RSA2"><a href="#RSA2" class="headerlink" title="RSA2"></a>RSA2</h2><p>题目如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">248254007851526241177721526698901802985832766176221609612258877371620580060433101538328030305219918697643619814200930679612109885533801335348445023751670478437073055544724280684733298051599167660303645183146161497485358633681492129668802402065797789905550489547645118787266601929429724133167768465309665906113</span></span><br><span class="line">dp = <span class="number">905074498052346904643025132879518330691925174573054004621877253318682675055421970943552016695528560364834446303196939207056642927148093290374440210503657</span></span><br><span class="line">c = <span class="number">140423670976252696807533673586209400575664282100684119784203527124521188996403826597436883766041879067494280957410201958935737360380801845453829293997433414188838725751796261702622028587211560353362847191060306578510511380965162133472698713063592621028959167072781482562673683090590521214218071160287665180751</span></span><br></pre></td></tr></table></figure>

<p>这题考查的是dp泄露，推导如下：</p>
<p>d ≡ dp mod (p - 1)，两边同乘e，e * d ≡ (e * dp) mod (p - 1) –&gt; e * d = k1 * e * (p - 1) + e * dp ————①。</p>
<p>e * d = 1 mod Φ(n)，Φ(n) = (p - 1) * (q - 1) –&gt; e * d = k2 * (p - 1) * (q - 1) + 1 ———-②。</p>
<p>由①和②得k1 * e * (p - 1) + e * dp = k2 * (p - 1) * (q - 1) + 1 –&gt; e * dp = (p - 1) * (k2 * (q - 1) - k1) + 1。记(k2 * (q - 1) - k1) = x，则</p>
<p>e * dp = (p - 1) * x + 1。因为dp &lt; p - 1，所以1 &lt; x &lt; e。遍历e就可以求得p，代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">248254007851526241177721526698901802985832766176221609612258877371620580060433101538328030305219918697643619814200930679612109885533801335348445023751670478437073055544724280684733298051599167660303645183146161497485358633681492129668802402065797789905550489547645118787266601929429724133167768465309665906113</span></span><br><span class="line">dp = <span class="number">905074498052346904643025132879518330691925174573054004621877253318682675055421970943552016695528560364834446303196939207056642927148093290374440210503657</span></span><br><span class="line">c = <span class="number">140423670976252696807533673586209400575664282100684119784203527124521188996403826597436883766041879067494280957410201958935737360380801845453829293997433414188838725751796261702622028587211560353362847191060306578510511380965162133472698713063592621028959167072781482562673683090590521214218071160287665180751</span></span><br><span class="line"></span><br><span class="line">y = dp * e</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,e):</span><br><span class="line">    <span class="keyword">if</span> ((y - <span class="number">1</span>) % x == <span class="number">0</span>):</span><br><span class="line">        p = (y - <span class="number">1</span>) // x + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> (n % p == <span class="number">0</span>):</span><br><span class="line">            q = n // p</span><br><span class="line">            phin = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">            d = inverse(e, phin)</span><br><span class="line">            m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">            <span class="built_in">print</span>(libnum.n2s(m))</span><br></pre></td></tr></table></figure>

<p>接着就可以得到flag。</p>
<hr>
<h2 id="异性相吸"><a href="#异性相吸" class="headerlink" title="异性相吸"></a>异性相吸</h2><p>题目如下，包含两个文件，一个是key.txt，还有一个是密文.txt：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">key.txt:</span><br><span class="line">asadsasdasdasdasdasdasdasdasdasdqwesqf</span><br><span class="line">密文.txt:</span><br><span class="line">ἇ̀Ј唒ဃ塔屋䩘卖剄䐃堂ن䝔嘅均ቄ䩝ᬔ</span><br></pre></td></tr></table></figure>

<p>考察的是二进制的异或，代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">miwen = <span class="built_in">open</span>(<span class="string">&quot;D:\\密文.txt&quot;</span>,<span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">key = <span class="built_in">open</span>(<span class="string">&quot;D:\\key.txt&quot;</span>,<span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(miwen)):</span><br><span class="line">    <span class="built_in">str</span> = <span class="built_in">list</span>(miwen)[i] ^ <span class="built_in">list</span>(key)[i]</span><br><span class="line">    flag += <span class="built_in">chr</span>(<span class="built_in">str</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>即可得到flag。</p>
<hr>
<h2 id="还原大师"><a href="#还原大师" class="headerlink" title="还原大师"></a>还原大师</h2><p>题目如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">我们得到了一串神秘字符串：TASC?O3RJMV?WDJKX?ZM,问号部分是未知大写字母，为了确定这个神秘字符串，我们通过了其他途径获得了这个字串的<span class="number">32</span>位MD5码。但是我们获得它的<span class="number">32</span>位MD5码也是残缺不全，E903???4DAB????08?????<span class="number">51</span>?<span class="number">80</span>??8A?,请猜出神秘字符串的原本模样，并且提交这个字串的<span class="number">32</span>位MD5码作为答案。 注意：得到的 flag 请包上 flag&#123;&#125; 提交</span><br></pre></td></tr></table></figure>

<p>这题让我想到了上一篇博客里的“丢失的MD5“，发现其原理相似，而且MD5的字符串中有些字符是一样的，可以引用它的代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib   </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">            <span class="comment">#生成MD5加密对象</span></span><br><span class="line">            m=hashlib.md5()</span><br><span class="line">            <span class="comment">#在加密之前要对数据进行编码</span></span><br><span class="line">            m.update((<span class="string">&#x27;TASC&#x27;</span>+<span class="built_in">chr</span>(i)+<span class="string">&#x27;O3RJMV&#x27;</span>+<span class="built_in">chr</span>(j)+<span class="string">&#x27;WDJKX&#x27;</span>+<span class="built_in">chr</span>(k)+<span class="string">&#x27;ZM&#x27;</span>).encode())</span><br><span class="line">            <span class="comment">#生成MD5摘要信息</span></span><br><span class="line">            des=m.hexdigest()</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;e903&#x27;</span> <span class="keyword">in</span> des <span class="keyword">and</span> <span class="string">&#x27;4dab&#x27;</span> <span class="keyword">in</span> des <span class="keyword">and</span> <span class="string">&#x27;08&#x27;</span> <span class="keyword">in</span> des <span class="keyword">and</span> <span class="string">&#x27;51&#x27;</span> <span class="keyword">in</span> des <span class="keyword">and</span> <span class="string">&#x27;80&#x27;</span> <span class="keyword">in</span> des <span class="keyword">and</span> <span class="string">&#x27;8a&#x27;</span> <span class="keyword">in</span> des:</span><br><span class="line">                <span class="built_in">print</span> (des)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h2><p>题目里面有flag.enc和pub.key，通过<a target="_blank" rel="noopener" href="http://ctf.ssleye.com/pub_asys.html">在线分解工具</a>获得n和e：</p>
<p><img src="/2021/07/19/BUUCTF-Crypto%E7%B3%BB%E5%88%97-17-32-WP/Post5_image9.png"></p>
<p>分解n，可以得到p =  285960468890451637935629440372639283459, q = 304008741604601924494328155975272418463</p>
<p>。有了p, q, e就可以得到d，有d可以解密文：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> rsa</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">86934482296048119190666062003494800588905656017203025617216654058378322103517</span></span><br><span class="line">p = <span class="number">285960468890451637935629440372639283459</span></span><br><span class="line">q = <span class="number">304008741604601924494328155975272418463</span></span><br><span class="line"></span><br><span class="line">phin = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e, phin)</span><br><span class="line"></span><br><span class="line">prikey = rsa.PrivateKey(n, e, <span class="built_in">int</span>(d), p, q)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.enc&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f = f.read()</span><br><span class="line">    <span class="built_in">print</span>(rsa.decrypt(f, prikey))</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="uuencode"><a href="#uuencode" class="headerlink" title="uuencode"></a>uuencode</h2><p>题目如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">89FQA9WMD&lt;V1A&lt;V1S83DY.<span class="comment">#&lt;W3$Q,2TM]</span></span><br></pre></td></tr></table></figure>

<p>这题考查的是uuencode，什么是<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/UUENCODE/10864424?fr=aladdin">uuencode</a>?</p>
<p>通过在线解密工具，就可以得到flag：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;dsdasdsa99877LLLKK&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="AFCTF2018-Morse"><a href="#AFCTF2018-Morse" class="headerlink" title="[AFCTF2018]Morse"></a>[AFCTF2018]Morse</h2><p>题目如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-..../.----/-..../-..../-..../...--/--.../....-/-..../-..../--.../-.../...--/.----/--.../...--/..---/--.../--.../....-/...../..-./--.../...--/...--/-----/...../..-./...--/...--/...--/....-/...--/...../--.../----./--.../-..</span><br></pre></td></tr></table></figure>

<p>其中”/“是间隔，其余的就是数字和字符，进行翻译就是：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">61666374667B317327745F73305F333435797D</span><br></pre></td></tr></table></figure>

<p>这些是16进制数，转化成ASCII码就可以得到flag：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">afctf&#123;1s’t_s0_345y&#125;</span><br></pre></td></tr></table></figure>

<p>换成flag格式就可以了。</p>
<hr>
<h2 id="RSAROLL"><a href="#RSAROLL" class="headerlink" title="RSAROLL"></a>RSAROLL</h2><p>题目如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">题目.txt:</span><br><span class="line">RSA roll！roll！roll！</span><br><span class="line">Only number <span class="keyword">and</span> a-z</span><br><span class="line">（don<span class="string">&#x27;t use editor</span></span><br><span class="line"><span class="string">which MS provide）</span></span><br><span class="line"><span class="string">data.txt:</span></span><br><span class="line"><span class="string">&#123;920139713,19&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">704796792</span></span><br><span class="line"><span class="string">752211152</span></span><br><span class="line"><span class="string">274704164</span></span><br><span class="line"><span class="string">18414022</span></span><br><span class="line"><span class="string">368270835</span></span><br><span class="line"><span class="string">483295235</span></span><br><span class="line"><span class="string">263072905</span></span><br><span class="line"><span class="string">459788476</span></span><br><span class="line"><span class="string">483295235</span></span><br><span class="line"><span class="string">459788476</span></span><br><span class="line"><span class="string">663551792</span></span><br><span class="line"><span class="string">475206804</span></span><br><span class="line"><span class="string">459788476</span></span><br><span class="line"><span class="string">428313374</span></span><br><span class="line"><span class="string">475206804</span></span><br><span class="line"><span class="string">459788476</span></span><br><span class="line"><span class="string">425392137</span></span><br><span class="line"><span class="string">704796792</span></span><br><span class="line"><span class="string">458265677</span></span><br><span class="line"><span class="string">341524652</span></span><br><span class="line"><span class="string">483295235</span></span><br><span class="line"><span class="string">534149509</span></span><br><span class="line"><span class="string">425392137</span></span><br><span class="line"><span class="string">428313374</span></span><br><span class="line"><span class="string">425392137</span></span><br><span class="line"><span class="string">341524652</span></span><br><span class="line"><span class="string">458265677</span></span><br><span class="line"><span class="string">263072905</span></span><br><span class="line"><span class="string">483295235</span></span><br><span class="line"><span class="string">828509797</span></span><br><span class="line"><span class="string">341524652</span></span><br><span class="line"><span class="string">425392137</span></span><br><span class="line"><span class="string">475206804</span></span><br><span class="line"><span class="string">428313374</span></span><br><span class="line"><span class="string">483295235</span></span><br><span class="line"><span class="string">475206804</span></span><br><span class="line"><span class="string">459788476</span></span><br><span class="line"><span class="string">306220148</span></span><br></pre></td></tr></table></figure>

<p>初步分析可知n = 920139713, e = 19。思路就是由n求p，q，然后由Φ(n)，e求得d，再根据密文求得明文：</p>
<p><img src="/2021/07/19/BUUCTF-Crypto%E7%B3%BB%E5%88%97-17-32-WP/Post5_image10.png"></p>
<p>脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> rsa</span><br><span class="line"></span><br><span class="line">e = <span class="number">19</span></span><br><span class="line">n = <span class="number">920139713</span></span><br><span class="line">p = <span class="number">18443</span></span><br><span class="line">q = <span class="number">49891</span></span><br><span class="line"></span><br><span class="line">phin = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e, phin)</span><br><span class="line"></span><br><span class="line">phainer = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;data.txt&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> cipher <span class="keyword">in</span> f.readlines():</span><br><span class="line">        phainer.append(<span class="built_in">chr</span>(<span class="built_in">pow</span>(<span class="built_in">int</span>(cipher), d, n)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> phainer:</span><br><span class="line">    <span class="built_in">print</span>(i, end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>即可得到flag。</p>
<hr>
<p>参考：</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/rainbowcloud/p/10141301.html">https://www.cnblogs.com/rainbowcloud/p/10141301.html</a></p>
<p><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E8%A3%B4%E8%9C%80%E5%AE%9A%E7%90%86/5186593">https://baike.baidu.com/item/%E8%A3%B4%E8%9C%80%E5%AE%9A%E7%90%86/5186593</a></p>

  </div>
  <!--文末结束语-->
  
    <div style="text-align:center;color: #ccc;font-size:24px;"> --- 本文结束 <i class="iconfont icon-heartbeat" style="font-size:24px;"></i> The End --- </div>
  
  <!--页脚广告-->
  
  <div class="mdui-divider"></div>
  
  <nav>
    
      <a rel="prev" class="post-nav-item mdui-float-left" href="/2021/07/29/%E6%B5%85%E8%B0%88%E5%AF%B9%E7%A7%B0%E5%AF%86%E7%A0%81/">
        <i class="iconfont icon-angle-left"></i>
        <span>浅谈对称密码</span>
      </a>
    
    
      <a rel="next" class="post-nav-item mdui-float-right" href="/2021/07/19/BUUCTF-Crypto%E7%B3%BB%E5%88%97-1-16-WP/">
        <span>BUUCTF-Crypto系列[1-16]WP</span>
        <i class="iconfont icon-angle-right"></i>
      </a>
    
  </nav>
</article>




  <div class="toc-button"  style="z-index: 100;">
    <button class="mdui-fab mdui-ripple mdui-color-teal" mdui-menu="{target: '#toc'}"><i class="iconfont icon-list"></i></button>
    <ul class="mdui-menu" id="toc">
      <li class="mdui-menu-item">
        <a href="/2021/07/19/BUUCTF-Crypto%E7%B3%BB%E5%88%97-17-32-WP/" id="toc-header" class="mdui-ripple">文章目录</a>
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E5%8C%96%E6%97%B6%E4%BB%A3%E7%9A%84%E6%AD%A5%E4%BC%90"><span class="toc-number">1.</span> <span class="toc-text">信息化时代的步伐</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%A0%E7%BB%9F%E7%9F%A5%E8%AF%86-%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81"><span class="toc-number">2.</span> <span class="toc-text">传统知识 + 古典密码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%AF%E6%92%92%EF%BC%9F%E6%9B%BF%E6%8D%A2%EF%BC%9F%E5%91%B5%E5%91%B5%EF%BC%81"><span class="toc-number">3.</span> <span class="toc-text">凯撒？替换？呵呵！</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RSA1"><span class="toc-number">4.</span> <span class="toc-text">RSA1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%90%8C%E8%90%8C%E5%93%92%E7%9A%84%E5%85%AB%E6%88%92"><span class="toc-number">5.</span> <span class="toc-text">萌萌哒的八戒</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#old-fashion"><span class="toc-number">6.</span> <span class="toc-text">old-fashion</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9D%83%E9%99%90%E8%8E%B7%E5%BE%97%E7%9A%84%E7%AC%AC%E4%B8%80%E6%AD%A5"><span class="toc-number">7.</span> <span class="toc-text">权限获得的第一步</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%96%E4%B8%8A%E6%97%A0%E9%9A%BE%E4%BA%8B"><span class="toc-number">8.</span> <span class="toc-text">世上无难事</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RSA3"><span class="toc-number">9.</span> <span class="toc-text">RSA3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RSA2"><span class="toc-number">10.</span> <span class="toc-text">RSA2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%82%E6%80%A7%E7%9B%B8%E5%90%B8"><span class="toc-number">11.</span> <span class="toc-text">异性相吸</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%98%E5%8E%9F%E5%A4%A7%E5%B8%88"><span class="toc-number">12.</span> <span class="toc-text">还原大师</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RSA"><span class="toc-number">13.</span> <span class="toc-text">RSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#uuencode"><span class="toc-number">14.</span> <span class="toc-text">uuencode</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AFCTF2018-Morse"><span class="toc-number">15.</span> <span class="toc-text">[AFCTF2018]Morse</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RSAROLL"><span class="toc-number">16.</span> <span class="toc-text">RSAROLL</span></a></li></ol>
      </li>
    </ul>
  </div>



    <div id="comment" class="mdui-card mdui-p-a-2 mdui-m-b-5">
      <div class="mdui-tab" mdui-tab>
        
          <a href="#comment-tab0" class="mdui-ripple">gitalk</a>
        
          <a href="#comment-tab1" class="mdui-ripple">livere</a>
        
      </div>
      
        <div id="comment-tab0" class="mdui-p-a-2">
          <div id="gitalk-container"></div>
<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<script src="//cdn.jsdelivr.net/npm/js-md5@0.7.3/src/md5.min.js"></script>
<script>
  var gitalk = new Gitalk({
    clientID: '',
    clientSecret: '',
    repo: '',
    owner: '',
    admin: [''],
    id:  md5(location.pathname) ,
    distractionFreeMode: 'true',
  });
  gitalk.render('gitalk-container');
</script>
        </div>
      
        <div id="comment-tab1" class="mdui-p-a-2">
          <div id="lv-container" data-id="city" data-uid="">
  <script type="text/javascript">
    (function (d, s) {
      var j, e = d.getElementsByTagName(s)[0];
      if (typeof LivereTower === 'function') { return; }
      j = d.createElement(s);
      j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
      j.async = true;
      e.parentNode.insertBefore(j, e);
    })(document, 'script');
  </script>
  <noscript>Please enable JavaScript to view the comments powered by LiveRe.</noscript>
</div>
        </div>
      
    </div>

  </main>
  <footer id="footer" class="mdui-text-center mdui-m-t-5 mdui-p-b-2 mdui-p-t-4 mdui-color-theme">
  <div class="mdui-container">
    <div class="mdui-row">
      
        <a href="https://beian.miit.gov.cn" rel="noopener" target="_blank"></a>
      
      <span>
        &copy; 2015 - 2021 
        
          <span style="color:#d9333f" class="iconfont icon-heart"></span>
        
        sinanya
      </span>
    </div>
    <div class="mdui-row">
      
        <div class="mdui-col-xs-6 mdui-text-right">
          <span>Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a></span>
        </div>
        <div class="mdui-col-xs-6 mdui-text-left">
          <span>Theme: <a href="https://github.com/kb1000fx/Meadow" rel="noopener" target="_blank">Meadow</a></span>
        </div>
      
    </div>
    <div class="mdui-row">
      
        <div class="mdui-col-xs-6 mdui-text-right">
          <span id="busuanzi_container_site_uv" style="display: none;"> <span class="iconfont icon-user"></span>总访客量 <span id="busuanzi_value_site_uv"></span></span>
        </div>
        <div class="mdui-col-xs-6 mdui-text-left">
          <span id="busuanzi_container_site_pv" style="display: none;"> <span class="iconfont icon-eye"></span>总访问量 <span id="busuanzi_value_site_pv"></span></span>
        </div>
      
    </div>
 </div>
</footer>
  
  <button id="gotop" class="mdui-fab mdui-fab-fixed mdui-fab-hide mdui-ripple mdui-color-teal" style="z-index:100;"><i class="iconfont icon-arrowup"></i></button>
  
  

    <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




    <script src="https://cdn.jsdelivr.net/npm/mermaid@8.4.8/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({
        startOnLoad: true,
        theme: "default"
    });</script>




    
<script src="/js/mdui.min.v1.0.0.js"></script>




<script src="/js/meadow.js"></script>

  <!-- 雪花特效 -->
  <script type="text/javascript">
    var windowWidth = $(window).width();
    if (windowWidth > 480) {
      document.write('<script type="text/javascript" src="/js/src/snow.js"><\/script>');
    }
  </script>
</body>
</html >